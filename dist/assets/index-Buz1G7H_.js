import{c as rt,r as s,j as e,u as he,U as _e,L as Ge,X as le,a as Me,C as ns,b as ls,d as gs,e as je,S as Le,f as qe,T as _s,g as be,H as Ds,D as Ue,h as Se,i as hs,M as ot,B as nt,k as Ps,l as us,m as lt,n as Cs,o as it,p as As,q as ct,s as Ls,I as Be,P as Pe,t as He,v as Ae,A as is,w as ke,x as Ce,y as Ie,z as rs,E as Ye,F as $s,G as qs,J as dt,K as ps,N as fs,O as Os,Q as Ee,R as mt,V as ut,W as We,Y as Ts,Z as xt,_ as Fe,$ as Is,a0 as gt,a1 as ht,a2 as pt,a3 as Fs,a4 as ft,a5 as Ms,a6 as bt,a7 as jt,a8 as yt,a9 as ge,aa as ie,ab as vt,ac as Nt}from"./vendor-P4cL6l1T.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))o(p);new MutationObserver(p=>{for(const a of p)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function c(p){const a={};return p.integrity&&(a.integrity=p.integrity),p.referrerPolicy&&(a.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?a.credentials="include":p.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(p){if(p.ep)return;p.ep=!0;const a=c(p);fetch(p.href,a)}})();const bs="/assets/bg-CsbMhw6X.jpg",Qe="/assets/logo-qja4BqCq.jpg",wt="https://dywsrkewiwzkjpkecxxt.supabase.co",_t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR5d3Nya2V3aXd6a2pwa2VjeHh0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIzMDE5MDQsImV4cCI6MjA1Nzg3NzkwNH0.iHYAWwmFlmgfPV6E7GEs_T2JSZEXjvxR1pyXxW1AxzY",Ct=window.location.hostname!=="localhost",js=()=>Ct?"https://proherosports.netlify.app":window.location.origin,C=rt(wt,_t,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),St=async({email:t,password:g})=>await C.auth.signInWithPassword({email:t,password:g}),Et=async({email:t,password:g,name:c,options:o})=>{var a;const p={...o==null?void 0:o.data,name:c||((a=o==null?void 0:o.data)==null?void 0:a.name)};return await C.auth.signUp({email:t,password:g,options:{data:p,emailRedirectTo:`${js()}/auth/callback`}})},kt=async()=>await C.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${js()}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}}),zt=async t=>await C.auth.resetPasswordForEmail(t,{redirectTo:`${js()}/reset-password`}),Us=s.createContext(void 0),ce=()=>{const t=s.useContext(Us);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},Dt=({children:t})=>{const[g,c]=s.useState(null),[o,p]=s.useState(null),[a,m]=s.useState(!0),[i,z]=s.useState(!0),h=s.useRef({}),u=s.useCallback(()=>{try{localStorage.setItem("onboardingCache",JSON.stringify(h.current))}catch(D){console.error("Erro ao salvar cache de onboarding:",D)}},[]),O=s.useCallback(()=>{try{const D=localStorage.getItem("onboardingCache");D&&(h.current=JSON.parse(D))}catch(D){console.error("Erro ao carregar cache de onboarding:",D)}},[]),y=s.useCallback((D,P)=>{console.log(`Atualizando cache de onboarding para ${D}: ${P}`),h.current[D]=P,u()},[u]);s.useEffect(()=>{O()},[O]),s.useEffect(()=>{const{data:{subscription:D}}=C.auth.onAuthStateChange(async(P,x)=>{console.log("AuthContext: Mudança no estado de autenticação:",{event:P,session:x}),P==="SIGNED_IN"||P==="TOKEN_REFRESHED"?x!=null&&x.user&&(c(x.user),p(x),window.location.pathname==="/dashboard"&&y(x.user.id,!0)):P==="SIGNED_OUT"&&(c(null),p(null),h.current={},localStorage.removeItem("onboardingCache"))});return()=>{D.unsubscribe()}},[y]),s.useEffect(()=>{(async()=>{try{const{data:{session:P},error:x}=await C.auth.getSession();if(x)throw x;P!=null&&P.user&&(c(P.user),p(P),window.location.pathname==="/dashboard"&&y(P.user.id,!0))}catch(P){console.error("Erro ao verificar sessão:",P)}finally{m(!1)}})()},[y]);const $=async D=>{try{const{data:P,error:x}=await St(D);return x?(console.error("Erro ao fazer login:",x),{data:null,error:x}):{data:{user:P.user},error:null}}catch(P){return console.error("Erro ao fazer login:",P),{data:null,error:P}}},w=async D=>{try{const{data:P,error:x}=await Et(D);return x?(console.error("Erro ao criar conta:",x),{data:null,error:x}):{data:{user:P.user},error:null}}catch(P){return console.error("Erro ao criar conta:",P),{data:null,error:P}}},_=async()=>{try{console.log("Iniciando login com Google...");const{error:D}=await kt();D?console.error("Erro no login com Google:",D):console.log("Login com Google iniciado com sucesso, redirecionando...")}catch(D){console.error("Erro no login com Google:",D)}},R=s.useCallback(async()=>{try{const{error:D}=await C.auth.signOut();if(D)throw D;return h.current={},localStorage.removeItem("onboardingCache"),z(!0),{error:null}}catch(D){return console.error("Erro ao fazer logout:",D),{error:D}}},[z]),M=async D=>{try{const{error:P}=await zt(D);return{error:P}}catch(P){return console.error("Erro ao resetar senha:",P),{error:P}}},F=s.useCallback(async D=>{if(window.location.pathname==="/dashboard")return console.log("Usuário está no dashboard, assumindo onboarding como completo"),y(D,!0),{onboarding:!0,error:null};if(h.current[D]!==void 0)return console.log(`Usando cache de onboarding para ${D}: ${h.current[D]}`),{onboarding:h.current[D],error:null};console.log(`Verificando status de onboarding para o usuário: ${D}`);try{const{data:P,error:x}=await C.from("users").select("onboarding").eq("auth_user_id",D).maybeSingle();return x?(console.error("Erro ao verificar status de onboarding:",x),{onboarding:null,error:x}):P?(y(D,P.onboarding),{onboarding:P.onboarding,error:null}):(console.log("Usuário não encontrado na tabela users"),{onboarding:!1,error:null})}catch(P){return console.error("Erro ao verificar status de onboarding:",P),{onboarding:null,error:P}}},[u,y]),v={user:g,session:o,loading:a,signIn:$,signUp:w,signInWithGoogle:_,logout:R,resetPassword:M,checkUserOnboarding:F,updateOnboardingCache:y,redirectAfterAuth:i,setRedirectAfterAuth:z};return e.jsx(Us.Provider,{value:v,children:t})},as={"Invalid login credentials":"Credenciais de login inválidas","User already registered":"Usuário já cadastrado","Email not confirmed":"Email não confirmado","Invalid email or password":"Email ou senha inválidos","Email link is invalid or has expired":"O link de email é inválido ou expirou","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","User already exists":"Usuário já existe","Email already in use":"Email já está em uso","Email not found":"Email não encontrado","Invalid token":"Token inválido","Token expired":"Token expirado","Invalid credentials":"Credenciais inválidas","Invalid email":"Email inválido","Invalid password":"Senha inválida","Invalid phone":"Telefone inválido","Password recovery email sent":"Email de recuperação de senha enviado","Password recovery failed":"Falha na recuperação de senha","Password update failed":"Falha na atualização da senha","Password update successful":"Senha atualizada com sucesso","Email confirmation successful":"Email confirmado com sucesso","Email confirmation failed":"Falha na confirmação do email","Duplicate key value violates unique constraint":"Valor duplicado viola restrição única","Foreign key violation":"Violação de chave estrangeira","Not found":"Não encontrado","Permission denied":"Permissão negada"},Re=t=>{if(as[t])return as[t];for(const g in as)if(t.includes(g))return as[g];return t},Pt=()=>{const t=he(),{signIn:g,signInWithGoogle:c,user:o}=ce(),[p,a]=s.useState(!1),[m,i]=s.useState(null),[z,h]=s.useState({email:"",password:""});s.useEffect(()=>{o&&t("/dashboard")},[o,t]);const u=w=>{const{name:_,value:R}=w.target;h(M=>({...M,[_]:R}))},O=async w=>{w.preventDefault(),i(null),a(!0);try{const{error:_}=await g({email:z.email,password:z.password});_&&i(Re(_.message))}catch(_){console.error("Error during login:",_),i("Ocorreu um erro durante o login")}finally{a(!1)}},y=async()=>{try{await c()}catch(w){console.error("Error during Google login:",w),i("Ocorreu um erro durante o login com Google")}},$=async()=>{if(!z.email){i("Digite seu email para redefinir a senha");return}a(!0);try{const{error:w}=await ce().resetPassword(z.email);w?i(Re(w.message)):alert("Verifique seu email para redefinir sua senha!")}catch(w){console.error("Error requesting password reset:",w),i("Ocorreu um erro ao solicitar redefinição de senha")}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(${bs})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-black/90 backdrop-blur-lg rounded-2xl shadow-xl p-8 transition-transform duration-300",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("img",{src:Qe,alt:"Logo",className:"h-32 w-auto mb-4 rounded-lg"}),e.jsx("p",{className:"text-gray-200",children:"Entre com sua conta"})]}),m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4",children:m}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_e,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"email",name:"email",placeholder:"Seu email",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:z.email,onChange:u,required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",name:"password",placeholder:"Sua senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:z.password,onChange:u,required:!0})]}),e.jsx("div",{className:"flex items-center justify-between text-sm",children:e.jsx("button",{type:"button",onClick:$,className:"text-gray-200 hover:text-white transition-colors duration-300",children:"Esqueceu a senha?"})}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:-translate-y-0.5 transition-all duration-300",children:p?"Entrando...":"Entrar"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-black text-gray-400",children:"Ou continue com"})})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:y,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-300",children:[e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})})]}),e.jsxs("p",{className:"mt-8 text-center text-gray-400",children:["Não tem uma conta?"," ",e.jsx("button",{onClick:()=>t("/signup"),className:"text-green-500 hover:text-green-400 focus:outline-none",children:"Cadastre-se"})]})]})})})},Rs=s.createContext(void 0),At=({children:t})=>{const[g,c]=s.useState(!1),[o,p]=s.useState(!1),[a,m]=s.useState(!0);s.useEffect(()=>{const u=()=>{p(window.innerWidth<768),window.innerWidth<768?m(!1):m(!0)};return u(),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]);const i=()=>{c(!g)},z=()=>{m(!a)},h=()=>{o&&m(!1)};return e.jsx(Rs.Provider,{value:{isCollapsed:g,isMobile:o,isOpen:a,setIsCollapsed:c,toggleSidebar:i,toggleMobileSidebar:z,closeMobileSidebar:h},children:t})},cs=()=>{const t=s.useContext(Rs);if(t===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return t},ve=async(t,g=!1)=>{try{if(!t)return console.error("getUserByAuthId: ID de autenticação não fornecido"),null;const{data:c,error:o}=await C.from("users").select("*").eq("auth_user_id",t).maybeSingle();if(o)return console.error("getUserByAuthId: Erro ao buscar usuário:",o),null;if(c)return console.log("Dados do usuário recuperados:",c),console.log("Role do usuário:",c.role),c;{if(g)return null;const{data:p,error:a}=await C.auth.getUser();return a?(console.error("getUserByAuthId: Erro ao verificar usuário na auth:",a),null):p!=null&&p.user&&p.user.id===t?await ys(p.user):null}}catch(c){return console.error("getUserByAuthId: Erro inesperado:",c),null}},ys=async t=>{var g,c,o;try{if(!t||!t.id)return console.error("createUserFromAuth: Dados de usuário inválidos:",t),null;const p=await ve(t.id,!0);if(p)return p;if(t.email){const u=await xs(t.email);if(u){if(u.auth_user_id!==t.id)try{return await vs(u.id,{auth_user_id:t.id})}catch(O){return console.error("createUserFromAuth: Erro ao atualizar auth_user_id:",O),u}return u}}let a="";(g=t.user_metadata)!=null&&g.name?a=t.user_metadata.name:(c=t.user_metadata)!=null&&c.full_name?a=t.user_metadata.full_name:t.email?a=t.email.split("@")[0]:a="Usuário";let m=null;(o=t.user_metadata)!=null&&o.avatar_url&&(m=t.user_metadata.avatar_url);let i=0;const z=3;let h=null;for(;i<z&&!h;)try{const u=await ve(t.id,!0);if(u)return u;await new Promise($=>setTimeout($,500*i));const{data:O,error:y}=await C.from("users").insert({auth_user_id:t.id,email:t.email,name:a,avatar_url:m,role:"atleta",created_at:new Date().toISOString(),onboarding:!1}).select().single();if(y)if(y.code==="23505"){const $=await ve(t.id,!0);if($)return $;if(t.email){const w=await xs(t.email);if(w)return w}i++;continue}else throw console.error("createUserFromAuth: Erro ao criar usuário:",y),y;else h=O}catch(u){if(console.error(`createUserFromAuth: Erro na tentativa #${i}:`,u),i++,i>=z)throw u}return h}catch(p){return console.error("createUserFromAuth: Erro inesperado:",p),null}},vs=async(t,g)=>{try{if(!t)return console.error("updateUser: ID do usuário não fornecido"),null;const{data:c,error:o}=await C.from("users").update(g).eq("id",t).select().single();if(o)throw console.error("updateUser: Erro ao atualizar usuário:",o),o;return c}catch(c){throw console.error("updateUser: Erro inesperado:",c),c}},xs=async t=>{if(!t)return null;try{const{data:g,error:c}=await C.from("users").select("*").eq("email",t).maybeSingle();return c?(console.error("getUserByEmail: Erro ao buscar usuário por email:",c),null):g}catch(g){return console.error("getUserByEmail: Erro ao executar busca:",g),null}},Lt=async t=>{try{const g={...t,role:"atleta",onboarding:!1},{data:c,error:o}=await C.from("users").insert(g).select().single();if(o){if(o.code==="23505"){if(t.email){const p=await xs(t.email);if(p)return p}if(t.auth_user_id){const p=await ve(t.auth_user_id);if(p)return p}}return null}return c}catch(g){return console.error("createUserForService: Erro geral:",g),null}},ds=({isOpen:t,onClose:g})=>{const{user:c}=ce(),[o,p]=s.useState(!1),[a,m]=s.useState(null),[i,z]=s.useState(!1),[h,u]=s.useState({name:"",email:"",avatar_url:"",role:"",openpix_pix_key:"",openpix_pix_key_type:"EMAIL",rua:"",bairro:"",cidade:"",estado:"",cep:"",numero:"",complemento:""}),[O,y]=s.useState(null),[$,w]=s.useState(null),[_,R]=s.useState("perfil"),M=x=>{switch(x){case"tecnico":return"Técnico";case"atleta":return"Atleta";case"fa":return"Fã";case"admin":return"Administrador";default:return x||"Não definido"}};s.useEffect(()=>{t&&(async()=>{if(c!=null&&c.id)try{p(!0);const n=await ve(c.id);n&&(u({name:n.name||"",email:n.email||"",avatar_url:n.avatar_url||"",role:n.role||"",openpix_pix_key:n.openpix_pix_key||"",openpix_pix_key_type:n.openpix_pix_key_type||"EMAIL",rua:n.rua||"",bairro:n.bairro||"",cidade:n.cidade||"",estado:n.estado||"",cep:n.cep||"",numero:n.numero||"",complemento:n.complemento||""}),n.avatar_url&&w(n.avatar_url))}catch(n){console.error("Erro ao buscar dados do usuário:",n),m("Não foi possível carregar seus dados. Por favor, tente novamente.")}finally{p(!1)}})()},[c,t]);const F=x=>{const{name:n,value:l}=x.target;u(f=>({...f,[n]:l}))},v=x=>{var l;const n=(l=x.target.files)==null?void 0:l[0];if(n){y(n);const f=new FileReader;f.onloadend=()=>{w(f.result)},f.readAsDataURL(n)}},D=async()=>{if(!O||!c)return null;try{const x=O.name.split(".").pop(),l=`${`avatar-${c.id}-${Date.now()}.${x}`}`,{error:f}=await C.storage.from("image").upload(l,O);if(f)throw console.error("Erro ao fazer upload do avatar:",f),new Error("Não foi possível fazer upload da imagem.");const{data:N}=C.storage.from("image").getPublicUrl(l);return N.publicUrl}catch(x){throw console.error("Erro no processo de upload:",x),x}},P=async x=>{x.preventDefault(),p(!0),m(null),z(!1);try{if(!c)throw new Error("Usuário não autenticado");const n=await ve(c.id);if(!n)throw new Error("Usuário não encontrado");let l=h.avatar_url;if(O)try{const j=await D();j&&(l=j)}catch(j){console.error("Erro no upload do avatar:",j)}if(h.role==="tecnico"&&!h.openpix_pix_key){m("Informe a chave Pix da subconta."),p(!1);return}const f={name:h.name,avatar_url:l,rua:h.rua,bairro:h.bairro,cidade:h.cidade,estado:h.estado,cep:h.cep,numero:h.numero,complemento:h.complemento};if(h.role==="tecnico"&&(f.openpix_pix_key=h.openpix_pix_key,f.openpix_pix_key_type=h.openpix_pix_key_type),!await vs(n.id,f))throw new Error("Não foi possível atualizar o usuário");const r={...n,name:h.name,avatar_url:l,cacheTime:Date.now()};localStorage.setItem(`user_data_${c.id}`,JSON.stringify(r)),z(!0),setTimeout(()=>{g(),window.location.reload()},1500)}catch(n){console.error("Erro ao atualizar perfil:",n),m(n.message||"Não foi possível atualizar seu perfil. Por favor, tente novamente.")}finally{p(!1)}};return t?e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",style:{animation:"fadeIn 0.3s ease-out"},children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",style:{animation:"slideDown 0.3s ease-out"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b rounded-t-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Editar Perfil"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex mb-6 border-b",children:[e.jsx("button",{type:"button",className:`px-4 py-2 font-medium border-b-2 transition-colors ${_==="perfil"?"border-green-600 text-green-600":"border-transparent text-gray-500"}`,onClick:()=>R("perfil"),children:"Perfil"}),e.jsx("button",{type:"button",className:`px-4 py-2 font-medium border-b-2 transition-colors ${_==="endereco"?"border-green-600 text-green-600":"border-transparent text-gray-500"}`,onClick:()=>R("endereco"),children:"Endereço"})]}),o&&!a?e.jsx("div",{className:"flex justify-center my-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"})}):e.jsxs("form",{onSubmit:P,children:[a&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:a}),i&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"Perfil atualizado com sucesso!"}),_==="perfil"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center",children:$?e.jsx("img",{src:$,alt:"Avatar",className:"w-full h-full object-cover",onError:()=>w(null)}):e.jsx(_e,{size:40,className:"text-gray-400"})}),e.jsx("label",{htmlFor:"avatar-upload",className:"absolute bottom-0 right-0 bg-green-600 text-white p-1 rounded-full cursor-pointer hover:bg-green-700 transition-colors",children:e.jsx(Me,{size:16})}),e.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",className:"hidden",onChange:v})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Nome"}),e.jsx("input",{type:"text",name:"name",value:h.name,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:h.email,disabled:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O email não pode ser alterado."})]}),h.role==="tecnico"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Tipo da Chave Pix (Subconta)"}),e.jsxs("select",{name:"openpix_pix_key_type",value:h.openpix_pix_key_type,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"EMAIL",children:"Email"}),e.jsx("option",{value:"PHONE",children:"Telefone"}),e.jsx("option",{value:"RANDOM_KEY",children:"Chave Aleatória"}),e.jsx("option",{value:"CPF",children:"CPF"}),e.jsx("option",{value:"CNPJ",children:"CNPJ"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Chave Pix da Subconta"}),e.jsx("input",{type:"text",name:"openpix_pix_key",value:h.openpix_pix_key,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"ex: email@dominio.com"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Tipo de Perfil"}),e.jsx("div",{className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-600",children:M(h.role)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O tipo de perfil foi definido durante o onboarding e não pode ser alterado."})]})]}),_==="endereco"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Rua"}),e.jsx("input",{type:"text",name:"rua",value:h.rua,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Número"}),e.jsx("input",{type:"text",name:"numero",value:h.numero,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Bairro"}),e.jsx("input",{type:"text",name:"bairro",value:h.bairro,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Cidade"}),e.jsx("input",{type:"text",name:"cidade",value:h.cidade,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Estado"}),e.jsx("input",{type:"text",name:"estado",value:h.estado,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"CEP"}),e.jsx("input",{type:"text",name:"cep",value:h.cep,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Complemento"}),e.jsx("input",{type:"text",name:"complemento",value:h.complemento,onChange:F,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg mr-2 hover:bg-gray-50 transition-colors",disabled:o,children:"Cancelar"}),e.jsx("button",{type:"submit",className:`
                    px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors
                    ${o?"opacity-50 cursor-not-allowed":""}
                  `,disabled:o,children:o?"Salvando...":"Salvar"})]})]})]})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideDown {
          from { 
            opacity: 0;
            transform: translateY(-50px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
      `}})]}):null},Gs=({activeTab:t,setActiveTab:g})=>{const c=he(),{isCollapsed:o,toggleSidebar:p,isMobile:a,isOpen:m,toggleMobileSidebar:i,closeMobileSidebar:z}=cs(),{logout:h,user:u}=ce(),[O,y]=s.useState(""),[$,w]=s.useState(null),[_,R]=s.useState(null),[M,F]=s.useState(!1),[v,D]=s.useState(!1),P=n=>{switch(g(n),a&&z(),n){case"home":c("/dashboard");break;case"teams":c("/minhaequipe");break;case"allteams":c("/equipes");break;case"tournaments":c("/ligastorneios");break;case"store":c("/loja");break;case"storeOnline":c("/loja-online");break;case"orders":c("/meus-pedidos");break;case"sales":c("/minhas-vendas");break;case"calendar":case"calendario":c("/calendario");break;case"settings":c("/configuracoes");break;case"account":c("/conta");break;default:c("/dashboard")}},x=async()=>{try{F(!0),await h(),c("/login")}catch(n){console.error("Error during logout:",n)}finally{F(!1)}};return s.useEffect(()=>{(async()=>{if(u!=null&&u.id)try{const l=localStorage.getItem(`user_data_${u.id}`);if(l){const N=JSON.parse(l),r=N.cacheTime||0;if(Date.now()-r<6e5){console.log("Usando dados de usuário em cache"),y(N.name||""),w(N.avatar_url||null),N.role&&(console.log("Role do usuário (do cache):",N.role),R(N.role));return}}console.log("Buscando dados de usuário do servidor");const f=await ve(u.id);if(console.log("Dados do usuário recebidos:",f),f!=null&&f.name&&y(f.name),f!=null&&f.avatar_url&&w(f.avatar_url),f!=null&&f.role&&(console.log("Role do usuário (do servidor):",f.role),R(f.role)),f){const N={...f,role:f.role,cacheTime:Date.now()};console.log("Salvando no cache com papel:",N.role),localStorage.setItem(`user_data_${u.id}`,JSON.stringify(N))}}catch(l){console.error("Error fetching user data:",l)}})()},[u]),a&&!m?null:(console.log("Renderizando Sidebar, userRole:",_),e.jsxs(e.Fragment,{children:[e.jsx(ds,{isOpen:v,onClose:()=>D(!1)}),a&&m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 animate-fadeIn",onClick:i}),e.jsxs("div",{className:`
          bg-black text-white h-screen fixed z-30 top-0 overflow-y-auto 
          transition-all duration-300 ease-in-out transform
          ${o&&!a?"w-16":"w-64"} 
          ${a?m?"translate-x-0 shadow-lg animate-slideIn":"-translate-x-full animate-slideOut":"left-0"}
        `,children:[e.jsxs("div",{className:`${o&&!a?"py-4 px-2":"p-4"} flex ${o&&!a?"justify-center":"flex-col items-center"} space-y-2`,children:[(!o||a)&&e.jsx("img",{src:Qe,alt:"Logo",className:"h-16 w-auto"}),!a&&e.jsx("button",{onClick:p,className:"absolute right-2 top-4 p-1 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:o?e.jsx(ns,{size:18}):e.jsx(ls,{size:18})}),a&&e.jsx("button",{onClick:i,className:"absolute right-2 top-4 p-1 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors",children:e.jsx(le,{size:18})})]}),e.jsxs("div",{className:`${o&&!a?"mt-14":"mt-2"}`,children:[e.jsx("div",{className:"absolute bottom-0 left-0 right-0 border-t border-gray-800",children:e.jsxs("div",{className:`p-4 ${o&&!a?"justify-center":""} flex items-center space-x-3`,children:[(!o||a)&&e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>D(!0),children:[$?e.jsx("img",{src:$,alt:O,className:"w-8 h-8 rounded-full"}):e.jsx(_e,{size:20,className:"text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:O||"Usuário"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Editar perfil"})]})]})}),e.jsx("button",{onClick:x,className:"p-2 text-gray-400 hover:text-white transition-colors",disabled:M,title:"Sair",children:e.jsx(gs,{size:20})})]})}),_&&_==="fa"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>P("calendar"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="calendar"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Calendário",children:[e.jsx(je,{size:20,className:`${t==="calendar"||t==="calendario"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="calendar"||t==="calendario"?"text-green-400":""} transition-colors duration-200`,children:"Calendário"})]}),e.jsxs("button",{onClick:()=>P("allteams"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="allteams"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Equipes",children:[e.jsx(Le,{size:20,className:`${t==="allteams"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="allteams"?"text-green-400":""} transition-colors duration-200`,children:"Equipes"})]}),e.jsxs("button",{onClick:()=>P("storeOnline"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="storeOnline"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Loja Online",children:[e.jsx(qe,{size:20,className:`${t==="storeOnline"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="storeOnline"?"text-green-400":""} transition-colors duration-200`,children:"Loja Online"})]}),e.jsxs("button",{onClick:()=>P("orders"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="orders"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Meus Pedidos",children:[e.jsx(_s,{size:20,className:`${t==="orders"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="orders"?"text-green-400":""} transition-colors duration-200`,children:"Meus Pedidos"})]}),e.jsxs("button",{onClick:()=>P("tournaments"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="tournaments"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Ligas e Torneios",children:[e.jsx(be,{size:20,className:`${t==="tournaments"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="tournaments"?"text-green-400":""} transition-colors duration-200`,children:"Ligas e Torneios"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>P("home"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="home"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Dashboard",children:[e.jsx(Ds,{size:20,className:`${t==="home"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="home"?"text-green-400":""} transition-colors duration-200`,children:"Dashboard"})]}),e.jsxs("button",{onClick:()=>P("calendar"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="calendar"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Calendário",children:[e.jsx(je,{size:20,className:`${t==="calendar"||t==="calendario"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="calendar"||t==="calendario"?"text-green-400":""} transition-colors duration-200`,children:"Calendário"})]}),e.jsxs("button",{onClick:()=>P("allteams"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="allteams"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Equipes",children:[e.jsx(Le,{size:20,className:`${t==="allteams"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="allteams"?"text-green-400":""} transition-colors duration-200`,children:"Equipes"})]}),e.jsxs("button",{onClick:()=>P("storeOnline"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="storeOnline"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Loja Online",children:[e.jsx(qe,{size:20,className:`${t==="storeOnline"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="storeOnline"?"text-green-400":""} transition-colors duration-200`,children:"Loja Online"})]}),e.jsxs("button",{onClick:()=>P("orders"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="orders"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Meus Pedidos",children:[e.jsx(_s,{size:20,className:`${t==="orders"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="orders"?"text-green-400":""} transition-colors duration-200`,children:"Meus Pedidos"})]}),e.jsxs("button",{onClick:()=>P("tournaments"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="tournaments"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Ligas e Torneios",children:[e.jsx(be,{size:20,className:`${t==="tournaments"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="tournaments"?"text-green-400":""} transition-colors duration-200`,children:"Ligas e Torneios"})]}),(!o||a)&&e.jsx("div",{className:"px-4 py-2 mt-6 text-gray-400 uppercase text-xs font-semibold",children:"Configurações"}),o&&!a&&e.jsx("div",{className:"mt-6"}),e.jsxs("button",{onClick:()=>P("store"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="store"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Minha Loja",children:[e.jsx(qe,{size:20,className:`${t==="store"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="store"?"text-green-400":""} transition-colors duration-200`,children:"Minha Loja"})]}),e.jsxs("button",{onClick:()=>P("sales"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="sales"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Minhas Vendas",children:[e.jsx(Ue,{size:20,className:`${t==="sales"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="sales"?"text-green-400":""} transition-colors duration-200`,children:"Minhas Vendas"})]}),e.jsxs("button",{onClick:()=>P("teams"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="teams"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Minha Equipe",children:[e.jsx(Se,{size:20,className:`${t==="teams"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="teams"?"text-green-400":""} transition-colors duration-200`,children:"Minha Equipe"})]}),e.jsxs("button",{onClick:()=>P("account"),className:`flex ${o&&!a?"justify-center":"items-center space-x-3"} w-full px-4 py-3 ${t==="account"?"bg-gray-800":"hover:bg-gray-800"} transition-colors duration-200`,title:"Minha Conta",children:[e.jsx(hs,{size:20,className:`${t==="account"?"text-green-400":""} transition-colors duration-200`}),(!o||a)&&e.jsx("span",{className:`${t==="account"?"text-green-400":""} transition-colors duration-200`,children:"Minha Conta"})]})]})]})]})]}))},Bs=()=>{const{isMobile:t,toggleMobileSidebar:g}=cs(),{user:c,logout:o}=ce(),[p,a]=s.useState(""),[m,i]=s.useState(""),[z,h]=s.useState(null),[u,O]=s.useState(!1),[y,$]=s.useState(!1),w=s.useRef(null);s.useEffect(()=>{const F=v=>{w.current&&!w.current.contains(v.target)&&O(!1)};return document.addEventListener("mousedown",F),()=>{document.removeEventListener("mousedown",F)}},[]),s.useEffect(()=>{(async()=>{if(c!=null&&c.id)try{const v=localStorage.getItem(`user_data_${c.id}`);if(v){const P=JSON.parse(v),x=P.cacheTime||0;if(Date.now()-x<6e5){if(console.log("Navbar: Usando dados de usuário em cache"),P.name){a(P.name);const l=P.name.split(" "),f=l.length>1?`${l[0][0]}${l[l.length-1][0]}`:l[0][0];i(f.toUpperCase())}P.avatar_url&&h(P.avatar_url);return}}console.log("Navbar: Buscando dados de usuário do servidor");const D=await ve(c.id);if(D!=null&&D.name){a(D.name);const P=D.name.split(" "),x=P.length>1?`${P[0][0]}${P[P.length-1][0]}`:P[0][0];i(x.toUpperCase())}D!=null&&D.avatar_url&&h(D.avatar_url),D&&localStorage.setItem(`user_data_${c.id}`,JSON.stringify({...D,cacheTime:Date.now()}))}catch(v){console.error("Error fetching user data:",v)}})()},[c]);const _=async()=>{try{await o(),window.location.href="/login"}catch(F){console.error("Erro ao fazer logout:",F)}},R=()=>{O(!u)},M=()=>{O(!1),$(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ds,{isOpen:y,onClose:()=>$(!1)}),e.jsxs("header",{className:"bg-white shadow-sm p-4 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center space-x-3",children:t&&e.jsx("button",{onClick:g,className:"p-2 rounded-md hover:bg-gray-100 text-gray-700","aria-label":"Toggle menu",children:e.jsx(ot,{size:24})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{className:"relative p-2 text-gray-500 hover:text-green-600",children:[e.jsx(nt,{size:20}),e.jsx("span",{className:"absolute top-0 right-0 h-4 w-4 bg-red-500 rounded-full text-white text-xs flex items-center justify-center",children:"3"})]}),e.jsxs("div",{className:"relative",ref:w,children:[e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:R,children:[z?e.jsx("img",{src:z,alt:"Avatar do usuário",className:"w-8 h-8 rounded-full object-cover border border-gray-200",onError:()=>h(null)}):e.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center text-white font-semibold",children:m||"?"}),e.jsx("span",{className:"font-medium hidden sm:inline",children:p||"Usuário"}),e.jsx(Ps,{size:16,className:`transition-transform ${u?"transform rotate-180":""}`})]}),u&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 border border-gray-200",children:[e.jsxs("button",{onClick:M,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(_e,{size:16,className:"mr-2"}),"Editar Perfil"]}),e.jsxs("button",{onClick:_,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(gs,{size:16,className:"mr-2"}),"Sair"]})]})]})]})]})]})},$t=()=>{var P,x,n,l;const t=he(),[g,c]=s.useState("home"),{isCollapsed:o,isMobile:p}=cs(),{user:a}=ce(),[m,i]=s.useState(!0),[z,h]=s.useState(null),[u,O]=s.useState(0),[y,$]=s.useState(0),[w,_]=s.useState([]),[R,M]=s.useState([]);s.useEffect(()=>{(async()=>{try{if(i(!0),!a)return;const{data:N,error:r}=await C.from("leagues").select("*").order("created_at",{ascending:!1});if(r)throw r;const{data:j,error:k}=await C.from("tournaments").select("*").order("created_at",{ascending:!1});if(k)throw k;const U=new Date().toISOString().split("T")[0],{data:T,error:A}=await C.from("games").select("*, sports_organizations(name, logo_url)").gte("game_date",U).order("game_date",{ascending:!0}).limit(3);if(A)throw A;$((N==null?void 0:N.length)||0),O((j==null?void 0:j.length)||0),_(T||[]),M((j==null?void 0:j.slice(0,3))||[])}catch(N){console.error("Erro ao buscar dados do dashboard:",N),h("Não foi possível carregar os dados. Por favor, tente novamente.")}finally{i(!1)}})()},[a]);const F=f=>{const[N,r,j]=f.split("-");return new Date(`${N}-${r}-${j}T00:00:00`).toLocaleDateString("pt-BR")},v=()=>{if(w.length===0)return"0";const[f,N,r]=w[0].game_date.split("-"),j=new Date(`${f}-${N}-${r}T00:00:00`),k=new Date;k.setHours(0,0,0,0);const U=Math.abs(j.getTime()-k.getTime()),T=Math.ceil(U/(1e3*60*60*24));return T===0?"Hoje":`${T} dia${T>1?"s":""}`},D=[{id:1,name:"Camisa Oficial 2025",price:"R$ 199,90",stock:45},{id:2,name:"Shorts de Treino",price:"R$ 89,90",stock:30},{id:3,name:"Bola ProHero",price:"R$ 149,90",stock:15}];return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(Gs,{activeTab:g,setActiveTab:c}),e.jsxs("div",{className:`
          transition-all duration-300
          ${p?"ml-0":o?"ml-16":"ml-0 md:ml-64"}
        `,children:[e.jsx(Bs,{}),e.jsx("main",{className:"p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[g==="home"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(us,{className:"mr-2"}),"Dashboard"]}),e.jsxs("p",{className:"text-gray-600",children:["Bem-vindo de volta, ",((P=a==null?void 0:a.user_metadata)==null?void 0:P.name)||((x=a==null?void 0:a.email)==null?void 0:x.split("@")[0])||"Usuário","!"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center",children:[e.jsx("div",{className:"rounded-full bg-green-100 p-3 mr-4",children:e.jsx(be,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Torneios"}),e.jsx("p",{className:"text-2xl font-semibold",children:m?e.jsx("span",{className:"inline-block w-8 h-6 bg-gray-200 animate-pulse rounded"}):u})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-3 mr-4",children:e.jsx(Se,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Ligas"}),e.jsx("p",{className:"text-2xl font-semibold",children:m?e.jsx("span",{className:"inline-block w-8 h-6 bg-gray-200 animate-pulse rounded"}):y})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center",children:[e.jsx("div",{className:"rounded-full bg-yellow-100 p-3 mr-4",children:e.jsx(lt,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Próximo Jogo"}),e.jsx("p",{className:"text-2xl font-semibold",children:m?e.jsx("span",{className:"inline-block w-16 h-6 bg-gray-200 animate-pulse rounded"}):v()})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center",children:[e.jsx("div",{className:"rounded-full bg-purple-100 p-3 mr-4",children:e.jsx(Cs,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Vendas (Mês)"}),e.jsx("p",{className:"text-2xl font-semibold",children:"R$ 3.240"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Próximos Jogos"}),e.jsx("button",{onClick:()=>t("/calendario"),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"Ver todos"})]}),e.jsxs("div",{className:"p-4",children:[z&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:z}),m?e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-10 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"})]}):w.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum jogo agendado."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Adversário"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horário"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Local"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(f=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:f.opponent_name}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:F(f.game_date)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:f.game_time}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:f.location})]},f.id))})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Torneios"}),e.jsx("button",{onClick:()=>t("/ligastorneios"),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"Ver todos"})]}),e.jsx("div",{className:"p-4",children:m?e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"})]}):R.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum torneio encontrado."}):e.jsx("ul",{className:"divide-y divide-gray-200",children:R.map(f=>e.jsx("li",{className:"py-3",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.name}),e.jsx("p",{className:"text-xs text-gray-500",children:f.format==="knockout"?"Eliminatório":f.format==="points"?"Pontos Corridos":f.format==="group_stage"?"Fase de Grupos":f.format==="mixed"?"Misto":f.format})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f.status==="in_progress"?"bg-green-100 text-green-800":f.status==="open_registration"?"bg-blue-100 text-blue-800":(f.status==="finished","bg-gray-100 text-gray-800")}`,children:f.status==="in_progress"?"Em andamento":f.status==="open_registration"?"Inscrições abertas":f.status==="finished"?"Finalizado":f.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f.start_date?`Início: ${F(f.start_date)}`:"Data não definida"})]})]})},f.id))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Produtos Populares"}),e.jsx("button",{onClick:()=>t("/loja-online"),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"Ver loja"})]}),e.jsx("div",{className:"p-4",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:D.map(f=>e.jsxs("li",{className:"py-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Estoque: ",f.stock," unidades"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:f.price})})]},f.id))})})]})]})]}),g==="tournaments"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(be,{className:"mr-2"}),"Ligas e Torneios"]})}),e.jsx("p",{className:"text-gray-600",children:"Conteúdo da página de torneios será exibido aqui."})]}),g==="teams"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(Se,{className:"mr-2"}),"Minha Equipe"]})}),e.jsx("p",{className:"text-gray-600",children:"Conteúdo da página de equipes será exibido aqui."})]}),g==="store"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(Cs,{className:"mr-2"}),"Loja - Em Breve"]})}),e.jsx("p",{className:"text-gray-600",children:"Conteúdo da loja será exibido aqui."})]}),g==="calendar"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(us,{className:"mr-2"}),"Calendário"]})}),e.jsx("p",{className:"text-gray-600",children:"Conteúdo do calendário será exibido aqui."})]}),g==="settings"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(us,{className:"mr-2"}),"Configurações"]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Informações da Conta"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:((n=a==null?void 0:a.user_metadata)==null?void 0:n.name)||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a==null?void 0:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo de Login"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:((l=a==null?void 0:a.app_metadata)==null?void 0:l.provider)==="google"?"Google":"Email e Senha"})]})]})]})})]})]})})]})]})},qt=()=>{const t=he(),{signUp:g,signInWithGoogle:c}=ce(),[o,p]=s.useState(!1),[a,m]=s.useState(null),[i,z]=s.useState({email:"",password:"",name:"",confirmPassword:""}),h=y=>{z({...i,[y.target.name]:y.target.value})},u=async y=>{if(y.preventDefault(),m(null),p(!0),i.password!==i.confirmPassword){m("As senhas não coincidem"),p(!1);return}if(i.password.length<6){m("A senha deve ter pelo menos 6 caracteres"),p(!1);return}try{const{data:$,error:w}=await g({email:i.email,password:i.password,name:i.name,options:{data:{name:i.name}}});if(w)throw w;if($!=null&&$.user)try{const{data:_}=await C.from("users").select("*").eq("email",i.email).maybeSingle();if(_){if(_.auth_user_id!==$.user.id){const{error:R}=await C.from("users").update({auth_user_id:$.user.id}).eq("id",_.id);if(R)throw console.error("Erro ao atualizar auth_user_id:",R),new Error("Erro ao atualizar registro do usuário")}t("/dashboard")}else{const{error:R}=await C.from("users").insert({auth_user_id:$.user.id,email:i.email,name:i.name,role:"atleta",created_at:new Date().toISOString(),onboarding:!1});if(R)throw console.error("Erro ao criar registro do usuário:",R),new Error("Erro ao criar registro do usuário");t("/onboarding")}}catch(_){console.error("Erro ao interagir com o banco de dados:",_),m("Erro ao criar registro do usuário")}}catch($){console.error("Erro no cadastro:",$),m($ instanceof Error?Re($.message):"Ocorreu um erro durante o cadastro.")}finally{p(!1)}},O=async()=>{try{p(!0),await c()}catch(y){console.error("Erro no login com Google:",y),m("Ocorreu um erro durante o login com Google"),p(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 transition-all duration-1000 opacity-100",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(${bs})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-black/90 backdrop-blur-lg rounded-2xl shadow-xl p-8 transition-transform duration-300",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("img",{src:Qe,alt:"Logo",className:"h-24 w-auto mb-4 rounded-lg"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Criar Conta"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Preencha os dados para se cadastrar"})]}),a&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4",children:a}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(it,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"text",name:"name",placeholder:"Seu nome completo",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:i.name,onChange:h,required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(As,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"email",name:"email",placeholder:"Seu email",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:i.email,onChange:h,required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",name:"password",placeholder:"Sua senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:i.password,onChange:h,required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"Confirme sua senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:i.confirmPassword,onChange:h,required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:-translate-y-0.5 transition-all duration-300",children:o?"Processando...":"Criar Conta"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-600"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-black text-gray-400",children:"Ou continue com"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:O,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-800 py-3 rounded-lg font-medium hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-300",children:[e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"}),e.jsx("path",{d:"M1 1h22v22H1z",fill:"none"})]}),"Google"]})})]}),e.jsxs("p",{className:"mt-6 text-center text-gray-300",children:["Já tem uma conta?"," ",e.jsx("button",{onClick:()=>t("/login"),className:"text-green-400 hover:text-green-300 font-semibold transition-colors duration-300",children:"Entrar"})]})]})})})},Ot=()=>{const t=he(),[g,c]=s.useState("Processando autenticação..."),[o,p]=s.useState(null),[a,m]=s.useState(!1);return s.useEffect(()=>{(async()=>{try{console.log("AuthCallback: Iniciando processamento"),c("Verificando autenticação...");const{data:z,error:h}=await C.auth.getUser();if(console.log("AuthCallback: Dados do usuário:",z),h){console.error("AuthCallback: Erro ao obter usuário:",h),p(`Erro na autenticação: ${Re(h.message)}`),c("Erro na autenticação"),setTimeout(()=>t("/login"),3e3);return}if(!(z!=null&&z.user)){console.error("AuthCallback: Usuário não encontrado"),p("Usuário não encontrado"),c("Usuário não encontrado"),setTimeout(()=>t("/login"),3e3);return}const O=!await ve(z.user.id);m(O),c("Processando registro de usuário...");try{let y=await ys(z.user);if(y||(y=await Lt(z.user)),!y)throw new Error("Não foi possível criar o registro do usuário");console.log("AuthCallback: Usuário processado com sucesso:",y),O||y.onboarding===!1?(c("Redirecionando para completar perfil..."),t("/onboarding")):(c("Redirecionando para o dashboard..."),t("/dashboard"))}catch(y){console.error("AuthCallback: Erro ao processar usuário:",y),p(`Aviso: ${Re(y.message)||"Erro ao processar seu perfil"}`),c("Autenticação concluída com avisos")}}catch(z){console.error("AuthCallback: Erro geral:",z),p(`Erro: ${Re(z.message)||"Ocorreu um erro desconhecido"}`),c("Erro no processamento"),setTimeout(()=>t("/login"),3e3)}})()},[t]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:g}),o&&e.jsx("p",{className:"text-red-500 mt-2",children:o}),e.jsx("p",{className:"text-gray-500 mt-2",children:a?"Você será redirecionado para completar seu perfil.":"Você será redirecionado em instantes."})]})})},Tt=()=>{const[t,g]=s.useState(""),[c,o]=s.useState(""),[p,a]=s.useState(!1),[m,i]=s.useState(null),z=he();s.useEffect(()=>{const u=window.location.hash;(!u||!u.includes("type=recovery"))&&z("/login")},[z]);const h=async u=>{if(u.preventDefault(),t!==c){i({text:"As senhas não coincidem",type:"error"});return}if(t.length<6){i({text:"A senha deve ter pelo menos 6 caracteres",type:"error"});return}a(!0);try{const{error:O}=await C.auth.updateUser({password:t});O?i({text:O.message,type:"error"}):(i({text:"Senha atualizada com sucesso!",type:"success"}),setTimeout(()=>{z("/login")},2e3))}catch(O){console.error("Error resetting password:",O),i({text:"Ocorreu um erro ao redefinir sua senha",type:"error"})}finally{a(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-800 to-green-600 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-black/90 backdrop-blur-lg rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("img",{src:Qe,alt:"Logo",className:"h-32 w-auto mb-4 rounded-lg"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Redefinir Senha"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Digite sua nova senha abaixo"})]}),m&&e.jsx("div",{className:`p-3 rounded-lg mb-4 ${m.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.text}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",placeholder:"Nova senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:t,onChange:u=>g(u.target.value),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",placeholder:"Confirme a nova senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:c,onChange:u=>o(u.target.value),required:!0})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:-translate-y-0.5 transition-all duration-300",children:p?"Processando...":"Redefinir Senha"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>z("/login"),className:"text-green-400 hover:text-green-300 font-medium",children:"Voltar para o login"})})]})})})},It=()=>{const{user:t,updateOnboardingCache:g}=ce(),[c,o]=s.useState(null),[p,a]=s.useState(!1),[m,i]=s.useState(null),[z,h]=s.useState(!0),u=s.useRef(!1);s.useEffect(()=>{const $=async()=>{if(t&&!u.current)try{h(!0),await ve(t.id)||(console.log("Usuário não encontrado na tabela users, criando..."),await ys(t)),u.current=!0}catch(w){console.error("Erro ao verificar/criar usuário:",w),i("Ocorreu um erro ao carregar seu perfil. Por favor, recarregue a página.")}finally{h(!1)}};t||(u.current=!1,o(null),i(null)),$()},[t]);const O=async()=>{var $,w;if(!c||!t){i("Por favor, selecione um tipo de perfil para continuar.");return}a(!0),i(null);try{let _;switch(c){case"atleta":_="atleta";break;case"tecnico":_="tecnico";break;case"fa":_="fa";break;default:_="fa"}const R=await ve(t.id);let M;if(R){console.log("Atualizando usuário existente...");const{data:F,error:v}=await C.from("users").update({role:_,onboarding:!0}).eq("id",R.id).select().single();if(v)throw v;M=F,console.log("Usuário atualizado com sucesso:",M)}else{console.log("Criando novo usuário...");const{data:F,error:v}=await C.from("users").insert({auth_user_id:t.id,email:t.email,name:(($=t.user_metadata)==null?void 0:$.name)||((w=t.email)==null?void 0:w.split("@")[0])||"Usuário",role:_,onboarding:!0,created_at:new Date().toISOString()}).select().single();if(v)throw v;M=F,console.log("Usuário criado com sucesso:",M)}if(!M)throw new Error("Falha ao atualizar usuário");console.log("Atualizando cache e redirecionando..."),g(t.id,!0),await new Promise(F=>setTimeout(F,100)),window.location.href="/dashboard"}catch(_){console.error("Erro ao atualizar perfil:",_),i("Ocorreu um erro ao salvar seu perfil. Por favor, tente novamente.")}finally{a(!1)}},y=[{id:"atleta",title:"Atleta",description:"Participe de torneios e acompanhe suas estatísticas",icon:e.jsx(_e,{size:40})},{id:"tecnico",title:"Técnico",description:"Gerencie sua equipe e acompanhe o desempenho dos atletas",icon:e.jsx(be,{size:40})},{id:"fa",title:"Fã",description:"Acompanhe seus atletas e equipes favoritas",icon:e.jsx(ct,{size:40})}];return z?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Carregando..."})]})}):e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:e.jsxs("div",{className:"w-full max-w-3xl bg-white rounded-lg shadow-md p-6 md:p-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-center text-gray-800 mb-8",children:"Bem-vindo ao ProHero Sports!"}),e.jsx("p",{className:"text-center text-gray-600 mb-8",children:"Para personalizar sua experiência, por favor selecione o tipo de perfil que melhor descreve você:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:y.map($=>e.jsxs("div",{className:`
                border-2 rounded-lg p-6 flex flex-col items-center text-center cursor-pointer transition-all duration-200
                ${c===$.id?"border-green-500 bg-green-50 transform scale-105":"border-gray-200 hover:border-green-300 hover:bg-green-50"}
              `,onClick:()=>o($.id),children:[e.jsx("div",{className:`mb-4 ${c===$.id?"text-green-500":"text-gray-700"}`,children:$.icon}),e.jsx("h3",{className:`text-xl font-semibold mb-2 ${c===$.id?"text-green-600":"text-gray-800"}`,children:$.title}),e.jsx("p",{className:"text-gray-600 text-sm",children:$.description})]},$.id))}),m&&e.jsx("div",{className:"text-red-500 text-center mb-4",children:m}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{className:`
              px-8 py-3 rounded-lg font-medium text-white transition-all duration-200
              ${p?"bg-gray-400 cursor-not-allowed":c?"bg-green-600 hover:bg-green-700 transform hover:scale-105":"bg-gray-400 cursor-not-allowed"}
            `,onClick:O,disabled:p||!c,children:p?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processando..."]}):"Continuar"})})]})})},Ne=({children:t,activeTab:g,setActiveTab:c})=>{const{isCollapsed:o,isMobile:p}=cs();return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Gs,{activeTab:g,setActiveTab:c}),e.jsxs("div",{className:`
          transition-all duration-300
          ${o&&!p?"ml-16":"ml-0 md:ml-64"}
        `,children:[e.jsx(Bs,{}),e.jsx("main",{className:"p-6",children:t})]})]})},Ze=({isOpen:t,title:g,message:c,confirmButtonText:o,cancelButtonText:p,onConfirm:a,onCancel:m,confirmButtonColor:i="red"})=>{if(!t)return null;const z=()=>{const h="px-4 py-2 rounded-lg text-white transition-colors";switch(i){case"green":return`${h} bg-green-600 hover:bg-green-700`;case"blue":return`${h} bg-blue-600 hover:bg-blue-700`;case"red":default:return`${h} bg-red-600 hover:bg-red-700`}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",style:{animation:"fadeIn 0.3s ease-out"},children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",style:{animation:"slideDown 0.3s ease-out"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b rounded-t-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:g}),e.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-6",children:c}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:p}),e.jsx("button",{type:"button",onClick:a,className:z(),children:o})]})]})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideDown {
          from { 
            opacity: 0;
            transform: translateY(-50px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
      `}})]})},Ke=({value:t,onChange:g,onStateChange:c,className:o="",placeholder:p="Selecione uma cidade"})=>{const[a,m]=s.useState(!1),[i,z]=s.useState(""),[h,u]=s.useState(null),[O,y]=s.useState([]),[$,w]=s.useState([]),[_,R]=s.useState(!1),[M,F]=s.useState(null),v=s.useRef(null);s.useEffect(()=>{(async()=>{try{R(!0),F(null);const f=(await(await fetch("https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome")).json()).reduce((k,U)=>(k[U.id]=U.sigla,k),{}),j=(await(await fetch("https://servicodados.ibge.gov.br/api/v1/localidades/municipios?orderBy=nome")).json()).map(k=>{var T,A,b,L,S,E,B,Z,q,ee,J,W,d;let U;try{if((b=(A=(T=k.microrregiao)==null?void 0:T.mesorregiao)==null?void 0:A.UF)!=null&&b.id)U=k.microrregiao.mesorregiao.UF.id;else if((B=(E=(S=(L=k.municipio)==null?void 0:L.microrregiao)==null?void 0:S.mesorregiao)==null?void 0:E.UF)!=null&&B.id)U=k.municipio.microrregiao.mesorregiao.UF.id;else if((Z=k.regiao)!=null&&Z.id)U=k.regiao.id;else if((q=k.UF)!=null&&q.id)U=k.UF.id;else if((ee=k.estado)!=null&&ee.id)U=k.estado.id;else if((d=(W=(J=k["regiao-imediata"])==null?void 0:J["regiao-intermediaria"])==null?void 0:W.UF)!=null&&d.id)U=k["regiao-imediata"]["regiao-intermediaria"].UF.id;else if(k.id){const Y=String(k.id);if(Y.length>=2){const Q=Y.substring(0,2),re=Object.entries(f).find(([oe])=>String(oe).substring(0,2)===Q);re&&(U=re[0])}}}catch(Y){console.warn("Erro ao processar cidade:",k,Y)}return{name:k.nome,state:U?f[U]:"UF"}}).filter(k=>k.name&&k.state);y(j),w(j.slice(0,100))}catch(n){console.error("Erro ao buscar cidades:",n),F("Não foi possível carregar a lista de cidades.");const l=[{name:"São Paulo",state:"SP"},{name:"Rio de Janeiro",state:"RJ"},{name:"Brasília",state:"DF"},{name:"Salvador",state:"BA"},{name:"Fortaleza",state:"CE"},{name:"Belo Horizonte",state:"MG"},{name:"Manaus",state:"AM"},{name:"Curitiba",state:"PR"},{name:"Recife",state:"PE"},{name:"Porto Alegre",state:"RS"}];y(l),w(l)}finally{R(!1)}})()},[]),s.useEffect(()=>{if(i.trim()==="")w(O.slice(0,100));else{const x=O.filter(n=>n.name.toLowerCase().includes(i.toLowerCase())||n.state.toLowerCase().includes(i.toLowerCase()));w(x.slice(0,100))}},[i,O]),s.useEffect(()=>{const x=n=>{v.current&&!v.current.contains(n.target)&&m(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]),s.useEffect(()=>{if(t){const x=t.split(",").map(f=>f.trim()),n=x[0],l=x[1]||"";u(n?{name:n,state:l}:null)}else u(null)},[t]);const D=x=>{u(x),g(x.name,x.state),c&&c(x.state),m(!1),z("")},P=()=>{u(null),g("",""),c&&c("")};return e.jsxs("div",{className:`relative ${o}`,ref:v,children:[e.jsxs("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent flex justify-between items-center cursor-pointer",onClick:()=>m(!a),children:[h?e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("span",{children:[h.name,", ",h.state]}),e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:x=>{x.stopPropagation(),P()},children:e.jsx(le,{size:16})})]}):e.jsx("span",{className:"text-gray-500",children:p}),e.jsx(Ps,{size:18,className:`ml-2 text-gray-400 transition-transform ${a?"transform rotate-180":""}`})]}),a&&e.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b sticky top-0 bg-white",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i,onChange:x=>z(x.target.value),placeholder:"Pesquisar cidade...",className:"w-full px-3 py-2 pl-9 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",onClick:x=>x.stopPropagation(),autoFocus:!0}),e.jsx(Le,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-48",children:[_?e.jsxs("div",{className:"flex justify-center items-center py-4",children:[e.jsx(Ls,{size:24,className:"animate-spin text-green-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Carregando cidades..."})]}):M?e.jsx("div",{className:"px-4 py-2 text-red-500 text-center",children:M}):$.length>0?$.map((x,n)=>e.jsxs("div",{className:`px-4 py-2 cursor-pointer hover:bg-gray-100 ${h&&h.name===x.name&&h.state===x.state?"bg-green-50 text-green-700":""}`,onClick:()=>D(x),children:[e.jsx("span",{className:"font-medium",children:x.name}),e.jsx("span",{className:"text-gray-500 ml-2",children:x.state})]},`${x.name}-${x.state}-${n}`)):e.jsx("div",{className:"px-4 py-2 text-gray-500 text-center",children:"Nenhuma cidade encontrada"}),!_&&!M&&i.trim()===""&&O.length>100&&e.jsx("div",{className:"px-4 py-2 text-gray-500 text-center text-sm",children:"Mostrando as primeiras 100 cidades. Digite para pesquisar mais."})]})]})]})},Ft=({isOpen:t,onClose:g,team:c,onSuccess:o})=>{const[p,a]=s.useState(!1),[m,i]=s.useState(null),[z,h]=s.useState(!1),[u,O]=s.useState({name:"",organization_type:"",modalidade_id:"",subcategoria_id:"",esporte_id:"",city:"",state:"",country:"",description:"",logo_url:"",capa_url:""}),[y,$]=s.useState(null),[w,_]=s.useState(null),[R,M]=s.useState(null),[F,v]=s.useState(null),[D,P]=s.useState([]),[x,n]=s.useState([]),[l,f]=s.useState([]);s.useEffect(()=>{const b=async()=>{const{data:L,error:S}=await C.from("esportes").select("*").eq("ativo",!0).order("nome");!S&&L&&P(L)};c&&t&&(O({name:c.name,organization_type:c.organization_type,modalidade_id:c.modalidade_id||"",subcategoria_id:c.subcategoria_id||"",esporte_id:c.esporte_id||"",city:c.city,state:c.state,country:c.country,description:c.description,logo_url:c.logo_url||"",capa_url:c.capa_url||""}),_(c.capa_url),v(c.logo_url),$(null),M(null),i(null),h(!1),b())},[c,t]),s.useEffect(()=>{(async()=>{if(!u.organization_type){n([]);return}const L=D.find(B=>B.nome===u.organization_type);if(!L){n([]);return}const{data:S,error:E}=await C.from("modalidades").select("*").eq("esporte_id",L.id).eq("ativo",!0).order("nome");n(!E&&S?S:[])})()},[u.organization_type,D]),s.useEffect(()=>{(async()=>{if(!u.modalidade_id){f([]);return}const{data:L,error:S}=await C.from("subcategorias").select("*").eq("modalidade_id",u.modalidade_id).order("nome");f(!S&&L?L:[])})()},[u.modalidade_id]);const N=b=>{const{name:L,value:S}=b.target;O(E=>L==="organization_type"?{...E,[L]:S,modalidade_id:"",subcategoria_id:""}:L==="modalidade_id"?{...E,[L]:S,subcategoria_id:""}:{...E,[L]:S})},r=(b,L)=>{O(S=>({...S,city:b,state:L}))},j=b=>{var S;const L=(S=b.target.files)==null?void 0:S[0];if(L){$(L);const E=new FileReader;E.onloadend=()=>{_(E.result)},E.readAsDataURL(L)}},k=b=>{var S;const L=(S=b.target.files)==null?void 0:S[0];if(L){M(L);const E=new FileReader;E.onloadend=()=>{v(E.result)},E.readAsDataURL(L)}},U=async()=>{if(!y)return null;try{const b=y.name.split(".").pop(),S=`${`team-cover-${Date.now()}.${b}`}`,{error:E}=await C.storage.from("image").upload(S,y);if(E)throw console.error("Erro ao fazer upload da capa:",E),new Error("Não foi possível fazer upload da imagem de capa.");const{data:B}=C.storage.from("image").getPublicUrl(S);return B.publicUrl}catch(b){throw console.error("Erro no processo de upload:",b),b}},T=async()=>{if(!R)return null;try{const b=R.name.split(".").pop(),S=`${`team-logo-${Date.now()}.${b}`}`,{error:E}=await C.storage.from("image").upload(S,R);if(E)throw console.error("Erro ao fazer upload do logo:",E),new Error("Não foi possível fazer upload da imagem de logo.");const{data:B}=C.storage.from("image").getPublicUrl(S);return B.publicUrl}catch(b){throw console.error("Erro no processo de upload:",b),b}},A=async b=>{if(b.preventDefault(),!!c){a(!0),i(null),h(!1);try{let L=u.capa_url;if(y)try{const B=await U();B&&(L=B)}catch(B){console.error("Erro no upload da capa:",B)}let S=u.logo_url;if(R)try{const B=await T();B&&(S=B)}catch(B){console.error("Erro no upload do logo:",B)}const{error:E}=await C.from("sports_organizations").update({name:u.name,organization_type:u.organization_type,modalidade_id:u.modalidade_id||null,subcategoria_id:u.subcategoria_id||null,esporte_id:u.esporte_id||null,city:u.city,state:u.state,country:u.country,description:u.description,logo_url:S,capa_url:L}).eq("id",c.id);if(E)throw console.error("Erro ao atualizar equipe:",E),new Error(E.message);h(!0),setTimeout(()=>{o(),g()},1500)}catch(L){console.error("Erro ao atualizar equipe:",L),i(L.message||"Não foi possível atualizar a equipe. Por favor, tente novamente.")}finally{a(!1)}}};return!t||!c?null:e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center p-4 overflow-y-auto",style:{animation:"fadeIn 0.3s ease-out"},children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl my-8 max-h-[90vh] flex flex-col",style:{animation:"slideDown 0.3s ease-out"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white z-10 rounded-t-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Editar Equipe"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:p&&!z?e.jsx("div",{className:"flex justify-center my-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"})}):e.jsxs("form",{onSubmit:A,children:[m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:m}),z&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"Equipe atualizada com sucesso!"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"w-full h-40 rounded-lg overflow-hidden bg-gray-200 flex items-center justify-center",children:w?e.jsx("img",{src:w,alt:"Imagem de capa",className:"w-full h-full object-cover",onError:()=>_(null)}):e.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[e.jsx(Be,{size:40}),e.jsx("p",{className:"text-sm mt-2",children:"Imagem de capa"})]})}),e.jsx("label",{htmlFor:"cover-upload-edit",className:"absolute bottom-2 right-2 bg-green-600 text-white p-2 rounded-full cursor-pointer hover:bg-green-700 transition-colors",children:e.jsx(Me,{size:18})}),e.jsx("input",{type:"file",id:"cover-upload-edit",accept:"image/*",className:"hidden",onChange:j})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Nome da Equipe*"}),e.jsx("input",{type:"text",name:"name",value:u.name,onChange:N,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Esporte*"}),e.jsxs("select",{name:"esporte_id",value:u.esporte_id,onChange:b=>{const L=b.target.value,S=D.find(E=>E.id===L);O(E=>({...E,esporte_id:L,organization_type:S?S.nome:"",modalidade_id:"",subcategoria_id:""}))},required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione um esporte"}),D.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Modalidade*"}),e.jsxs("select",{name:"modalidade_id",value:u.modalidade_id||"",onChange:N,required:!0,disabled:!u.organization_type||x.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:u.organization_type?x.length===0?"Nenhuma modalidade encontrada":"Selecione uma modalidade":"Selecione o esporte primeiro"}),x.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Subcategoria"}),e.jsxs("select",{name:"subcategoria_id",value:u.subcategoria_id||"",onChange:N,disabled:!u.modalidade_id||l.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:u.modalidade_id?l.length===0?"Nenhuma subcategoria encontrada":"Selecione uma subcategoria":"Selecione a modalidade primeiro"}),l.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Cidade"}),e.jsx(Ke,{value:u.city?`${u.city}, ${u.state}`:"",onChange:r,placeholder:"Selecione uma cidade"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Estado"}),e.jsx("input",{type:"text",name:"state",value:u.state,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-gray-100",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"País"}),e.jsx("input",{type:"text",name:"country",value:u.country,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-gray-100",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Logo da Equipe"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center",children:F?e.jsx("img",{src:F,alt:"Logo",className:"w-full h-full object-cover",onError:()=>v(null)}):e.jsx(_e,{size:24,className:"text-gray-400"})}),e.jsx("label",{htmlFor:"logo-upload-edit",className:"absolute bottom-0 right-0 bg-green-600 text-white p-1 rounded-full cursor-pointer hover:bg-green-700 transition-colors",children:e.jsx(Me,{size:12})}),e.jsx("input",{type:"file",id:"logo-upload-edit",accept:"image/*",className:"hidden",onChange:k})]}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:R?"Logo será enviado ao salvar":"Clique no ícone para fazer upload do logo"})})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:u.description,onChange:N,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg mr-2 hover:bg-gray-50 transition-colors",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:p,className:`
                    bg-green-600 text-white px-6 py-2 rounded-lg
                    ${p?"opacity-50 cursor-not-allowed":"hover:bg-green-700"}
                    transition-colors
                  `,children:p?"Salvando...":"Salvar Alterações"})]})]})})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideDown {
          from { 
            opacity: 0;
            transform: translateY(-50px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
      `}})]})},Mt=({isOpen:t,onClose:g,onSuccess:c})=>{const{user:o}=ce(),[p,a]=s.useState(!1),[m,i]=s.useState(null),[z,h]=s.useState(!1),[u,O]=s.useState({name:"",organization_type:"",modalidade_id:"",subcategoria_id:"",city:"",state:"",country:"",description:"",logo_url:"",capa_url:""}),[y,$]=s.useState(null),[w,_]=s.useState(null),[R,M]=s.useState(null),[F,v]=s.useState(null),[D,P]=s.useState([]),[x,n]=s.useState([]),[l,f]=s.useState([]);s.useEffect(()=>{const b=async()=>{const{data:L,error:S}=await C.from("esportes").select("*").eq("ativo",!0).order("nome");!S&&L&&P(L)};t&&(O({name:"",organization_type:"",modalidade_id:"",subcategoria_id:"",city:"",state:"",country:"Brasil",description:"",logo_url:"",capa_url:""}),$(null),_(null),M(null),v(null),i(null),h(!1),n([]),f([]),b())},[t]),s.useEffect(()=>{(async()=>{if(!u.organization_type){n([]);return}const L=D.find(B=>B.nome===u.organization_type);if(!L){n([]);return}const{data:S,error:E}=await C.from("modalidades").select("*").eq("esporte_id",L.id).eq("ativo",!0).order("nome");n(!E&&S?S:[])})()},[u.organization_type,D]),s.useEffect(()=>{(async()=>{if(!u.modalidade_id){f([]);return}const{data:L,error:S}=await C.from("subcategorias").select("*").eq("modalidade_id",u.modalidade_id).order("nome");f(!S&&L?L:[])})()},[u.modalidade_id]);const N=b=>{const{name:L,value:S}=b.target;O(E=>L==="organization_type"?{...E,[L]:S,modalidade_id:"",subcategoria_id:""}:L==="modalidade_id"?{...E,[L]:S,subcategoria_id:""}:{...E,[L]:S})},r=(b,L)=>{O(S=>({...S,city:b,state:L}))},j=b=>{var S;const L=(S=b.target.files)==null?void 0:S[0];if(L){$(L);const E=new FileReader;E.onloadend=()=>{_(E.result)},E.readAsDataURL(L)}},k=b=>{var S;const L=(S=b.target.files)==null?void 0:S[0];if(L){M(L);const E=new FileReader;E.onloadend=()=>{v(E.result)},E.readAsDataURL(L)}},U=async()=>{if(!y||!o)return null;try{const b=y.name.split(".").pop(),S=`${`team-cover-${Date.now()}.${b}`}`,{error:E}=await C.storage.from("image").upload(S,y);if(E)throw console.error("Erro ao fazer upload da capa:",E),new Error("Não foi possível fazer upload da imagem de capa.");const{data:B}=C.storage.from("image").getPublicUrl(S);return B.publicUrl}catch(b){throw console.error("Erro no processo de upload:",b),b}},T=async()=>{if(!R||!o)return null;try{const b=R.name.split(".").pop(),S=`${`team-logo-${Date.now()}.${b}`}`,{error:E}=await C.storage.from("image").upload(S,R);if(E)throw console.error("Erro ao fazer upload do logo:",E),new Error("Não foi possível fazer upload da imagem de logo.");const{data:B}=C.storage.from("image").getPublicUrl(S);return B.publicUrl}catch(b){throw console.error("Erro no processo de upload:",b),b}},A=async b=>{b.preventDefault(),a(!0),i(null),h(!1);try{let L=u.capa_url;if(y)try{const q=await U();q&&(L=q)}catch(q){console.error("Erro no upload da capa:",q)}let S=u.logo_url;if(R)try{const q=await T();q&&(S=q)}catch(q){console.error("Erro no upload do logo:",q)}const E=D.find(q=>q.nome===u.organization_type),B=E?E.id:null,{error:Z}=await C.from("sports_organizations").insert({...u,esporte_id:B,capa_url:L,logo_url:S,created_by:o==null?void 0:o.id});if(Z)throw console.error("Erro ao criar organização:",Z),new Error(Z.message);h(!0),setTimeout(()=>{c(),g()},1500)}catch(L){console.error("Erro ao criar equipe:",L),i(L.message||"Não foi possível criar a equipe. Por favor, tente novamente.")}finally{a(!1)}};return t?e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-center p-4 overflow-y-auto",style:{animation:"fadeIn 0.3s ease-out"},children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl my-8 max-h-[90vh] flex flex-col",style:{animation:"slideDown 0.3s ease-out"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b sticky top-0 bg-white z-10 rounded-t-lg",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Adicionar Nova Equipe"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:p&&!z?e.jsx("div",{className:"flex justify-center my-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"})}):e.jsxs("form",{onSubmit:A,children:[m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:m}),z&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"Equipe criada com sucesso!"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"w-full h-40 rounded-lg overflow-hidden bg-gray-200 flex items-center justify-center",children:w?e.jsx("img",{src:w,alt:"Imagem de capa",className:"w-full h-full object-cover",onError:()=>_(null)}):e.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[e.jsx(Be,{size:40}),e.jsx("p",{className:"text-sm mt-2",children:"Imagem de capa"})]})}),e.jsx("label",{htmlFor:"cover-upload",className:"absolute bottom-2 right-2 bg-green-600 text-white p-2 rounded-full cursor-pointer hover:bg-green-700 transition-colors",children:e.jsx(Me,{size:18})}),e.jsx("input",{type:"file",id:"cover-upload",accept:"image/*",className:"hidden",onChange:j})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Nome da Equipe*"}),e.jsx("input",{type:"text",name:"name",value:u.name,onChange:N,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Esporte*"}),e.jsxs("select",{name:"organization_type",value:u.organization_type,onChange:N,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione um esporte"}),D.map(b=>e.jsx("option",{value:b.nome,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Modalidade*"}),e.jsxs("select",{name:"modalidade_id",value:u.modalidade_id||"",onChange:N,required:!0,disabled:!u.organization_type||x.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:u.organization_type?x.length===0?"Nenhuma modalidade encontrada":"Selecione uma modalidade":"Selecione o esporte primeiro"}),x.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Subcategoria"}),e.jsxs("select",{name:"subcategoria_id",value:u.subcategoria_id||"",onChange:N,disabled:!u.modalidade_id||l.length===0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:u.modalidade_id?l.length===0?"Nenhuma subcategoria encontrada":"Selecione uma subcategoria":"Selecione a modalidade primeiro"}),l.map(b=>e.jsx("option",{value:b.id,children:b.nome},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Cidade"}),e.jsx(Ke,{value:u.city?`${u.city}, ${u.state}`:"",onChange:r,placeholder:"Selecione uma cidade"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Estado"}),e.jsx("input",{type:"text",name:"state",value:u.state,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-gray-100",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"País"}),e.jsx("input",{type:"text",name:"country",value:u.country,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-gray-100",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Logo da Equipe"}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center",children:F?e.jsx("img",{src:F,alt:"Logo",className:"w-full h-full object-cover",onError:()=>v(null)}):e.jsx(_e,{size:24,className:"text-gray-400"})}),e.jsx("label",{htmlFor:"logo-upload",className:"absolute bottom-0 right-0 bg-green-600 text-white p-1 rounded-full cursor-pointer hover:bg-green-700 transition-colors",children:e.jsx(Me,{size:12})}),e.jsx("input",{type:"file",id:"logo-upload",accept:"image/*",className:"hidden",onChange:k})]}),e.jsx("div",{className:"ml-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:R?"Logo será enviado ao salvar":"Clique no ícone para fazer upload do logo"})})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:u.description,onChange:N,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg mr-2 hover:bg-gray-50 transition-colors",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:p,className:`
                    bg-green-600 text-white px-6 py-2 rounded-lg
                    ${p?"opacity-50 cursor-not-allowed":"hover:bg-green-700"}
                    transition-colors
                  `,children:p?"Criando...":"Criar Equipe"})]})]})})]}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slideDown {
          from { 
            opacity: 0;
            transform: translateY(-50px);
          }
          to { 
            opacity: 1;
            transform: translateY(0);
          }
        }
      `}})]}):null},Ut=()=>{const{user:t}=ce(),g=he(),[c,o]=s.useState([]),[p,a]=s.useState([]),[m,i]=s.useState(!0),[z,h]=s.useState(null),[u,O]=s.useState("teams"),[y,$]=s.useState({isOpen:!1,teamId:"",teamName:""}),[w,_]=s.useState({isOpen:!1,team:null}),[R,M]=s.useState(!1),[F,v]=s.useState(null);s.useEffect(()=>{(async()=>{if(t)try{const{data:k,error:U}=await C.from("users").select("role").eq("auth_user_id",t.id).single();if(U)throw U;k&&v(k.role)}catch(k){console.error("Erro ao buscar papel do usuário:",k)}})()},[t]),s.useEffect(()=>{t&&F&&(async()=>{if(t)try{i(!0);const{data:k,error:U}=await C.from("esportes").select("*");if(U)throw U;a(k||[]);let T;if(F==="atleta"){const{data:b,error:L}=await C.from("players").select("team_id").eq("user_id",t.id).eq("active",!0);if(L)throw L;if(b&&b.length>0){const S=b.map(Z=>Z.team_id),{data:E,error:B}=await C.from("sports_organizations").select("*").in("id",S).order("created_at",{ascending:!1});if(B)throw B;T=E}else T=[]}else{const{data:b,error:L}=await C.from("sports_organizations").select("*").eq("created_by",t.id).order("created_at",{ascending:!1});if(L)throw L;T=b}const A=(T||[]).map(b=>{const L=k==null?void 0:k.find(S=>S.id===b.esporte_id);return{...b,nome:L?L.nome:void 0}});o(A)}catch(k){console.error("Erro ao buscar organizações/esportes:",k),h("Não foi possível carregar as equipes. Por favor, tente novamente.")}finally{i(!1)}})()},[t,F]);const D=()=>{M(!0)},P=j=>{const k=c.find(U=>U.id===j);k&&_({isOpen:!0,team:k})},x=async j=>{const k=c.find(U=>U.id===j);k&&$({isOpen:!0,teamId:j,teamName:k.name})},n=j=>{g(`/equipe/${j}`)},l=async()=>{try{const{error:j}=await C.from("sports_organizations").delete().eq("id",y.teamId);if(j)throw j;o(k=>k.filter(U=>U.id!==y.teamId)),$({isOpen:!1,teamId:"",teamName:""})}catch(j){console.error("Erro ao excluir organização:",j),h("Não foi possível excluir a equipe. Por favor, tente novamente."),$({isOpen:!1,teamId:"",teamName:""})}},f=()=>{$({isOpen:!1,teamId:"",teamName:""})},N=()=>{t&&(i(!0),C.from("sports_organizations").select("*").eq("created_by",t.id).order("created_at",{ascending:!1}).then(({data:j,error:k})=>{if(k)console.error("Erro ao buscar organizações:",k),h("Não foi possível carregar as equipes. Por favor, tente novamente.");else{const U=(j||[]).map(T=>{const A=p.find(b=>b.id===T.esporte_id);return{...T,nome:A?A.nome:void 0}});o(U)}i(!1)}))},r=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(Se,{className:"mr-2"}),F==="atleta"?"Minhas Equipes":"Minha Equipe"]}),F!=="atleta"&&e.jsxs("button",{onClick:D,className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700 transition-colors",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Adicionar Equipe"})]})]}),z&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:z}),m?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((j,k)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"h-40 bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2 w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})]})]})]},k))}):c.length===0?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:F==="atleta"?e.jsx("p",{className:"text-gray-600 mb-4",children:"Você ainda não faz parte de nenhuma equipe."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Você ainda não tem nenhuma equipe cadastrada."}),e.jsx("button",{onClick:D,className:"text-green-600 hover:text-green-700 font-medium",children:"Clique aqui para adicionar sua primeira equipe"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(j=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>n(j.id),children:[e.jsxs("div",{className:"h-40 bg-gray-200 relative",children:[j.capa_url?e.jsx("img",{src:j.capa_url,alt:`Capa ${j.name}`,className:"w-full h-full object-cover"}):j.logo_url?e.jsx("img",{src:j.logo_url,alt:`Logo ${j.name}`,className:"w-full h-full object-contain p-4"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400",children:"Sem imagem"}),j.logo_url&&e.jsx("div",{className:"absolute -bottom-8 left-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-white bg-white shadow-md",children:e.jsx("img",{src:j.logo_url,alt:`Logo ${j.name}`,className:"w-full h-full object-cover",onError:k=>{k.target.style.display="none"}})})})]}),e.jsxs("div",{className:"p-4 pt-10",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:j.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:j.nome?j.nome:"Esporte não definido"}),e.jsx("p",{className:"text-sm text-gray-500",children:[j.city,j.state,j.country].filter(Boolean).join(", ")}),F!=="atleta"&&e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:k=>{k.stopPropagation(),P(j.id)},className:"p-2 text-gray-600 hover:text-green-600 transition-colors",title:"Editar",children:e.jsx(He,{size:18})}),e.jsx("button",{onClick:k=>{k.stopPropagation(),x(j.id)},className:"p-2 text-gray-600 hover:text-red-600 transition-colors",title:"Excluir",children:e.jsx(Ae,{size:18})})]})]})]},j.id))}),e.jsx(Ze,{isOpen:y.isOpen,title:"Confirmar exclusão",message:`Tem certeza que deseja excluir a equipe "${y.teamName}"? Esta ação não pode ser desfeita.`,confirmButtonText:"Excluir",cancelButtonText:"Cancelar",onConfirm:l,onCancel:f,confirmButtonColor:"red"}),e.jsx(Ft,{isOpen:w.isOpen,onClose:()=>_({isOpen:!1,team:null}),team:w.team,onSuccess:N}),e.jsx(Mt,{isOpen:R,onClose:()=>M(!1),onSuccess:N})]});return e.jsx(Ne,{activeTab:u,setActiveTab:O,children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:r})})},Rt=()=>{const t=he(),{user:g}=ce(),[c,o]=s.useState(!1),[p,a]=s.useState(null),[m,i]=s.useState({name:"",organization_type:"",city:"",state:"",country:"",description:"",logo_url:""}),[z,h]=s.useState("teams"),u=$=>{const{name:w,value:_}=$.target;i(R=>({...R,[w]:_}))},O=async $=>{$.preventDefault(),o(!0),a(null);try{const{data:w,error:_}=await C.from("sports_organizations").insert({...m,created_by:g==null?void 0:g.id}).select().single();if(_)throw console.error("Erro ao criar organização:",_),new Error(_.message);if(!w)throw new Error("Erro ao criar equipe: nenhum dado retornado");console.log("Equipe criada com sucesso:",w),t("/minhaequipe")}catch(w){console.error("Erro ao criar equipe:",w),a(w.message||"Não foi possível criar a equipe. Por favor, tente novamente.")}finally{o(!1)}},y=e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>t("/minhaequipe"),className:"flex items-center text-gray-600 hover:text-gray-800 mb-6",children:[e.jsx(is,{size:20,className:"mr-2"}),"Voltar"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-8",children:"Adicionar Nova Equipe"}),p&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:p}),e.jsxs("form",{onSubmit:O,className:"max-w-2xl bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Nome da Equipe*"}),e.jsx("input",{type:"text",name:"name",value:m.name,onChange:u,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Esporte*"}),e.jsxs("select",{name:"organization_type",value:m.organization_type,onChange:u,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione um tipo"}),e.jsx("option",{value:"Futebol",children:"Futebol"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Cidade"}),e.jsx("input",{type:"text",name:"city",value:m.city,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Estado"}),e.jsx("input",{type:"text",name:"state",value:m.state,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"País"}),e.jsx("input",{type:"text",name:"country",value:m.country,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"URL do Logo"}),e.jsx("input",{type:"url",name:"logo_url",value:m.logo_url,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:m.description,onChange:u,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsx("button",{type:"submit",disabled:c,className:`
              bg-green-600 text-white px-6 py-2 rounded-lg
              ${c?"opacity-50 cursor-not-allowed":"hover:bg-green-700"}
              transition-colors
            `,children:c?"Criando...":"Criar Equipe"})})]})]});return e.jsx(Ne,{activeTab:z,setActiveTab:h,children:y})},Vs=({teamId:t,teamName:g,isOpen:c,onClose:o,onGameAdded:p,leagueTournamentId:a})=>{const[m,i]=s.useState({opponent_name:"",game_date:"",game_time:"",location:"",city:"",state:"",home_game:!0,score_team:"",score_opponent:"",game_status:"scheduled",notes:""}),[z,h]=s.useState(!1),[u,O]=s.useState(null),[y,$]=s.useState(null),[w,_]=s.useState(null);if(!c)return null;const R=x=>{const{name:n,value:l,type:f}=x.target;if(f==="checkbox"){const N=x.target.checked;i(r=>({...r,[n]:N}))}else i(N=>({...N,[n]:l}))},M=(x,n)=>{i(l=>({...l,city:x,state:n,location:x?`${x}, ${n}`:""}))},F=x=>{if(x.target.files&&x.target.files[0]){const n=x.target.files[0];$(n);const l=new FileReader;l.onloadend=()=>{_(l.result)},l.readAsDataURL(n)}},v=()=>{$(null),_(null)},D=async()=>{if(!y)return null;try{h(!0);const x=y.name.split(".").pop(),f=`opponent-logos/${`opponent_${new Date().getTime()}.${x}`}`,{error:N}=await C.storage.from("game-images").upload(f,y);if(N)throw N;const{data:r}=C.storage.from("game-images").getPublicUrl(f);return r.publicUrl}catch(x){return console.error("Erro ao fazer upload do logo:",x),null}finally{h(!1)}},P=async x=>{x.preventDefault(),h(!0),O(null);try{let n=null;y&&(n=await D());const l=m.score_team?parseInt(m.score_team):null,f=m.score_opponent?parseInt(m.score_opponent):null,N={opponent_name:m.opponent_name,game_date:m.game_date,game_time:m.game_time,location:m.location,city:m.city,state:m.state,home_game:m.home_game,score_team:l,score_opponent:f,game_status:m.game_status,opponent_logo_url:n,notes:m.notes};t&&t.trim()!==""&&(N.team_id=t),a&&a.trim()!==""&&(N.league_tournament_id=a);const{error:r}=await C.from("games").insert(N);if(r)throw r;i({opponent_name:"",game_date:"",game_time:"",location:"",city:"",state:"",home_game:!0,score_team:"",score_opponent:"",game_status:"scheduled",notes:""}),p(),o()}catch(n){console.error("Erro ao adicionar jogo:",n),O("Não foi possível adicionar o jogo. Por favor, tente novamente.")}finally{h(!1)}};return c?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md flex flex-col h-[80vh] max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b rounded-t-xl",children:[e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Adicionar Novo Jogo para ",g]}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",type:"button",children:e.jsx(le,{size:20})})]}),u&&e.jsxs("div",{className:"mx-4 mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md flex items-start",children:[e.jsx(ke,{className:"mr-2 mt-0.5 flex-shrink-0",size:18}),e.jsx("span",{children:u})]})]}),e.jsx("div",{className:"overflow-y-auto flex-grow custom-scrollbar",children:e.jsx("form",{id:"addGameForm",onSubmit:P,className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adversário"}),e.jsx("input",{type:"text",name:"opponent_name",value:m.opponent_name,onChange:R,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome do adversário"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data"}),e.jsx("input",{type:"date",name:"game_date",value:m.game_date,onChange:R,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Horário"}),e.jsx("input",{type:"time",name:"game_time",value:m.game_time,onChange:R,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex-1",children:e.jsx(Ke,{value:m.city,onChange:M,placeholder:"Selecione a cidade do jogo"})})}),m.city&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[e.jsx(Ce,{size:14,className:"mr-1"}),m.city,", ",m.state]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"home_game",name:"home_game",checked:m.home_game,onChange:R,className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"home_game",className:"ml-2 block text-sm text-gray-700",children:"Jogo em casa"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placar (deixe em branco para jogos futuros)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:g}),e.jsx("input",{type:"number",min:"0",name:"score_team",value:m.score_team,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0"})]}),e.jsx("div",{className:"text-xl font-bold text-gray-400",children:"×"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:m.opponent_name||"Adversário"}),e.jsx("input",{type:"number",min:"0",name:"score_opponent",value:m.score_opponent,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status do Jogo"}),e.jsxs("select",{name:"game_status",value:m.game_status,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"scheduled",children:"Agendado"}),e.jsx("option",{value:"in_progress",children:"Em andamento"}),e.jsx("option",{value:"completed",children:"Concluído"}),e.jsx("option",{value:"canceled",children:"Cancelado"}),e.jsx("option",{value:"postponed",children:"Adiado"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo do Oponente"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[w?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w,alt:"Preview do logo",className:"h-20 w-20 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:v,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",title:"Remover logo",children:e.jsx(le,{size:14})})]}):e.jsx("div",{className:"flex items-center justify-center h-20 w-20 border-2 border-dashed border-gray-300 rounded-md",children:e.jsxs("label",{htmlFor:"logo-upload",className:"cursor-pointer text-center p-2",children:[e.jsx(Be,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("span",{className:"mt-1 block text-xs text-gray-500",children:"Logo"}),e.jsx("input",{id:"logo-upload",name:"logo",type:"file",className:"sr-only",accept:"image/*",onChange:F})]})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:w?e.jsx("p",{children:"Logo carregado com sucesso!"}):e.jsx("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-medium text-blue-600 hover:text-blue-500",children:e.jsx("span",{children:"Carregar logo"})})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF até 5MB"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{name:"notes",value:m.notes,onChange:R,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Observações adicionais sobre o jogo"})]})]})})}),e.jsx("div",{className:"sticky bottom-0 bg-white pt-3 pb-3 px-4 border-t border-gray-200 z-10 rounded-b-xl",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:z,children:"Cancelar"}),e.jsx("button",{type:"submit",form:"addGameForm",disabled:z,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 flex items-center",children:z?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"animate-spin mr-2",size:16}),"Salvando..."]}):"Salvar Jogo"})]})})]})}):null},Js=({game:t,teamName:g,isOpen:c,onClose:o,onGameUpdated:p})=>{const[a,m]=s.useState({id:"",opponent_name:"",game_date:"",game_time:"",location:"",city:"",state:"",home_game:!0,score_team:null,score_opponent:null,game_status:"scheduled",notes:"",opponent_logo_url:""}),[i,z]=s.useState(!1),[h,u]=s.useState(null),[O,y]=s.useState(null),[$,w]=s.useState(null),[_,R]=s.useState(null);if(s.useEffect(()=>{t&&(m({id:t.id,opponent_name:t.opponent_name,game_date:t.game_date,game_time:t.game_time,location:t.location||"",city:t.city||"",state:t.state||"",home_game:t.home_game,score_team:t.score_team,score_opponent:t.score_opponent,game_status:t.game_status||"scheduled",notes:t.notes||"",opponent_logo_url:t.opponent_logo_url||""}),t.opponent_logo_url&&R(t.opponent_logo_url))},[t]),!c)return null;const M=n=>{const{name:l,value:f,type:N}=n.target;if(N==="checkbox"){const r=n.target.checked;m(j=>({...j,[l]:r}))}else m(r=>({...r,[l]:f}))},F=(n,l)=>{m(f=>({...f,city:n,state:l,location:n?`${n}, ${l}`:""}))},v=n=>{if(n.target.files&&n.target.files[0]){const l=n.target.files[0];y(l);const f=new FileReader;f.onloadend=()=>{w(f.result)},f.readAsDataURL(l)}},D=()=>{y(null),w(null),R(null)},P=async()=>{if(!O)return _;try{z(!0);const n=O.name.split(".").pop(),N=`opponent-logos/${`opponent_${new Date().getTime()}.${n}`}`,{error:r}=await C.storage.from("game-images").upload(N,O);if(r)throw r;const{data:j}=C.storage.from("game-images").getPublicUrl(N);return j.publicUrl}catch(n){return console.error("Erro ao fazer upload do logo:",n),_}finally{z(!1)}},x=async n=>{n.preventDefault(),z(!0),u(null);try{let l=_;O&&(l=await P());const{error:f}=await C.from("games").update({opponent_name:a.opponent_name,game_date:a.game_date,game_time:a.game_time,location:a.location,city:a.city,state:a.state,home_game:a.home_game,score_team:a.score_team,score_opponent:a.score_opponent,game_status:a.game_status,opponent_logo_url:l,notes:a.notes}).eq("id",a.id);if(f)throw f;p(),o()}catch(l){console.error("Erro ao atualizar jogo:",l),u("Não foi possível atualizar o jogo. Por favor, tente novamente.")}finally{z(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md flex flex-col h-[80vh] max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b rounded-t-xl",children:[e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Editar Jogo - ",g]}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",type:"button",children:e.jsx(le,{size:20})})]}),h&&e.jsxs("div",{className:"mx-4 mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md flex items-start",children:[e.jsx(ke,{className:"mr-2 mt-0.5 flex-shrink-0",size:18}),e.jsx("span",{children:h})]})]}),e.jsx("div",{className:"overflow-y-auto flex-grow custom-scrollbar",children:e.jsx("form",{id:"editGameForm",onSubmit:x,className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adversário"}),e.jsx("input",{type:"text",name:"opponent_name",value:a.opponent_name,onChange:M,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome do adversário"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data"}),e.jsx("input",{type:"date",name:"game_date",value:a.game_date,onChange:M,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Horário"}),e.jsx("input",{type:"time",name:"game_time",value:a.game_time,onChange:M,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local"}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex-1",children:e.jsx(Ke,{value:a.city||"",onChange:F,placeholder:"Selecione a cidade do jogo"})})}),a.city&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center",children:[e.jsx(Ce,{size:14,className:"mr-1"}),a.city,", ",a.state]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"home_game",name:"home_game",checked:a.home_game,onChange:M,className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"home_game",className:"ml-2 block text-sm text-gray-700",children:"Jogo em casa"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placar"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:g}),e.jsx("input",{type:"number",min:"0",name:"score_team",value:a.score_team===null||a.score_team===void 0?"":a.score_team,onChange:n=>m({...a,score_team:n.target.value===""?null:parseInt(n.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0"})]}),e.jsx("div",{className:"text-xl font-bold text-gray-400",children:"×"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:a.opponent_name||"Adversário"}),e.jsx("input",{type:"number",min:"0",name:"score_opponent",value:a.score_opponent===null||a.score_opponent===void 0?"":a.score_opponent,onChange:n=>m({...a,score_opponent:n.target.value===""?null:parseInt(n.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"0"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status do Jogo"}),e.jsxs("select",{name:"game_status",value:a.game_status||"scheduled",onChange:M,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"scheduled",children:"Agendado"}),e.jsx("option",{value:"in_progress",children:"Em andamento"}),e.jsx("option",{value:"completed",children:"Concluído"}),e.jsx("option",{value:"canceled",children:"Cancelado"}),e.jsx("option",{value:"postponed",children:"Adiado"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo do Oponente"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[$||_?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:$||_||"",alt:"Preview do logo",className:"h-20 w-20 object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:D,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",title:"Remover logo",children:e.jsx(le,{size:14})})]}):e.jsx("div",{className:"flex items-center justify-center h-20 w-20 border-2 border-dashed border-gray-300 rounded-md",children:e.jsxs("label",{htmlFor:"logo-upload",className:"cursor-pointer text-center p-2",children:[e.jsx(Be,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("span",{className:"mt-1 block text-xs text-gray-500",children:"Logo"}),e.jsx("input",{id:"logo-upload",name:"logo",type:"file",className:"sr-only",accept:"image/*",onChange:v})]})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:!$&&!_?e.jsx("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-medium text-blue-600 hover:text-blue-500",children:e.jsx("span",{children:"Carregar logo"})}):e.jsx("p",{children:"Logo carregado com sucesso!"})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, GIF até 5MB"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{name:"notes",value:a.notes,onChange:M,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Observações adicionais sobre o jogo"})]})]})})}),e.jsx("div",{className:"sticky bottom-0 bg-white pt-3 pb-3 px-4 border-t border-gray-200 z-10 rounded-b-xl",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:i,children:"Cancelar"}),e.jsx("button",{type:"submit",form:"editGameForm",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 flex items-center",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"animate-spin mr-2",size:16}),"Salvando..."]}):"Salvar Alterações"})]})})]})})},Hs=({games:t,teamName:g,teamLogo:c,onEditGame:o,onDeleteGame:p,userRole:a})=>{const[m,i]=s.useState(new Date),[z,h]=s.useState([]),[u,O]=s.useState(null),[y,$]=s.useState([]),[w,_]=s.useState(null),R=r=>{_(w===r?null:r)},M=r=>{o&&o(r),_(null)},F=r=>{p&&p(r),_(null)};s.useEffect(()=>{const r=m.getFullYear(),j=m.getMonth(),k=new Date(r,j,1),U=new Date(r,j+1,0),A=k.getDay(),b=A+U.getDate(),S=Math.ceil(b/7)*7,E=[],B=new Date(r,j,0).getDate();for(let q=A-1;q>=0;q--)E.push(new Date(r,j-1,B-q));for(let q=1;q<=U.getDate();q++)E.push(new Date(r,j,q));const Z=S-E.length;for(let q=1;q<=Z;q++)E.push(new Date(r,j+1,q));h(E)},[m]);const v=r=>{const j=r.toISOString().split("T")[0];return t.some(k=>k.game_date===j)},D=r=>{const j=r.toISOString().split("T")[0];return t.filter(k=>k.game_date===j)},P=r=>{O(r),$(D(r))},x=()=>{i(new Date(m.getFullYear(),m.getMonth()-1,1))},n=()=>{i(new Date(m.getFullYear(),m.getMonth()+1,1))},l=r=>r.toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),f=m.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),N=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];return e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(je,{size:18,className:"mr-2"}),"Calendário de Jogos"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:x,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(ls,{size:20})}),e.jsx("span",{className:"mx-2 font-medium text-gray-700 capitalize",children:f}),e.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(ns,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[N.map((r,j)=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:r},j)),z.map((r,j)=>{const k=r.getMonth()===m.getMonth(),U=new Date().toDateString()===r.toDateString(),T=u&&u.toDateString()===r.toDateString(),A=v(r);return e.jsxs("button",{onClick:()=>P(r),className:`
                  h-10 w-full rounded-md flex items-center justify-center relative
                  ${k?"text-gray-700":"text-gray-400"}
                  ${U?"bg-green-100":""}
                  ${T?"bg-green-500 text-white":"hover:bg-gray-100"}
                `,children:[r.getDate(),A&&e.jsx("span",{className:`absolute bottom-1 w-1.5 h-1.5 rounded-full ${T?"bg-white":"bg-green-500"}`})]},j)})]}),u&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-2 capitalize",children:l(u)}),y.length>0?e.jsx("div",{className:"space-y-2",children:y.map(r=>e.jsxs("div",{className:`p-3 rounded-md ${r.game_status==="canceled"?"bg-red-50 border-l-2 border-red-500":r.game_status==="postponed"?"bg-yellow-50 border-l-2 border-yellow-500":r.game_status==="completed"?"bg-green-50 border-l-2 border-green-500":"bg-gray-50"}`,children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-sm font-medium",children:r.game_time}),r.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${r.game_status==="scheduled"?"bg-blue-100 text-blue-800":r.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":r.game_status==="completed"?"bg-green-100 text-green-800":r.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:r.game_status==="scheduled"?"Agendado":r.game_status==="in_progress"?"Em andamento":r.game_status==="completed"?"Concluído":r.game_status==="canceled"?"Cancelado":r.game_status==="postponed"?"Adiado":"Desconhecido"})]}),a!=="atleta"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>R(r.id),className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(rs,{size:16})}),w===r.id&&e.jsx("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg z-10 border",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>M(r),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Editar"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>F(r.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),"Excluir"]})})]})})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("span",{className:"inline-block mr-1",children:"📍"}),r.location,r.city&&r.state&&` - ${r.city}, ${r.state}`]}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:r.home_game?c?e.jsx("img",{src:c,alt:"Logo",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:g.charAt(0)})}):r.opponent_logo_url?e.jsx("img",{src:r.opponent_logo_url,alt:"Logo Oponente",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:r.opponent_name.charAt(0)})})}),e.jsx("span",{className:"font-medium",children:r.home_game?g:r.opponent_name})]}),e.jsx("div",{className:"text-xl font-bold",children:r.score_team!==null&&r.score_team!==void 0?r.home_game?r.score_team:r.score_opponent:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:r.home_game?r.opponent_logo_url?e.jsx("img",{src:r.opponent_logo_url,alt:"Logo Oponente",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:r.opponent_name.charAt(0)})}):c?e.jsx("img",{src:c,alt:"Logo",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:g.charAt(0)})})}),e.jsx("span",{className:"font-medium",children:r.home_game?r.opponent_name:g})]}),e.jsx("div",{className:"text-xl font-bold",children:r.score_opponent!==null&&r.score_opponent!==void 0?r.home_game?r.score_opponent:r.score_team:"-"})]})]})}),r.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 border-t pt-1",children:r.notes})]},r.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"Nenhum jogo agendado para esta data."})]})]})})},ms=({isOpen:t,title:g,message:c,confirmText:o="Confirmar",cancelText:p="Cancelar",onConfirm:a,onCancel:m,isLoading:i=!1})=>t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($s,{className:"text-yellow-500 mr-2",size:20}),e.jsx("h2",{className:"text-lg font-semibold",children:g})]}),e.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700",type:"button",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"p-4",children:e.jsx("p",{className:"text-gray-700",children:c})}),e.jsxs("div",{className:"flex justify-end p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md mr-2 hover:bg-gray-200",disabled:i,children:p}),e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",disabled:i,children:i?"Processando...":o})]})]})}):null,Ss=({isOpen:t,onClose:g,onPlayerAdded:c,teamId:o})=>{const[p,a]=s.useState(""),[m,i]=s.useState(""),[z,h]=s.useState(""),[u,O]=s.useState(""),[y,$]=s.useState(""),[w,_]=s.useState(!1),[R,M]=s.useState(null),[F,v]=s.useState(1),D=()=>{a(""),i(""),h(""),O(""),$(""),M(null),v(1)},P=()=>{D(),g()},x=()=>{if(!p.trim()){M("Nome do jogador é obrigatório");return}if(!m.trim()){M("Posição do jogador é obrigatória");return}if(!z.trim()||isNaN(Number(z))){M("Número da camisa deve ser um valor numérico");return}M(null),v(2)},n=()=>{v(1),M(null)},l=async()=>{var f,N;try{if(_(!0),M(null),!u.trim()||!u.includes("@")){M("Email inválido");return}if(!y.trim()||y.length<6){M("Senha deve ter pelo menos 6 caracteres");return}const{data:r}=await C.auth.getSession(),j=(f=r==null?void 0:r.session)==null?void 0:f.access_token;if(!j)throw new Error("Sessão de administrador não encontrada");const{data:k,error:U}=await C.auth.signUp({email:u,password:y,options:{data:{name:p,role:"atleta",onboarding_completed:!0},emailRedirectTo:""}});if(U)throw U;if(!k.user)throw new Error("Erro ao criar usuário");await C.auth.setSession({access_token:j,refresh_token:((N=r==null?void 0:r.session)==null?void 0:N.refresh_token)||""});const{error:T}=await C.from("users").insert({name:p,email:u,auth_user_id:k.user.id,onboarding:!0,role:"atleta",team_id:o});if(T)throw T;const{error:A}=await C.from("players").insert({name:p,position:m,number:Number(z),user_id:k.user.id,team_id:o,profile_type:"athlete",active:!0});if(A)throw A;c(),P()}catch(r){console.error("Erro ao adicionar jogador:",r),M(r.message||"Erro ao adicionar jogador. Tente novamente.")}finally{_(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:F===1?"Adicionar Jogador":"Criar Conta de Usuário"}),e.jsx("button",{onClick:P,className:"text-gray-500 hover:text-gray-700",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"p-4",children:[R&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:R}),F===1?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Jogador*"}),e.jsx("input",{type:"text",value:p,onChange:f=>a(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome completo",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posição*"}),e.jsxs("select",{value:m,onChange:f=>i(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[e.jsx("option",{value:"",children:"Selecione uma posição"}),e.jsx("option",{value:"Goleiro",children:"Goleiro"}),e.jsx("option",{value:"Zagueiro",children:"Zagueiro"}),e.jsx("option",{value:"Lateral",children:"Lateral"}),e.jsx("option",{value:"Meio-campo",children:"Meio-campo"}),e.jsx("option",{value:"Atacante",children:"Atacante"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número da Camisa*"}),e.jsx("input",{type:"number",value:z,onChange:f=>h(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Número",min:"1",max:"99",required:!0})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email*"}),e.jsx("input",{type:"email",value:u,onChange:f=>O(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"email@exemplo.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha*"}),e.jsx("input",{type:"password",value:y,onChange:f=>$(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Mínimo de 6 caracteres",minLength:6,required:!0})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Estas credenciais serão usadas pelo jogador para acessar o sistema."})]})]}),e.jsx("div",{className:"flex justify-between p-4 border-t bg-gray-50 rounded-b-lg",children:F===1?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-700 hover:text-gray-900",disabled:w,children:"Cancelar"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",disabled:w,children:"Próximo"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-gray-700 hover:text-gray-900",disabled:w,children:"Voltar"}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",disabled:w,children:w?"Adicionando...":"Adicionar Jogador"})]})})]})}):null},Es=({isOpen:t,onClose:g,onPlayerUpdated:c,player:o})=>{const[p,a]=s.useState({name:"",position:"",number:""}),[m,i]=s.useState(!1),[z,h]=s.useState(null);s.useEffect(()=>{(async()=>{if(o&&o.user_id)try{const{data:_,error:R}=await C.from("users").select("name, email").eq("auth_user_id",o.user_id).single();if(R){console.error("Erro ao buscar dados do usuário:",R),a({name:o.name,position:o.position,number:o.number.toString()});return}_&&(a({name:_.name||o.name,position:o.position,number:o.number.toString()}),O(_.email||""))}catch(_){console.error("Erro ao buscar dados do usuário:",_),a({name:o.name,position:o.position,number:o.number.toString()})}})()},[o]);const[u,O]=s.useState("");if(!t)return null;const y=w=>{const{name:_,value:R}=w.target;a(M=>({...M,[_]:R}))},$=async w=>{w.preventDefault();try{if(i(!0),h(null),!p.name||!p.position||!p.number){h("Todos os campos são obrigatórios");return}if(p.name!==o.name){const{error:R}=await C.from("users").update({name:p.name}).eq("auth_user_id",o.user_id);R&&console.error("Erro ao atualizar nome do usuário:",R)}const{error:_}=await C.from("players").update({name:p.name,position:p.position,number:parseInt(p.number)}).eq("id",o.id);if(_)throw _;c(),g()}catch(_){console.error("Erro ao atualizar jogador:",_),h(_.message||"Erro ao atualizar jogador. Tente novamente.")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Editar Jogador"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700",children:e.jsx(le,{size:20})})]}),e.jsxs("form",{onSubmit:$,className:"p-4",children:[z&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:z}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),e.jsx("input",{type:"text",id:"name",name:"name",value:p.name,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:u,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O email não pode ser alterado."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Posição"}),e.jsxs("select",{name:"position",value:p.position,onChange:y,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Selecione uma posição"}),e.jsx("option",{value:"Goleiro",children:"Goleiro"}),e.jsx("option",{value:"Zagueiro",children:"Zagueiro"}),e.jsx("option",{value:"Lateral",children:"Lateral"}),e.jsx("option",{value:"Volante",children:"Volante"}),e.jsx("option",{value:"Meio-campo",children:"Meio-campo"}),e.jsx("option",{value:"Atacante",children:"Atacante"}),e.jsx("option",{value:"Ponta",children:"Ponta"}),e.jsx("option",{value:"Centroavante",children:"Centroavante"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Número"}),e.jsx("input",{type:"number",name:"number",value:p.number,onChange:y,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Número da camisa",min:"1",max:"99"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",disabled:m,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center",disabled:m,children:m?"Salvando...":"Salvar Alterações"})]})]})]})})},ks=({isOpen:t,onClose:g,onPlayerDeactivated:c,player:o})=>{const[p,a]=s.useState(!1),[m,i]=s.useState(null);if(!t)return null;const z=async()=>{try{a(!0),i(null);const{error:h}=await C.from("players").update({active:!o.active}).eq("id",o.id);if(h)throw h;c(),g()}catch(h){console.error("Erro ao alterar status do jogador:",h),i(h.message||"Erro ao alterar status do jogador. Tente novamente.")}finally{a(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[o.active?"Desativar":"Ativar"," Jogador"]}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700",children:e.jsx(le,{size:20})})]}),e.jsxs("div",{className:"p-4",children:[m&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:m}),e.jsxs("p",{className:"text-gray-700 mb-4",children:[e.jsxs("p",{className:"mb-4",children:["Tem certeza que deseja ",o.active?"desativar":"ativar"," o jogador ",e.jsx("strong",{children:o.name}),"?"]}),e.jsx("p",{className:"mb-4 text-gray-600",children:o.active?"Esta ação irá remover o jogador da lista de jogadores ativos.":"Esta ação irá adicionar o jogador de volta à lista de jogadores ativos."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",disabled:p,children:"Cancelar"}),e.jsxs("button",{type:"button",onClick:z,className:`px-4 py-2 text-white rounded-md flex items-center justify-center disabled:opacity-50 ${o.active?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,disabled:p,children:[p?o.active?"Desativando...":"Ativando...":o.active?"Desativar":"Ativar",o.active?e.jsx(qs,{size:16,className:"ml-2"}):e.jsx(dt,{size:16,className:"ml-2"})," Jogador"]})]})]})]})})},Gt=()=>{const{id:t}=ps(),g=he(),{user:c}=ce(),[o,p]=s.useState("teams"),[a,m]=s.useState("players"),[i,z]=s.useState(null),[h,u]=s.useState([]),[O,y]=s.useState([]),[$,w]=s.useState(!1),[_,R]=s.useState(""),[M,F]=s.useState([]),[v,D]=s.useState(!0),[P,x]=s.useState(null),[n,l]=s.useState(!1),[f,N]=s.useState(!1),[r,j]=s.useState(null),[k,U]=s.useState(!1),[T,A]=s.useState(!1),[b,L]=s.useState(""),[S,E]=s.useState(!1),[B,Z]=s.useState(null),[q,ee]=s.useState(!1),[J,W]=s.useState(!1),[d,Y]=s.useState(!1),[Q,re]=s.useState(null),[oe,de]=s.useState(null),K=s.useRef(null),[te,H]=s.useState(null);s.useEffect(()=>{(async()=>{if(c)try{const{data:G,error:pe}=await C.from("users").select("role").eq("auth_user_id",c.id).single();if(pe)throw pe;G&&H(G.role)}catch(G){console.error("Erro ao buscar papel do usuário:",G)}})()},[c]);const se=async ne=>{try{if(!ne)return;const{data:G,error:pe}=await C.from("games").select("*").eq("team_id",ne).order("game_date",{ascending:!0});if(pe)throw pe;if(G){const we=await Promise.all(G.map(async ye=>{if(ye.league_tournament_id){const{data:fe}=await C.from("leagues").select("id, name, logo_url").eq("id",ye.league_tournament_id);if(fe&&fe.length>0)return{...ye,league_tournament:{...fe[0],type:"league"}};const{data:Oe}=await C.from("tournaments").select("id, name, logo_url").eq("id",ye.league_tournament_id);if(Oe&&Oe.length>0)return{...ye,league_tournament:{...Oe[0],type:"tournament"}}}return ye}));F(we)}}catch(G){console.error("Erro ao buscar jogos:",G)}},V=()=>{t&&se(t)},I=()=>{t&&se(t)},X=ne=>{j(ne),N(!0),Z(null)},ae=ne=>{L(ne),A(!0),Z(null)},me=async()=>{if(b){E(!0);try{const{error:ne}=await C.from("games").delete().eq("id",b);if(ne)throw ne;t&&se(t)}catch(ne){console.error("Erro ao excluir jogo:",ne),alert("Não foi possível excluir o jogo. Por favor, tente novamente.")}finally{E(!1),A(!1),L("")}}},ue=ne=>{Z(B===ne?null:ne)},xe=async ne=>{if(ne){w(!0);try{const{data:G,error:pe}=await C.from("players").select("*").eq("team_id",ne).order("name");if(pe)throw pe;let we=G||[];if(G&&G.length>0){const ye=G.map($e=>$e.user_id).filter(Boolean),{data:fe,error:Oe}=await C.from("users").select("auth_user_id, name, email").in("auth_user_id",ye);Oe&&console.error("Erro ao buscar usuários:",Oe);const ws={};fe&&fe.forEach($e=>{ws[$e.auth_user_id]=$e}),we=G.map($e=>{const De=$e.user_id?ws[$e.user_id]:null;return{...$e,name:(De==null?void 0:De.name)||$e.name,email:(De==null?void 0:De.email)||"",users:De?{id:De.auth_user_id,name:De.name,email:De.email}:void 0}})}u(we),y(we)}catch(G){console.error("Erro ao buscar jogadores:",G),x("Não foi possível carregar os jogadores.")}finally{w(!1)}}},ze=()=>{if(!_.trim()){y(h);return}const ne=h.filter(G=>G.name.toLowerCase().includes(_.toLowerCase())||G.position.toLowerCase().includes(_.toLowerCase())||String(G.number).includes(_));y(ne)};s.useEffect(()=>{ze()},[_,h]);const es=()=>{ee(!0)},Ve=async()=>{ee(!1),t&&await xe(t)},ss=ne=>{re(ne),W(!0),de(null)},Je=async()=>{W(!1),re(null),t&&await xe(t)},ts=ne=>{re(ne),Y(!0),de(null)},Ns=async()=>{Y(!1),re(null),t&&await xe(t)},et=ne=>{de(oe===ne?null:ne)};s.useEffect(()=>{(async()=>{if(t)try{D(!0);const{data:G,error:pe}=await C.from("sports_organizations").select("*").eq("id",t).single();if(pe)throw pe;z(G),se(t),xe(t)}catch(G){console.error("Erro ao buscar organização:",G),x("Não foi possível carregar os dados da equipe.")}finally{D(!1)}})()},[t]);const st=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 w-48 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs("div",{className:"p-6 pt-12 space-y-3",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-2/3"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded w-full mt-4"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"}),e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"}),e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((ne,G)=>e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 h-24"},G))})]})]})]}),tt=()=>{switch(a){case"players":return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Jogadores"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",placeholder:"Buscar jogador...",className:"px-3 py-1 text-sm border rounded-md w-64",value:_,onChange:G=>R(G.target.value)})}),te!=="atleta"&&e.jsxs("button",{onClick:es,className:"px-3 py-1 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Jogador"]})]})]}),q&&e.jsx(Ss,{teamId:t||"",isOpen:q,onClose:()=>ee(!1),onPlayerAdded:Ve}),J&&Q&&e.jsx(Es,{player:Q,isOpen:J,onClose:()=>W(!1),onPlayerUpdated:Je}),d&&Q&&e.jsx(ks,{player:Q,isOpen:d,onClose:()=>Y(!1),onPlayerDeactivated:Ns}),$?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(G=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-full mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]})]},G))}):O.length===0?e.jsx("p",{className:"text-gray-500",children:_?"Nenhum jogador encontrado com este termo de busca.":"Nenhum jogador cadastrado."}):e.jsx("div",{className:"space-y-4",children:O.map(G=>e.jsxs("div",{className:`bg-white rounded-lg shadow p-4 flex items-center justify-between ${G.active?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mr-4",children:G.photo_url?e.jsx("img",{src:G.photo_url,alt:G.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 text-xl",children:G.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center",children:[G.name,!G.active&&e.jsx("span",{className:"ml-2 text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full",children:"Inativo"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[G.position," • #",G.number]}),G.users&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:G.users.email})]})]}),te!=="atleta"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>et(G.id),className:"p-1 rounded-full hover:bg-gray-100",ref:K,children:e.jsx(rs,{size:18})}),oe===G.id&&e.jsx("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg z-10 border",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>ss(G),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Editar"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>ts(G),className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center ${G.active?"text-red-600":"text-green-600"}`,children:[e.jsx(qs,{size:14,className:"mr-2"}),G.active?"Desativar":"Ativar"]})})]})})]})]},G.id))})]});case"games":return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Próximos Jogos"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>U(!k),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md flex items-center",children:[e.jsx(je,{size:16,className:"mr-1"}),k?"Modo Lista":"Calendário"]}),te!=="atleta"&&e.jsxs("button",{onClick:()=>l(!0),className:"px-3 py-1 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Jogo"]})]})]}),n&&e.jsx(Vs,{teamId:t||"",teamName:(i==null?void 0:i.name)||"",isOpen:n,onClose:()=>l(!1),onGameAdded:V}),f&&r&&e.jsx(Js,{game:r,teamName:(i==null?void 0:i.name)||"",isOpen:f,onClose:()=>N(!1),onGameUpdated:I}),e.jsx(ms,{isOpen:T,title:"Confirmar Exclusão",message:"Tem certeza que deseja excluir este jogo? Esta ação não pode ser desfeita.",confirmText:"Excluir",cancelText:"Cancelar",onConfirm:me,onCancel:()=>{A(!1),L("")},isLoading:S}),k?e.jsx(Hs,{games:M,teamName:(i==null?void 0:i.name)||"",teamLogo:i==null?void 0:i.logo_url,onEditGame:X,onDeleteGame:ae,userRole:te}):e.jsx("div",{children:M.filter(G=>G.game_status!=="completed").length===0?e.jsx("p",{className:"text-gray-500",children:"Nenhum jogo agendado."}):e.jsx("div",{className:"space-y-4",children:M.filter(G=>G.game_status!=="completed").map(G=>{var pe,we,ye,fe;return e.jsxs("div",{className:`bg-white rounded-lg shadow p-4 relative ${G.game_status==="canceled"?"border-l-4 border-red-500":G.game_status==="postponed"?"border-l-4 border-yellow-500":G.game_status==="completed"?"border-l-4 border-green-500":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[G.game_date.split("T")[0].split("-").reverse().join("/")," • ",G.game_time]}),G.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${G.game_status==="scheduled"?"bg-blue-100 text-blue-800":G.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":G.game_status==="completed"?"bg-green-100 text-green-800":G.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:G.game_status==="scheduled"?"Agendado":G.game_status==="in_progress"?"Em andamento":G.game_status==="completed"?"Concluído":G.game_status==="canceled"?"Cancelado":G.game_status==="postponed"?"Adiado":"Desconhecido"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("span",{className:"inline-block mr-1",children:"📍"}),G.location,G.city&&G.state&&` - ${G.city}, ${G.state}`]}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:G.home_game?i!=null&&i.logo_url?e.jsx("img",{src:i.logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((pe=i==null?void 0:i.name)==null?void 0:pe.charAt(0))||"?"})}):G.opponent_logo_url?e.jsx("img",{src:G.opponent_logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((we=G.opponent_name)==null?void 0:we.charAt(0))||"?"})})}),e.jsx("div",{className:"font-medium",children:G.home_game?i==null?void 0:i.name:G.opponent_name})]}),e.jsx("div",{className:"text-2xl font-bold",children:G.score_team!==null&&G.score_team!==void 0?G.home_game?G.score_team:G.score_opponent:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:G.home_game?G.opponent_logo_url?e.jsx("img",{src:G.opponent_logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((fe=G.opponent_name)==null?void 0:fe.charAt(0))||"?"})}):i!=null&&i.logo_url?e.jsx("img",{src:i.logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((ye=i==null?void 0:i.name)==null?void 0:ye.charAt(0))||"?"})})}),e.jsx("div",{className:"font-medium",children:G.home_game?G.opponent_name:i==null?void 0:i.name})]}),e.jsx("div",{className:"text-2xl font-bold",children:G.score_opponent!==null&&G.score_opponent!==void 0?G.home_game?G.score_opponent:G.score_team:"-"})]}),G.league_tournament&&e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-100",children:e.jsxs(fs,{to:`/ligastorneios/${G.league_tournament.id}`,className:"flex items-center hover:bg-gray-50 p-1 rounded transition-colors group",onClick:Oe=>Oe.stopPropagation(),children:[e.jsx("div",{className:"w-5 h-5 mr-2 flex-shrink-0",children:G.league_tournament.logo_url?e.jsx("img",{src:G.league_tournament.logo_url,alt:"Logo",className:"w-full h-full rounded-full object-cover"}):e.jsx(be,{size:16,className:"text-gray-500"})}),e.jsxs("span",{className:"text-xs text-gray-500 flex-grow",children:[G.league_tournament.type==="league"?"Liga":"Torneio",": ",G.league_tournament.name]}),e.jsx(Os,{size:12,className:"text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})})]}),e.jsx("div",{className:"flex items-center",children:te!=="atleta"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>ue(G.id),className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(rs,{size:18})}),B===G.id&&e.jsx("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg z-10 border",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>X(G),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Editar"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>ae(G.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),"Excluir"]})})]})})]})})]}),G.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 pt-2 border-t",children:G.notes})]},G.id)})})})]});case"results":const ne=M.filter(G=>G.game_status==="completed"&&G.score_team!==null&&G.score_opponent!==null);return e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resultados"}),ne.length===0?e.jsx("p",{className:"text-gray-500",children:"Nenhum jogo concluído registrado."}):e.jsx("div",{className:"space-y-4",children:ne.map(G=>{const pe=G.home_game,we=pe?G.score_team||0:G.score_opponent||0,ye=pe?G.score_opponent||0:G.score_team||0;let fe="draw";return we>ye?fe="win":we<ye&&(fe="loss"),e.jsx("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${fe==="win"?"border-green-500":fe==="loss"?"border-red-500":"border-yellow-500"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:pe?e.jsxs(e.Fragment,{children:[i==null?void 0:i.name," vs ",G.opponent_name]}):e.jsxs(e.Fragment,{children:[G.opponent_name," vs ",i==null?void 0:i.name]})}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[G.game_date.split("T")[0].split("-").reverse().join("/")," • ",G.game_time]}),G.location&&e.jsxs("p",{className:"text-sm text-gray-500",children:[e.jsx(Ce,{size:14,className:"inline mr-1"}),G.location]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-lg",children:[we," - ",ye]}),e.jsx("p",{className:`text-sm ${fe==="win"?"text-green-600":fe==="loss"?"text-red-600":"text-yellow-600"}`,children:fe==="win"?"Vitória":fe==="loss"?"Derrota":"Empate"})]})]})},G.id)})})]});default:return null}},at=e.jsx(e.Fragment,{children:v?e.jsx(st,{}):P?e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:e.jsx("p",{children:P})}):i?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>g("/minhaequipe"),className:"flex items-center text-gray-600 hover:text-green-600 mb-4 transition-colors",children:[e.jsx(is,{size:18,className:"mr-1"}),e.jsx("span",{children:"Voltar para Minhas Equipes"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsxs("div",{className:"h-48 bg-gray-200 relative",children:[i.capa_url?e.jsx("img",{src:i.capa_url,alt:`Capa ${i.name}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400",children:"Sem imagem de capa"}),i.logo_url&&e.jsx("div",{className:"absolute -bottom-8 left-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:i.logo_url,alt:`Logo ${i.name}`,className:"w-full h-full object-cover",onError:ne=>{ne.target.style.display="none"}})})})]}),e.jsxs("div",{className:"p-6 pt-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:i.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.organization_type}),e.jsxs("p",{className:"text-gray-500 mt-1",children:[e.jsx("span",{className:"inline-block mr-1",children:"📍"}),[i.city,i.state,i.country].filter(Boolean).join(", ")]}),i.description&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-700",children:i.description})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${a==="players"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>m("players"),children:[e.jsx(Se,{size:18,className:"mr-2"}),"Jogadores"]}),e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${a==="games"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>m("games"),children:[e.jsx(je,{size:18,className:"mr-2"}),"Jogos"]}),e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${a==="results"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>m("results"),children:[e.jsx(be,{size:18,className:"mr-2"}),"Resultados"]})]})}),e.jsx("div",{className:"p-6",children:tt()})]})]}):e.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:e.jsx("p",{children:"Equipe não encontrada."})})});return e.jsxs(Ne,{activeTab:o,setActiveTab:p,children:[e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:at}),q&&e.jsx(Ss,{teamId:t||"",isOpen:q,onClose:()=>ee(!1),onPlayerAdded:Ve}),J&&Q&&e.jsx(Es,{player:Q,isOpen:J,onClose:()=>W(!1),onPlayerUpdated:Je}),d&&Q&&e.jsx(ks,{player:Q,isOpen:d,onClose:()=>Y(!1),onPlayerDeactivated:Ns})]})},Bt=({games:t,teamName:g,teamLogo:c})=>{const[o,p]=s.useState(new Date),[a,m]=s.useState([]),[i,z]=s.useState(null),[h,u]=s.useState([]);s.useEffect(()=>{const v=o.getFullYear(),D=o.getMonth(),P=new Date(v,D,1),x=new Date(v,D+1,0),l=P.getDay(),f=l+x.getDate(),r=Math.ceil(f/7)*7,j=[],k=new Date(v,D,0).getDate();for(let T=l-1;T>=0;T--)j.push(new Date(v,D-1,k-T));for(let T=1;T<=x.getDate();T++)j.push(new Date(v,D,T));const U=r-j.length;for(let T=1;T<=U;T++)j.push(new Date(v,D+1,T));m(j)},[o]),s.useEffect(()=>{if(!i)return;const v=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,D=t.filter(P=>P.game_date.split("T")[0]===v);u(D)},[i,t]);const O=()=>{p(new Date(o.getFullYear(),o.getMonth()-1,1))},y=()=>{p(new Date(o.getFullYear(),o.getMonth()+1,1))},$=v=>{z(v)},w=v=>{const D=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`;return t.some(P=>P.game_date.split("T")[0]===D)},_=v=>{const D={weekday:"long",year:"numeric",month:"long",day:"numeric"};return v.toLocaleDateString("pt-BR",D)},R=o.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),M=v=>{const D=new Date;return v.getDate()===D.getDate()&&v.getMonth()===D.getMonth()&&v.getFullYear()===D.getFullYear()},F=v=>v.getMonth()===o.getMonth();return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(je,{className:"mr-2 h-5 w-5 text-gray-500"}),"Calendário de Jogos"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:O,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(ls,{size:20})}),e.jsx("button",{onClick:y,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(ns,{size:20})})]})]}),e.jsx("h4",{className:"text-center font-medium mb-4 capitalize",children:R}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map((v,D)=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500",children:v},D))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:a.map((v,D)=>{const P=w(v),x=i&&v.getDate()===i.getDate()&&v.getMonth()===i.getMonth()&&v.getFullYear()===i.getFullYear();return e.jsxs("button",{onClick:()=>$(v),className:`
                h-10 w-full rounded-md flex items-center justify-center relative
                ${F(v)?"text-gray-700":"text-gray-400"}
                ${M(v)?"bg-green-100":""}
                ${x?"bg-green-500 text-white":"hover:bg-gray-100"}
              `,children:[v.getDate(),P&&e.jsx("span",{className:`absolute bottom-1 w-1.5 h-1.5 rounded-full ${x?"bg-white":"bg-green-500"}`})]},D)})}),i&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-2 capitalize",children:_(i)}),h.length>0?e.jsx("div",{className:"space-y-2",children:h.map(v=>e.jsx("div",{className:`p-3 rounded-md ${v.game_status==="canceled"?"bg-red-50 border-l-2 border-red-500":v.game_status==="postponed"?"bg-yellow-50 border-l-2 border-yellow-500":v.game_status==="completed"?"bg-green-50 border-l-2 border-green-500":"bg-gray-50"}`,children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-sm font-medium",children:v.game_time}),v.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${v.game_status==="scheduled"?"bg-blue-100 text-blue-800":v.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":v.game_status==="completed"?"bg-green-100 text-green-800":v.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:v.game_status==="scheduled"?"Agendado":v.game_status==="in_progress"?"Em andamento":v.game_status==="completed"?"Concluído":v.game_status==="canceled"?"Cancelado":v.game_status==="postponed"?"Adiado":"Desconhecido"})]})}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:v.location||v.city&&v.city+(v.state?`, ${v.state}`:"")}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:v.home_game?c?e.jsx("img",{src:c,alt:"Logo",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:g.charAt(0)})}):v.opponent_logo_url?e.jsx("img",{src:v.opponent_logo_url,alt:"Logo Oponente",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:v.opponent_name.charAt(0)})})}),e.jsx("span",{className:"font-medium",children:v.home_game?g:v.opponent_name})]}),e.jsx("div",{className:"text-xl font-bold",children:v.score_team!==null&&v.score_team!==void 0?v.home_game?v.score_team:v.score_opponent:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:v.home_game?v.opponent_logo_url?e.jsx("img",{src:v.opponent_logo_url,alt:"Logo Oponente",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:v.opponent_name.charAt(0)})}):c?e.jsx("img",{src:c,alt:"Logo",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:g.charAt(0)})})}),e.jsx("span",{className:"font-medium",children:v.home_game?v.opponent_name:g})]}),e.jsx("div",{className:"text-xl font-bold",children:v.score_opponent!==null&&v.score_opponent!==void 0?v.home_game?v.score_opponent:v.score_team:"-"})]}),v.notes&&e.jsx("p",{className:"text-xs text-gray-600 mt-2 pt-2 border-t",children:v.notes})]})})},v.id))}):e.jsx("p",{className:"text-sm text-gray-500",children:"Nenhum jogo nesta data."})]})]})},Vt=()=>{const{id:t}=ps(),g=he(),[c,o]=s.useState("allteams"),[p,a]=s.useState("players"),[m,i]=s.useState(null),[z,h]=s.useState(!0),[u,O]=s.useState(null),[y,$]=s.useState(null),[w,_]=s.useState([]),[R,M]=s.useState([]),[F,v]=s.useState(!0),[D,P]=s.useState(""),[x,n]=s.useState([]),[l,f]=s.useState(!1),[N,r]=s.useState(!1),[j,k]=s.useState(!1),[U,T]=s.useState(null),A=async W=>{try{if(!W)return;const{data:d,error:Y}=await C.from("games").select("*").eq("team_id",W).order("game_date",{ascending:!0});if(Y)throw Y;d&&(console.log("Jogos carregados:",d),d.length===0?n([{id:"1",team_id:W,opponent_name:"Time Rival FC",game_date:"2025-05-15",game_time:"15:30",location:"Estádio Municipal",city:"São Paulo",state:"SP",home_game:!0,game_status:"scheduled"},{id:"2",team_id:W,opponent_name:"Atlético Visitante",game_date:"2025-05-22",game_time:"19:00",location:"Arena Principal",city:"Rio de Janeiro",state:"RJ",home_game:!1,game_status:"scheduled"},{id:"3",team_id:W,opponent_name:"Unidos FC",game_date:"2025-05-05",game_time:"16:45",location:"Estádio Central",city:"Belo Horizonte",state:"MG",home_game:!0,game_status:"completed",score_team:3,score_opponent:1},{id:"4",team_id:W,opponent_name:"Esporte Clube Visitante",game_date:"2025-04-28",game_time:"20:00",location:"Estádio Visitante",city:"Porto Alegre",state:"RS",home_game:!1,game_status:"completed",score_team:1,score_opponent:2},{id:"5",team_id:W,opponent_name:"Esporte Clube Empate",game_date:"2025-04-20",game_time:"16:00",location:"Estádio Municipal",city:"Curitiba",state:"PR",home_game:!0,game_status:"completed",score_team:2,score_opponent:2}]):n(d))}catch(d){console.error("Erro ao buscar jogos:",d),n([{id:"1",team_id:W,opponent_name:"Time Rival FC",game_date:"2025-05-15",game_time:"15:30",location:"Estádio Municipal",city:"São Paulo",state:"SP",home_game:!0,game_status:"scheduled"},{id:"3",team_id:W,opponent_name:"Unidos FC",game_date:"2025-05-05",game_time:"16:45",location:"Estádio Central",city:"Belo Horizonte",state:"MG",home_game:!0,game_status:"completed",score_team:3,score_opponent:1}])}};s.useEffect(()=>{(async()=>{try{if(!t)return;const{data:d,error:Y}=await C.from("sports_organizations").select("*").eq("id",t).single();if(Y)throw Y;if(i(d),d.esporte_id){const{data:re,error:oe}=await C.from("esportes").select("nome").eq("id",d.esporte_id).single();!oe&&re&&$(re.nome)}const Q=await S(t);r(Q),await L(t),A(t)}catch(d){console.error("Erro ao buscar organização:",d),O("Não foi possível carregar os detalhes da equipe. Por favor, tente novamente.")}finally{h(!1)}})()},[t]);const b=()=>{g("/equipes")},L=async W=>{try{if(v(!0),!W)return;const{data:d,error:Y}=await C.from("players").select("*").eq("team_id",W);if(Y)throw Y;if(d&&d.length>0){const Q=d.filter(de=>de.user_id).map(de=>de.user_id);let re=[];if(Q.length>0){const{data:de,error:K}=await C.from("users").select("id, auth_user_id, name, email").in("auth_user_id",Q);!K&&de&&(re=de)}const oe=d.map(de=>{const K=re.find(te=>te.auth_user_id===de.user_id);return{...de,name:(K==null?void 0:K.name)||de.name,email:(K==null?void 0:K.email)||""}});_(oe),M(oe)}else _([]),M([])}catch(d){console.error("Erro ao buscar jogadores:",d),_([]),M([])}finally{v(!1)}};s.useEffect(()=>{if(D.trim()==="")M(w);else{const W=w.filter(d=>d.name.toLowerCase().includes(D.toLowerCase())||d.position.toLowerCase().includes(D.toLowerCase())||d.number.toString().includes(D)||d.email.toLowerCase().includes(D.toLowerCase()));M(W)}},[D,w]);const S=async W=>{try{const{data:d}=await C.auth.getUser();if(!d.user)return!1;const{data:Y,error:Q}=await C.from("team_followers").select("*").filter("team_id","eq",W).filter("user_id","eq",d.user.id);return Q?(console.error("Erro ao verificar seguidor:",Q),!1):Y&&Y.length>0}catch(d){return console.error("Erro ao verificar seguidor:",d),!1}},E=async()=>{try{k(!0),T(null);const{data:W}=await C.auth.getUser();if(!W.user){T("Você precisa estar logado para seguir uma equipe");return}if(!t){T("ID da equipe não encontrado");return}const{data:d,error:Y}=await C.from("team_followers").select("id").filter("team_id","eq",t).filter("user_id","eq",W.user.id);if(Y){console.error("Erro ao verificar se já segue a equipe:",Y),T("Erro ao seguir equipe. Tente novamente.");return}if(d&&d.length>0){r(!0);return}const{error:Q}=await C.from("team_followers").insert({user_id:W.user.id,team_id:t});if(Q){console.error("Erro ao seguir equipe:",Q),T("Erro ao seguir equipe. Tente novamente.");return}r(!0)}catch(W){console.error("Erro ao seguir equipe:",W),T("Erro ao seguir equipe. Tente novamente.")}finally{k(!1)}},B=async()=>{try{k(!0),T(null);const{data:W}=await C.auth.getUser();if(!W.user){T("Você precisa estar logado para deixar de seguir uma equipe");return}if(!t){T("ID da equipe não encontrado");return}const{data:d,error:Y}=await C.from("team_followers").select("id").filter("team_id","eq",t).filter("user_id","eq",W.user.id);if(Y){console.error("Erro ao buscar registro de seguidor:",Y),T("Erro ao deixar de seguir equipe. Tente novamente.");return}if(!d||d.length===0){console.error("Registro de seguidor não encontrado"),T("Erro ao deixar de seguir equipe. Tente novamente.");return}const{error:Q}=await C.from("team_followers").delete().eq("id",d[0].id);if(Q){console.error("Erro ao deixar de seguir equipe:",Q),T("Erro ao deixar de seguir equipe. Tente novamente.");return}r(!1)}catch(W){console.error("Erro ao deixar de seguir equipe:",W),T("Erro ao deixar de seguir equipe. Tente novamente.")}finally{k(!1)}},Z=()=>{N?B():E()},q=()=>{switch(p){case"players":return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Jogadores"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",placeholder:"Buscar jogador...",className:"pl-3 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",value:D,onChange:d=>P(d.target.value)})})]}),F?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((d,Y)=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center w-full animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/5 mt-1"})]})]},Y))}):R.length===0?e.jsx("p",{className:"text-gray-500",children:w.length===0?"Nenhum jogador cadastrado.":"Nenhum jogador encontrado para a pesquisa."}):e.jsx("div",{className:"space-y-4",children:R.map(d=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:d.photo_url?e.jsx("img",{src:d.photo_url,alt:d.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 text-xl font-medium",children:d.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-lg",children:d.name}),e.jsx("p",{className:"text-sm text-gray-600",children:d.position}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Camisa #",d.number]})]})]},d.id))})]});case"games":return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Próximos Jogos"}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>f(!l),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md flex items-center",children:[e.jsx(je,{size:16,className:"mr-1"}),l?"Modo Lista":"Calendário"]})})]}),l?e.jsx(Bt,{games:x,teamName:(m==null?void 0:m.name)||"",teamLogo:m==null?void 0:m.logo_url}):x.filter(d=>d.game_status!=="completed").length===0?e.jsx("p",{className:"text-gray-500",children:"Nenhum jogo agendado."}):e.jsx("div",{className:"space-y-4",children:x.filter(d=>d.game_status!=="completed").map(d=>e.jsx("div",{className:`bg-white rounded-lg shadow p-4 relative ${d.game_status==="canceled"?"border-l-4 border-red-500":d.game_status==="postponed"?"border-l-4 border-yellow-500":""}`,children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[d.game_date.split("T")[0].split("-").reverse().join("/")," • ",d.game_time]}),d.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${d.game_status==="scheduled"?"bg-blue-100 text-blue-800":d.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":d.game_status==="completed"?"bg-green-100 text-green-800":d.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:d.game_status==="scheduled"?"Agendado":d.game_status==="in_progress"?"Em andamento":d.game_status==="completed"?"Concluído":d.game_status==="canceled"?"Cancelado":d.game_status==="postponed"?"Adiado":"Desconhecido"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:d.location}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:d.home_game?m!=null&&m.logo_url?e.jsx("img",{src:m.logo_url,alt:m.name,className:"w-8 h-8 object-contain"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-xs",children:m==null?void 0:m.name.charAt(0)})}):d.opponent_logo_url?e.jsx("img",{src:d.opponent_logo_url,alt:d.opponent_name,className:"w-8 h-8 object-contain"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-xs",children:d.opponent_name.charAt(0)})})}),e.jsx("span",{className:"font-medium",children:d.home_game?m==null?void 0:m.name:d.opponent_name}),e.jsx("div",{className:"mx-2 text-2xl font-bold",children:d.score_team!==null&&d.score_team!==void 0?d.home_game?d.score_team:d.score_opponent:"-"})]}),e.jsx("div",{className:"text-gray-400 mx-2",children:"vs"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-2xl font-bold mr-2",children:d.score_opponent!==null&&d.score_opponent!==void 0?d.home_game?d.score_opponent:d.score_team:"-"}),e.jsx("span",{className:"font-medium",children:d.home_game?d.opponent_name:m==null?void 0:m.name}),e.jsx("div",{className:"ml-2 flex-shrink-0",children:d.home_game?d.opponent_logo_url?e.jsx("img",{src:d.opponent_logo_url,alt:d.opponent_name,className:"w-8 h-8 object-contain"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-xs",children:d.opponent_name.charAt(0)})}):m!=null&&m.logo_url?e.jsx("img",{src:m.logo_url,alt:m.name,className:"w-8 h-8 object-contain"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-xs",children:m==null?void 0:m.name.charAt(0)})})})]})]}),d.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 pt-2 border-t",children:d.notes})]})})},d.id))})]});case"results":const W=x.filter(d=>d.game_status==="completed"&&d.score_team!==null&&d.score_opponent!==null);return e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Resultados"}),W.length===0?e.jsx("p",{className:"text-gray-500",children:"Nenhum jogo concluído registrado."}):e.jsx("div",{className:"space-y-4",children:W.map(d=>{const Y=d.home_game,Q=Y?d.score_team||0:d.score_opponent||0,re=Y?d.score_opponent||0:d.score_team||0;let oe="draw";return Q>re?oe="win":Q<re&&(oe="loss"),e.jsx("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${oe==="win"?"border-green-500":oe==="loss"?"border-red-500":"border-yellow-500"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:Y?e.jsxs(e.Fragment,{children:[m==null?void 0:m.name," vs ",d.opponent_name]}):e.jsxs(e.Fragment,{children:[d.opponent_name," vs ",m==null?void 0:m.name]})}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[d.game_date.split("T")[0].split("-").reverse().join("/")," • ",d.game_time]}),(d.location||d.city)&&e.jsxs("p",{className:"text-sm text-gray-500",children:[e.jsx(Ce,{size:14,className:"inline mr-1"}),d.location||d.city&&`${[d.city,d.state].filter(Boolean).join(", ")}`]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-lg",children:Y?e.jsxs("span",{children:[d.score_team," - ",d.score_opponent]}):e.jsxs("span",{children:[d.score_opponent," - ",d.score_team]})}),e.jsx("p",{className:`text-sm ${oe==="win"?"text-green-600":oe==="loss"?"text-red-600":"text-yellow-600"}`,children:oe==="win"?"Vitória":oe==="loss"?"Derrota":"Empate"})]})]})},d.id)})})]});default:return null}},ee=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 w-48 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs("div",{className:"p-6 pt-12 space-y-3",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-2/3"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded w-full mt-4"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"}),e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"}),e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((W,d)=>e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 h-24"},d))})]})]})]}),J=e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:b,className:"flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(is,{className:"mr-2 h-5 w-5"}),"Voltar para Equipes"]}),u&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),z?e.jsx(ee,{}):m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsxs("div",{className:"h-48 bg-gray-200 relative",children:[m.capa_url?e.jsx("div",{className:"w-full h-full relative",children:e.jsx("img",{src:m.capa_url,alt:`Capa ${m.name}`,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400",children:"Sem imagem de capa"}),m.logo_url&&e.jsx("div",{className:"absolute -bottom-8 left-6",children:e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:m.logo_url,alt:`Logo ${m.name}`,className:"w-full h-full object-cover",onError:W=>{W.target.style.display="none"}})})})]}),e.jsxs("div",{className:"p-6 pt-12 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:m.name}),e.jsxs("div",{className:"flex items-center text-gray-600 mt-1",children:[e.jsx(Se,{className:"mr-2 h-5 w-5"}),e.jsx("span",{children:y||"Esporte não definido"})]}),(m.city||m.state||m.country)&&e.jsxs("div",{className:"flex items-center text-gray-600 mt-1",children:[e.jsx(Ce,{className:"mr-2 h-5 w-5"}),e.jsx("span",{children:[m.city,m.state,m.country].filter(Boolean).join(", ")})]})]}),e.jsx("button",{onClick:Z,disabled:j,className:`px-4 py-2 rounded-md font-medium text-sm flex items-center ${N?"bg-gray-200 hover:bg-gray-300 text-gray-800":"bg-green-600 hover:bg-green-700 text-white"} transition-colors`,children:j?e.jsx("span",{className:"inline-block h-4 w-4 border-2 border-t-transparent border-white rounded-full animate-spin mr-2"}):N?e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Seguindo"]}):e.jsx(e.Fragment,{children:"Seguir Equipe"})})]}),U&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:U}),m.description&&e.jsx("div",{className:"mt-4 text-gray-700",children:e.jsx("p",{children:m.description})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${p==="players"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>a("players"),children:[e.jsx(Se,{size:18,className:"mr-2"}),"Jogadores"]}),e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${p==="games"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>a("games"),children:[e.jsx(je,{size:18,className:"mr-2"}),"Jogos"]}),e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${p==="results"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>a("results"),children:[e.jsx(be,{size:18,className:"mr-2"}),"Resultados"]})]})}),e.jsx("div",{className:"p-6",children:q()})]})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:e.jsx("p",{className:"text-gray-700",children:"Equipe não encontrada."})})]});return e.jsx(Ne,{activeTab:c,setActiveTab:o,children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:J})})},Jt=()=>{const t=he(),[g,c]=s.useState([]),[o,p]=s.useState(!0),[a,m]=s.useState(null),[i,z]=s.useState(new Date),[h,u]=s.useState([]),[O,y]=s.useState(null),[$,w]=s.useState([]);s.useEffect(()=>{(async()=>{try{p(!0);const{data:l,error:f}=await C.from("sports_organizations").select("id, name, logo_url");if(f)throw f;const{data:N,error:r}=await C.from("games").select("*").order("game_date",{ascending:!0});if(r)throw r;if(l&&N){let j=N.map(U=>{const T=l.find(A=>A.id===U.team_id);return{...U,team_name:(T==null?void 0:T.name)||"Equipe desconhecida",team_logo_url:(T==null?void 0:T.logo_url)||null}});const k=await Promise.all(j.map(async U=>{if(U.league_tournament_id){const{data:T}=await C.from("leagues").select("id, name, logo_url").eq("id",U.league_tournament_id);if(T&&T.length>0)return{...U,league_tournament:{...T[0],type:"league"}};const{data:A}=await C.from("tournaments").select("id, name, logo_url").eq("id",U.league_tournament_id);if(A&&A.length>0)return{...U,league_tournament:{...A[0],type:"tournament"}}}return U}));c(k)}}catch(l){console.error("Erro ao buscar dados:",l),m("Não foi possível carregar os jogos. Por favor, tente novamente mais tarde.")}finally{p(!1)}})()},[]),s.useEffect(()=>{const n=i.getFullYear(),l=i.getMonth(),f=new Date(n,l,1),N=new Date(n,l+1,0),r=new Date(f);r.setDate(f.getDate()-f.getDay());const j=new Date(N);j.setDate(N.getDate()+(6-N.getDay()));const k=[];let U=new Date(r);for(;U<=j;)k.push(new Date(U)),U.setDate(U.getDate()+1);u(k);const T=new Date;T.getMonth()===l&&T.getFullYear()===n?_(T):_(f)},[i]);const _=n=>{y(n);const l=n.toISOString().split("T")[0],f=g.filter(N=>N.game_date===l);w(f)},R=()=>{const n=new Date(i);n.setMonth(n.getMonth()-1),z(n)},M=()=>{const n=new Date(i);n.setMonth(n.getMonth()+1),z(n)},F=n=>n.toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),v=n=>{const l=n.toISOString().split("T")[0];return g.some(f=>f.game_date===l)},D=n=>n.getMonth()===i.getMonth()&&n.getFullYear()===i.getFullYear(),P=n=>O&&n.getDate()===O.getDate()&&n.getMonth()===O.getMonth()&&n.getFullYear()===O.getFullYear(),x=n=>{const l=new Date;return n.getDate()===l.getDate()&&n.getMonth()===l.getMonth()&&n.getFullYear()===l.getFullYear()};return e.jsx(Ne,{activeTab:"calendario",setActiveTab:()=>{},children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-2xl font-bold flex items-center",children:[e.jsx(je,{className:"mr-2"}),"Calendário de Jogos"]})}),o?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse"}),e.jsx("div",{className:"h-7 w-40 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:[...Array(7)].map((n,l)=>e.jsx("div",{className:"text-center h-6 bg-gray-200 rounded animate-pulse"},l))}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-6",children:[...Array(35)].map((n,l)=>e.jsx("div",{className:"h-12 rounded-md bg-gray-200 animate-pulse"},l))}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("div",{className:"h-7 w-64 bg-gray-200 rounded animate-pulse mb-4"}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,l)=>e.jsx("div",{className:"p-4 rounded-md bg-gray-100",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"ml-2 h-5 w-20 bg-gray-200 rounded-full animate-pulse"})]}),e.jsx("div",{className:"h-5 w-32 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"h-5 w-full bg-gray-200 rounded animate-pulse mb-3"}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse mr-2"}),e.jsx("div",{className:"h-5 w-24 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded animate-pulse"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-5 w-24 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse ml-2"})]})]})]})})},l))})]})]}):a?e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:a}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:R,className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(ls,{})}),e.jsx("h2",{className:"text-xl font-semibold capitalize",children:F(i)}),e.jsx("button",{onClick:M,className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(ns,{})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map((n,l)=>e.jsx("div",{className:"text-center font-medium text-gray-500 text-sm py-2",children:n},l))}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-6",children:h.map((n,l)=>e.jsxs("button",{onClick:()=>_(n),className:`
                    h-12 rounded-md flex items-center justify-center relative
                    ${D(n)?"text-gray-800":"text-gray-400"}
                    ${P(n)?"bg-green-500 text-white":""}
                    ${x(n)&&!P(n)?"border border-green-500":""}
                    ${v(n)&&!P(n)?"font-bold":""}
                    hover:bg-gray-100 ${P(n)?"hover:bg-green-600":""}
                  `,children:[n.getDate(),v(n)&&!P(n)&&e.jsx("span",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-green-500 rounded-full"})]},l))}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:O&&O.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"})}),$.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"Nenhum jogo agendado para esta data."}):e.jsx("div",{className:"space-y-4",children:$.map(n=>{var l,f,N,r,j;return e.jsxs("div",{className:`p-4 rounded-md ${n.game_status==="canceled"?"bg-red-50 border-l-2 border-red-500":n.game_status==="postponed"?"bg-yellow-50 border-l-2 border-yellow-500":n.game_status==="completed"?"bg-green-50 border-l-2 border-green-500":"bg-gray-50"}`,children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-sm font-medium",children:n.game_time}),n.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${n.game_status==="scheduled"?"bg-blue-100 text-blue-800":n.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":n.game_status==="completed"?"bg-green-100 text-green-800":n.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:n.game_status==="scheduled"?"Agendado":n.game_status==="in_progress"?"Em andamento":n.game_status==="completed"?"Concluído":n.game_status==="canceled"?"Cancelado":n.game_status==="postponed"?"Adiado":"Desconhecido"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-600",children:n.team_name})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("span",{className:"inline-block mr-1",children:"📍"}),n.location,n.city&&n.state&&` - ${n.city}, ${n.state}`]}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:n.home_game?n.team_logo_url?e.jsx("img",{src:n.team_logo_url,alt:"Logo",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:(l=n.team_name)==null?void 0:l.charAt(0)})}):n.opponent_logo_url?e.jsx("img",{src:n.opponent_logo_url,alt:"Logo Oponente",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:(f=n.opponent_name)==null?void 0:f.charAt(0)})})}),e.jsx("div",{className:"font-medium",children:n.home_game?n.team_name:n.opponent_name})]}),e.jsx("div",{className:"text-xl font-bold",children:n.score_team!==null&&n.score_team!==void 0?n.home_game?n.score_team:n.score_opponent:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:n.home_game?n.opponent_logo_url?e.jsx("img",{src:n.opponent_logo_url,alt:"Logo Oponente",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:(r=n.opponent_name)==null?void 0:r.charAt(0)})}):n.team_logo_url?e.jsx("img",{src:n.team_logo_url,alt:"Logo",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:(N=n.team_name)==null?void 0:N.charAt(0)})})}),e.jsx("div",{className:"font-medium",children:n.home_game?n.opponent_name:n.team_name})]}),e.jsx("div",{className:"text-xl font-bold",children:n.score_opponent!==null&&n.score_opponent!==void 0?n.home_game?n.score_opponent:n.score_team:"-"})]})]})}),n.league_tournament&&e.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>t(`/ligastorneios/${n.league_tournament_id}`),children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:n.league_tournament.logo_url?e.jsx("img",{src:n.league_tournament.logo_url,alt:"Logo",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium text-xs",children:((j=n.league_tournament.name)==null?void 0:j.charAt(0))||"?"})})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium",children:[n.league_tournament.type==="league"?"Liga":"Torneio",":"]})," ",n.league_tournament.name]})]}),n.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 pt-2 border-t",children:n.notes})]},n.id)})})]})]})]})})},Ht=({type:t,onClose:g,onSuccess:c})=>{const{user:o}=ce(),[p,a]=s.useState(""),[m,i]=s.useState(""),[z,h]=s.useState(t==="league"?"home_away":"knockout"),[u,O]=s.useState(""),[y,$]=s.useState(""),[w,_]=s.useState(""),[R,M]=s.useState(""),[F,v]=s.useState(""),[D,P]=s.useState(void 0),[x,n]=s.useState("open_registration"),[l,f]=s.useState(null),[N,r]=s.useState(null),[j,k]=s.useState(null),[U,T]=s.useState(null),[A,b]=s.useState(!1),[L,S]=s.useState(null),[E,B]=s.useState(null),[Z,q]=s.useState({cover:0,logo:0}),ee=({progress:H})=>e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mt-2",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${H}%`}})}),[J,W]=s.useState({}),d=[{value:"home_away",label:"Ida e Volta"},{value:"single",label:"Turno Único"}],Y=[{value:"knockout",label:"Eliminatório"},{value:"points",label:"Pontos Corridos"},{value:"group_stage",label:"Fase de Grupos"},{value:"mixed",label:"Misto (Grupos + Eliminatórias)"}],Q=[{value:"open_registration",label:"Inscrições Abertas"},{value:"in_progress",label:"Em Andamento"},{value:"finished",label:"Finalizado"}];s.useEffect(()=>{if(E){const H=setTimeout(()=>{B(null)},5e3);return()=>clearTimeout(H)}},[E]);const re=()=>{const H={};return p.trim()||(H.name="O nome é obrigatório"),u||(H.startDate="A data de início é obrigatória"),y?u&&new Date(u)>new Date(y)&&(H.endDate="A data de término deve ser posterior à data de início"):H.endDate="A data de término é obrigatória",t==="tournament"&&!D&&(H.participantsNumber="O número de participantes é obrigatório"),W(H),Object.keys(H).length===0},oe=H=>{if(H.target.files&&H.target.files[0]){const se=H.target.files[0];f(se);const V=new FileReader;V.onload=I=>{var X;r((X=I.target)==null?void 0:X.result)},V.readAsDataURL(se)}},de=H=>{if(H.target.files&&H.target.files[0]){const se=H.target.files[0];k(se);const V=new FileReader;V.onload=I=>{var X;T((X=I.target)==null?void 0:X.result)},V.readAsDataURL(se)}},K=async(H,se)=>{try{const V=H.name.split(".").pop(),I=`${Math.random().toString(36).substring(2,15)}_${Date.now()}.${V}`,X=`${se}/${I}`,{error:ae}=await C.storage.from("league-tournament-images").upload(X,H,{cacheControl:"3600",upsert:!0});if(ae)throw console.error("Erro no upload de imagem:",ae),new Error(`Falha no upload: ${ae.message}`);const{data:{publicUrl:me}}=C.storage.from("league-tournament-images").getPublicUrl(X);return me}catch(V){throw console.error("Erro no upload de imagem:",V),V}},te=async H=>{H.preventDefault();try{if(!re())return;if(b(!0),S(null),B(null),!o){S("Você precisa estar logado para criar uma liga ou torneio.");return}let se=null,V=null;try{if(l){console.log("Fazendo upload da imagem de capa..."),q(X=>({...X,cover:10}));try{se=await K(l,"covers"),q(X=>({...X,cover:100})),console.log("Upload da imagem de capa concluído:",se)}catch(X){console.error("Erro no upload da imagem de capa:",X),S("Erro no upload da imagem de capa: Verifique se você tem permissão para acessar o bucket de armazenamento."),q(ae=>({...ae,cover:0})),b(!1);return}}if(j){console.log("Fazendo upload do logo..."),q(X=>({...X,logo:10}));try{V=await K(j,"logos"),q(X=>({...X,logo:100})),console.log("Upload do logo concluído:",V)}catch(X){console.error("Erro no upload do logo:",X),S("Erro no upload do logo: Verifique se você tem permissão para acessar o bucket de armazenamento."),q(ae=>({...ae,logo:0})),b(!1);return}}}catch(X){console.error("Erro durante o upload de imagens:",X),S("Erro ao fazer upload das imagens: Verifique se você tem permissão para acessar o bucket de armazenamento."),q({cover:0,logo:0}),b(!1);return}const I={name:p,description:m,format:z,start_date:u,end_date:y,location:w,city:R,state:F,cover_image_url:se,logo_url:V,created_by:o.id};if(console.log(`Salvando ${t==="league"?"liga":"torneio"} no banco de dados:`,I),t==="league"){const{error:X,data:ae}=await C.from("leagues").insert([I]).select();if(X)throw console.error("Erro ao inserir liga:",X),X;console.log("Liga criada com sucesso:",ae)}else{const{error:X,data:ae}=await C.from("tournaments").insert([{...I,participants_number:D,status:x}]).select();if(X)throw console.error("Erro ao inserir torneio:",X),X;console.log("Torneio criado com sucesso:",ae)}B(`${t==="league"?"Liga":"Torneio"} criado com sucesso!`),a(""),i(""),h(t==="league"?"home_away":"knockout"),O(""),$(""),_(""),P(void 0),f(null),r(null),k(null),T(null),q({cover:0,logo:0}),setTimeout(()=>{c()},1500)}catch(se){console.error(`Erro ao criar ${t==="league"?"liga":"torneio"}:`,se);let V=`Não foi possível criar ${t==="league"?"a liga":"o torneio"}.`;se.message&&(se.message.includes("duplicate key")?V="Já existe uma "+(t==="league"?"liga":"torneio")+" com este nome.":se.message.includes("permission denied")?V="Você não tem permissão para criar "+(t==="league"?"ligas":"torneios")+".":V+=" "+se.message),S(V)}finally{b(!1)}};return e.jsxs("div",{className:"relative flex flex-col h-[70vh] max-h-[70vh] bg-white rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 pb-2 border-b border-gray-200 rounded-t-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-6 pt-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:t==="league"?"Adicionar Nova Liga":"Adicionar Novo Torneio"}),e.jsx("button",{onClick:g,className:"p-1 rounded-full hover:bg-gray-100",type:"button",children:e.jsx(le,{size:20})})]}),L&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mx-6 mb-4 flex items-start",children:[e.jsx(ke,{className:"mr-2 mt-0.5 flex-shrink-0",size:18}),e.jsx("span",{children:L})]}),E&&e.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mx-6 mb-4 flex items-start",children:[e.jsx(Ee,{className:"mr-2 mt-0.5 flex-shrink-0",size:18}),e.jsx("span",{children:E})]})]}),e.jsx("div",{className:"overflow-y-auto flex-grow custom-scrollbar",children:e.jsx("form",{id:"leagueTournamentForm",onSubmit:te,children:e.jsxs("div",{className:"space-y-6 px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome*"}),e.jsx("input",{type:"text",value:p,onChange:H=>{a(H.target.value),J.name&&W(se=>({...se,name:""}))},className:`w-full px-3 py-2 border ${J.name?"border-red-500":"border-gray-300"} rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:`Nome ${t==="league"?"da liga":"do torneio"}`,required:!0}),J.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:m,onChange:H=>i(H.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descrição detalhada",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Imagem de Capa"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg",children:N?e.jsxs("div",{className:"relative w-full",children:[e.jsx("img",{src:N,alt:"Preview",className:"mx-auto h-32 object-cover rounded"}),e.jsx("button",{type:"button",onClick:()=>{f(null),r(null),q(H=>({...H,cover:0}))},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1",children:e.jsx(le,{size:16})}),Z.cover>0&&Z.cover<100&&e.jsx(ee,{progress:Z.cover})]}):e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center text-sm text-gray-600",children:[e.jsx(Be,{className:"mb-2 text-gray-400",size:32}),e.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[e.jsx("span",{children:"Carregar imagem"}),e.jsx("input",{type:"file",className:"sr-only",accept:"image/*",onChange:oe})]}),e.jsx("p",{className:"pl-1 mt-1",children:"ou arraste e solte"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF até 10MB"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg",children:U?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:U,alt:"Preview",className:"mx-auto h-24 w-24 object-cover rounded-full"}),e.jsx("button",{type:"button",onClick:()=>{k(null),T(null),q(H=>({...H,logo:0}))},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1",children:e.jsx(le,{size:16})}),Z.logo>0&&Z.logo<100&&e.jsx(ee,{progress:Z.logo})]}):e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center text-sm text-gray-600",children:[e.jsx(Be,{className:"mb-2 text-gray-400",size:24}),e.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[e.jsx("span",{children:"Carregar logo"}),e.jsx("input",{type:"file",className:"sr-only",accept:"image/*",onChange:de})]}),e.jsx("p",{className:"pl-1 mt-1",children:"ou arraste e solte"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF até 5MB"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato*"}),e.jsx("select",{value:z,onChange:H=>h(H.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:(t==="league"?d:Y).map(H=>e.jsx("option",{value:H.value,children:H.label},H.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Início*"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"date",id:"startDate",value:u,onChange:H=>{O(H.target.value),J.startDate&&W(se=>({...se,startDate:""}))},className:`w-full px-3 py-2 border ${J.startDate?"border-red-500":"border-gray-300"} rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0,onClick:H=>{H.currentTarget.showPicker()}}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 cursor-pointer bg-transparent border-none",onClick:()=>{const H=document.getElementById("startDate");H&&H.showPicker()},children:e.jsx(je,{className:"text-gray-400",size:18})})]})}),J.startDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Término*"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"date",id:"endDate",value:y,onChange:H=>{$(H.target.value),J.endDate&&W(se=>({...se,endDate:""}))},className:`w-full px-3 py-2 border ${J.endDate?"border-red-500":"border-gray-300"} rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500`,required:!0,onClick:H=>{H.currentTarget.showPicker()}}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 cursor-pointer bg-transparent border-none",onClick:()=>{const H=document.getElementById("endDate");H&&H.showPicker()},children:e.jsx(je,{className:"text-gray-400",size:18})})]})}),J.endDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.endDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Localização"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ke,{value:w,onChange:(H,se)=>{M(H),v(se),_(H&&se?`${H}, ${se}`:"")},className:"w-full",placeholder:"Selecione uma cidade"}),e.jsx(Ce,{className:"absolute left-3 top-2.5 text-gray-400 pointer-events-none hidden",size:18})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Selecione a cidade onde a liga/torneio será realizado"})]}),t==="tournament"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Participantes*"}),e.jsx("input",{type:"number",value:D||"",onChange:H=>{P(parseInt(H.target.value)||void 0),J.participantsNumber&&W(se=>({...se,participantsNumber:""}))},className:`w-full px-3 py-2 border ${J.participantsNumber?"border-red-500":"border-gray-300"} rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Ex: 16",min:2,required:!0}),J.participantsNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:J.participantsNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status*"}),e.jsx("select",{value:x,onChange:H=>n(H.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:Q.map(H=>e.jsx("option",{value:H.value,children:H.label},H.value))})]})]})]})})}),e.jsx("div",{className:"sticky bottom-0 bg-white pt-3 pb-3 border-t border-gray-200 z-10 rounded-b-xl",children:e.jsxs("div",{className:"flex justify-end space-x-3 px-6",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 text-gray-600 hover:text-gray-800 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors",disabled:A,children:"Cancelar"}),e.jsx("button",{type:"submit",form:"leagueTournamentForm",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",disabled:A,children:A?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"animate-spin mr-2",size:18}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{size:18,className:"mr-2"}),"Salvar"]})})]})})]})},Wt=()=>{const t=he(),{user:g}=ce(),[c,o]=s.useState("all"),[p,a]=s.useState([]),[m,i]=s.useState([]),[z,h]=s.useState(!0),[u,O]=s.useState(null),[y,$]=s.useState(""),[w,_]=s.useState(null),[R,M]=s.useState(!1),[F,v]=s.useState(null),[D,P]=s.useState(!1),[x,n]=s.useState(null),[l,f]=s.useState(!1),N=async()=>{try{if(h(!0),!g)return;const{data:q,error:ee}=await C.from("leagues").select("*").order("created_at",{ascending:!1});if(ee)throw ee;const{data:J,error:W}=await C.from("tournaments").select("*").order("created_at",{ascending:!1});if(W)throw W;const d=q.map(oe=>({...oe,type:"league"})),Y=J.map(oe=>({...oe,type:"tournament"})),Q=[...d,...Y],re=Q.filter(oe=>oe.created_by===g.id);a(re),i(Q)}catch(q){console.error("Erro ao buscar ligas e torneios:",q),O("Não foi possível carregar as ligas e torneios. Por favor, tente novamente.")}finally{h(!1)}};s.useEffect(()=>{(async()=>{if(g!=null&&g.id)try{const ee=localStorage.getItem(`user_data_${g.id}`);if(ee){const d=JSON.parse(ee);if(d.role){console.log("Role do usuário (do cache):",d.role),_(d.role);return}}const{data:J,error:W}=await C.from("users").select("role").eq("auth_user_id",g.id).single();if(W){console.error("Erro ao buscar papel do usuário:",W);return}J!=null&&J.role&&(console.log("Role do usuário (do servidor):",J.role),_(J.role))}catch(ee){console.error("Erro ao buscar papel do usuário:",ee)}})(),N()},[g]);const r=p.filter(q=>{var ee;return q.name.toLowerCase().includes(y.toLowerCase())||((ee=q.description)==null?void 0:ee.toLowerCase().includes(y.toLowerCase()))}),j=m.filter(q=>{var ee;return q.name.toLowerCase().includes(y.toLowerCase())||((ee=q.description)==null?void 0:ee.toLowerCase().includes(y.toLowerCase()))}),k=()=>{v(null),M(!0)},U=q=>{v(q)},T=()=>{N(),M(!1),v(null)},A=(q,ee)=>{q.stopPropagation(),n(ee),P(!0)},b=async()=>{if(x){f(!0);try{const{error:q}=await C.from(x.type==="league"?"leagues":"tournaments").delete().eq("id",x.id);if(q)throw q;N(),P(!1),n(null)}catch(q){console.error("Erro ao excluir:",q),alert("Erro ao excluir o item. Por favor, tente novamente.")}finally{f(!1)}}},L=()=>{M(!1),v(null)},S=q=>new Date(q).toLocaleDateString("pt-BR"),E=(q,ee)=>{if(ee==="league")switch(q){case"home_away":return"Ida e Volta";case"single":return"Turno Único";default:return q}else switch(q){case"knockout":return"Eliminatório";case"points":return"Pontos Corridos";case"group_stage":return"Fase de Grupos";case"mixed":return"Misto (Grupos + Eliminatórias)";default:return q}},B=q=>{switch(q){case"open_registration":return"Inscrições Abertas";case"in_progress":return"Em Andamento";case"finished":return"Finalizado";default:return q}},Z=q=>{switch(q){case"open_registration":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"finished":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(Ne,{activeTab:"tournaments",setActiveTab:()=>{},children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(be,{className:"mr-2"}),"Ligas e Torneios"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Buscar...",value:y,onChange:q=>$(q.target.value),className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(Le,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]}),w!=="atleta"&&w!=="fa"&&e.jsxs("button",{onClick:k,className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Pe,{size:18,className:"mr-1"}),"Adicionar"]})]})]}),e.jsxs("div",{className:"flex border-b mb-6",children:[w!=="atleta"&&w!=="fa"&&e.jsx("button",{onClick:()=>o("my"),className:`px-4 py-2 font-medium ${c==="my"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:"Minhas Ligas e Torneios"}),e.jsx("button",{onClick:()=>o("all"),className:`px-4 py-2 font-medium ${c==="all"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:"Todas as Ligas e Torneios"})]}),z?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((q,ee)=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"h-32 bg-gray-200 animate-pulse relative"}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute -top-8 left-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white bg-gray-200 animate-pulse"})})}),e.jsxs("div",{className:"pt-10 px-4 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"w-3/4",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})]}),e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded-full animate-pulse"})]}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2 w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-3 w-2/3"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"h-5 w-20 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-5 w-24 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded-full animate-pulse"})]})]})]},ee))}):u?e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:u}):e.jsx("div",{children:c==="my"?r.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(be,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"Nenhuma Liga ou Torneio"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Você ainda não criou nenhuma liga ou torneio."}),e.jsxs("button",{onClick:k,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Pe,{size:18,className:"inline mr-1"}),"Adicionar Liga ou Torneio"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(q=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow relative group",onClick:()=>t(`/ligastorneios/${q.id}`),children:[q.created_by===(g==null?void 0:g.id)&&e.jsx("button",{onClick:ee=>A(ee,q),className:"absolute top-2 right-2 p-1.5 bg-white text-gray-400 rounded-full hover:bg-red-50 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10 shadow-sm",title:"Excluir",children:e.jsx(Ae,{size:16})}),e.jsxs("div",{className:"h-32 bg-gray-200 relative",children:[q.cover_image_url?e.jsx("img",{src:q.cover_image_url,alt:q.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:e.jsx(be,{size:48,className:"text-gray-400"})}),e.jsx("div",{className:"absolute -bottom-8 left-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white bg-white overflow-hidden",children:q.logo_url?e.jsx("img",{src:q.logo_url,alt:`Logo ${q.name}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx(be,{size:24,className:"text-gray-400"})})})})]}),e.jsxs("div",{className:"pt-10 px-4 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg truncate",children:q.name}),e.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[S(q.start_date)," - ",S(q.end_date)]})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:q.type==="league"?"Liga":"Torneio"})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:q.description||"Sem descrição"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:E(q.format,q.type)}),q.type==="tournament"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:[q.participants_number," participantes"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Z(q.status)}`,children:B(q.status)})]})]})]})]},q.id))}):j.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(be,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"Nenhuma Liga ou Torneio Encontrado"}),e.jsx("p",{className:"text-gray-500",children:"Não há ligas ou torneios que correspondam à sua busca."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map(q=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t(`/ligastorneios/${q.id}`),children:[e.jsxs("div",{className:"h-32 bg-gray-200 relative",children:[q.cover_image_url?e.jsx("img",{src:q.cover_image_url,alt:q.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:e.jsx(be,{size:48,className:"text-gray-400"})}),e.jsx("div",{className:"absolute -bottom-8 left-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white bg-white overflow-hidden",children:q.logo_url?e.jsx("img",{src:q.logo_url,alt:`Logo ${q.name}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx(be,{size:24,className:"text-gray-400"})})})})]}),e.jsxs("div",{className:"pt-10 px-4 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg truncate",children:q.name}),e.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[S(q.start_date)," - ",S(q.end_date)]})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:q.type==="league"?"Liga":"Torneio"})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:q.description||"Sem descrição"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:E(q.format,q.type)}),q.type==="tournament"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-800",children:[q.participants_number," participantes"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${Z(q.status)}`,children:B(q.status)})]})]})]})]},q.id))})})]}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-xl w-full max-w-md overflow-hidden",children:F?e.jsx(Ht,{type:F,onClose:L,onSuccess:T}):e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"O que você deseja criar?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>U("league"),className:"p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-center transition-colors",children:[e.jsx(be,{size:32,className:"mb-2 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Liga"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Formato de ida e volta"})]}),e.jsxs("button",{onClick:()=>U("tournament"),className:"p-4 border rounded-lg hover:bg-gray-50 flex flex-col items-center transition-colors",children:[e.jsx(be,{size:32,className:"mb-2 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Torneio"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Diversos formatos"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:L,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"})})]})})}),e.jsx(ms,{isOpen:D,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir ${(x==null?void 0:x.type)==="league"?"a liga":"o torneio"} "${x==null?void 0:x.name}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir",cancelText:"Cancelar",onConfirm:b,onCancel:()=>{P(!1),n(null)},isLoading:l})]})},Yt=({isOpen:t,onClose:g,onTeamSelected:c})=>{const{user:o}=ce(),[p,a]=s.useState([]),[m,i]=s.useState(!0),[z,h]=s.useState(null),[u,O]=s.useState("");s.useEffect(()=>{t&&(async()=>{try{if(!o)return;i(!0);const{data:w,error:_}=await C.from("sports_organizations").select("id, name, logo_url").eq("created_by",o.id).order("name");if(_)throw _;a(w||[])}catch(w){console.error("Erro ao buscar equipes:",w),h("Não foi possível carregar as equipes. Por favor, tente novamente.")}finally{i(!1)}})()},[t,o]);const y=p.filter($=>$.name.toLowerCase().includes(u.toLowerCase()));return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md flex flex-col max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b rounded-t-xl",children:[e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Selecionar Equipe"}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100",children:e.jsx(le,{size:20})})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Buscar equipe...",value:u,onChange:$=>O($.target.value),className:"w-full px-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),e.jsx(Le,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:m?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx(Ie,{size:24,className:"animate-spin text-green-600"})}):z?e.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded-lg",children:z}):y.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhuma equipe encontrada."})}):e.jsx("div",{className:"space-y-3",children:y.map($=>e.jsxs("button",{onClick:()=>c($.id,$.name),className:"w-full flex items-center p-3 rounded-lg hover:bg-gray-50 border transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex-shrink-0 flex items-center justify-center mr-3",children:$.logo_url?e.jsx("img",{src:$.logo_url,alt:$.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 font-medium",children:$.name.charAt(0).toUpperCase()})}),e.jsx("div",{className:"text-left",children:e.jsx("h3",{className:"font-medium",children:$.name})})]},$.id))})})]})}):null},Xt=({tournamentId:t,tournamentStatus:g,isCreator:c,onStatusChange:o})=>{const{user:p}=ce(),a=he(),[m,i]=s.useState([]),[z,h]=s.useState([]),[u,O]=s.useState(!0),[y,$]=s.useState(!1),[w,_]=s.useState(!1),[R,M]=s.useState(null),[F,v]=s.useState(null),[D,P]=s.useState("");s.useEffect(()=>{t&&(async()=>{try{O(!0);const{data:b,error:L}=await C.from("tournament_registrations").select(`
            *,
            team:team_id (
              id,
              name,
              logo_url
            )
          `).eq("tournament_id",t);if(L)throw L;i(b||[])}catch(b){console.error("Erro ao buscar inscrições:",b),M("Não foi possível carregar as inscrições.")}finally{O(!1)}})()},[t]),s.useEffect(()=>{(async()=>{if(p)try{const{data:b,error:L}=await C.from("sports_organizations").select("id, name, logo_url").eq("created_by",p.id);if(L)throw L;h(b||[]),b&&b.length===1&&P(b[0].id)}catch(b){console.error("Erro ao buscar equipes do usuário:",b)}})()},[p]);const x=()=>m.some(A=>z.some(b=>b.id===A.team_id)),n=async()=>{if(!D){M("Selecione uma equipe para se inscrever.");return}try{$(!0),M(null);const{data:A,error:b}=await C.from("tournaments").select("status").eq("id",t).single();if(b)throw b;if(A.status!=="open_registration")throw new Error("Este torneio não está aceitando inscrições no momento.");const{error:L}=await C.from("tournament_registrations").insert({tournament_id:t,team_id:D,status:"pending"});if(L)throw L;const{data:S,error:E}=await C.from("tournament_registrations").select(`
          *,
          team:team_id (
            id,
            name,
            logo_url
          )
        `).eq("tournament_id",t);if(E)throw E;i(S||[]),v("Inscrição realizada com sucesso! Aguarde a aprovação."),setTimeout(()=>v(null),5e3)}catch(A){console.error("Erro ao inscrever equipe:",A),M(A.message||"Não foi possível realizar a inscrição.")}finally{$(!1)}},l=async(A,b)=>{try{const{error:L}=await C.from("tournament_registrations").update({status:b,updated_at:new Date().toISOString()}).eq("id",A);if(L)throw L;i(S=>S.map(E=>E.id===A?{...E,status:b}:E)),v(`Inscrição ${b==="approved"?"aprovada":"rejeitada"} com sucesso!`),setTimeout(()=>v(null),5e3)}catch(L){console.error("Erro ao atualizar inscrição:",L),M("Não foi possível atualizar a inscrição.")}},f=async A=>{if(confirm("Tem certeza que deseja remover esta equipe do torneio? Esta ação não pode ser desfeita."))try{const{error:b}=await C.from("tournament_registrations").delete().eq("id",A);if(b)throw b;i(L=>L.filter(S=>S.id!==A)),v("Equipe removida do torneio com sucesso!"),setTimeout(()=>v(null),5e3)}catch(b){console.error("Erro ao excluir inscrição:",b),M("Não foi possível remover a equipe do torneio.")}},N=async A=>{try{_(!0),M(null);const{error:b}=await C.from("tournaments").update({status:A}).eq("id",t);if(b)throw b;o(A),v(`Status do torneio atualizado para "${A==="open_registration"?"Inscrições Abertas":A==="in_progress"?"Em Andamento":"Finalizado"}"`),setTimeout(()=>v(null),5e3)}catch(b){console.error("Erro ao atualizar status do torneio:",b),M("Não foi possível atualizar o status do torneio.")}finally{_(!1)}},r=()=>R?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded flex items-center mb-4",children:[e.jsx(ke,{size:18,className:"mr-2"}),R]}):F?e.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded flex items-center mb-4",children:[e.jsx(Ee,{size:18,className:"mr-2"}),F]}):null,j=()=>{if(!c)return null;const A=()=>{switch(g){case"open_registration":return"Inscrições Abertas";case"in_progress":return"Em Andamento";case"finished":return"Finalizado";default:return"Status Desconhecido"}};return e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gerenciar Status do Torneio"}),e.jsx("div",{className:"mb-3",children:e.jsxs("p",{className:"text-sm font-medium text-gray-600",children:["Status atual:",e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${g==="open_registration"?"bg-blue-100 text-blue-800":g==="in_progress"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:A()})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>N("open_registration"),disabled:g==="open_registration"||w,className:`px-4 py-2 rounded-md text-sm font-medium flex items-center ${g==="open_registration"?"bg-blue-200 text-blue-800 border-2 border-blue-500 shadow-md":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[g==="open_registration"&&e.jsx(Ee,{size:16,className:"mr-1"}),w&&g!=="open_registration"?e.jsx(Ie,{size:16,className:"animate-spin mr-1"}):null,"Inscrições Abertas"]}),e.jsxs("button",{onClick:()=>N("in_progress"),disabled:g==="in_progress"||w,className:`px-4 py-2 rounded-md text-sm font-medium flex items-center ${g==="in_progress"?"bg-yellow-200 text-yellow-800 border-2 border-yellow-500 shadow-md":"bg-yellow-600 text-white hover:bg-yellow-700"}`,children:[g==="in_progress"&&e.jsx(Ee,{size:16,className:"mr-1"}),w&&g!=="in_progress"?e.jsx(Ie,{size:16,className:"animate-spin mr-1"}):null,"Em Andamento"]}),e.jsxs("button",{onClick:()=>N("finished"),disabled:g==="finished"||w,className:`px-4 py-2 rounded-md text-sm font-medium flex items-center ${g==="finished"?"bg-green-200 text-green-800 border-2 border-green-500 shadow-md":"bg-green-600 text-white hover:bg-green-700"}`,children:[g==="finished"&&e.jsx(Ee,{size:16,className:"mr-1"}),w&&g!=="finished"?e.jsx(Ie,{size:16,className:"animate-spin mr-1"}):null,"Finalizado"]})]})]})},k=()=>{var A;if(c)return null;if(g!=="open_registration")return e.jsx("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:e.jsx("p",{className:"text-gray-700",children:g==="in_progress"?"Este torneio já está em andamento. Não é possível realizar novas inscrições.":"Este torneio está finalizado. Não é possível realizar novas inscrições."})});if(x()){const b=m.find(S=>z.some(E=>E.id===S.team_id));if(!b)return null;const L=(A=z.find(S=>S.id===b.team_id))==null?void 0:A.name;return e.jsx("div",{className:`bg-${b.status==="pending"?"yellow":b.status==="approved"?"green":"red"}-100 p-4 rounded-lg mb-6`,children:e.jsx("p",{className:`text-${b.status==="pending"?"yellow":b.status==="approved"?"green":"red"}-700`,children:b.status==="pending"?`Sua equipe "${L}" está inscrita e aguardando aprovação.`:b.status==="approved"?`Sua equipe "${L}" foi aprovada para participar deste torneio.`:`A inscrição da sua equipe "${L}" foi rejeitada.`})})}return e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Inscrever Equipe"}),z.length===0?e.jsx("p",{className:"text-gray-700",children:"Você não possui nenhuma equipe para inscrever."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:"Selecione sua equipe:"}),e.jsxs("select",{value:D,onChange:b=>P(b.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:y,children:[e.jsx("option",{value:"",children:"Selecione uma equipe"}),z.map(b=>e.jsx("option",{value:b.id,children:b.name},b.id))]})]}),e.jsx("button",{onClick:n,disabled:y||!D,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed",children:y?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{size:16,className:"animate-spin inline mr-1"}),"Inscrevendo..."]}):"Inscrever-se no Torneio"})]})]})},U=()=>{const A=m.filter(b=>b.status==="approved");return A.length===0?e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Participantes do Torneio"}),e.jsx("p",{className:"text-gray-500 py-4",children:"Nenhuma equipe aprovada neste torneio ainda."})]}):e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Participantes do Torneio"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(b=>{var L,S,E,B,Z;return e.jsxs("div",{className:"bg-white border border-gray-200 p-4 rounded-lg flex items-center justify-between shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>a(`/visualizar-equipe/${b.team_id}`),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex-shrink-0 flex items-center justify-center mr-3",children:(L=b.team)!=null&&L.logo_url?e.jsx("img",{src:b.team.logo_url,alt:(S=b.team)==null?void 0:S.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 font-medium",children:((B=(E=b.team)==null?void 0:E.name)==null?void 0:B.charAt(0))||"?"})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:(Z=b.team)==null?void 0:Z.name})})]}),e.jsx(Os,{size:16,className:"text-gray-400"})]},b.id)})})]})},T=()=>{if(!c)return null;const A=m.filter(S=>S.status==="pending"),b=m.filter(S=>S.status==="approved"),L=m.filter(S=>S.status==="rejected");return e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Gerenciar Inscrições"}),u?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Ie,{size:24,className:"animate-spin text-blue-600"})}):m.length===0?e.jsx("p",{className:"text-gray-500 py-4",children:"Nenhuma equipe inscrita neste torneio."}):e.jsxs("div",{className:"space-y-6",children:[A.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2 text-yellow-700",children:"Inscrições Pendentes"}),e.jsx("div",{className:"space-y-2",children:A.map(S=>{var E,B,Z,q,ee;return e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex-shrink-0 flex items-center justify-center mr-3",children:(E=S.team)!=null&&E.logo_url?e.jsx("img",{src:S.team.logo_url,alt:(B=S.team)==null?void 0:B.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 font-medium",children:((q=(Z=S.team)==null?void 0:Z.name)==null?void 0:q.charAt(0))||"?"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(ee=S.team)==null?void 0:ee.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Inscrito em: ",new Date(S.created_at).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l(S.id,"approved"),className:"p-1.5 bg-green-100 text-green-700 rounded-full hover:bg-green-200",title:"Aprovar",children:e.jsx(Ee,{size:18})}),e.jsx("button",{onClick:()=>l(S.id,"rejected"),className:"p-1.5 bg-red-100 text-red-700 rounded-full hover:bg-red-200",title:"Rejeitar",children:e.jsx(le,{size:18})})]})]},S.id)})})]}),b.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2 text-green-700",children:"Equipes Aprovadas"}),e.jsx("div",{className:"space-y-2",children:b.map(S=>{var E,B,Z,q,ee;return e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center cursor-pointer flex-grow",onClick:()=>a(`/visualizar-equipe/${S.team_id}`),children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex-shrink-0 flex items-center justify-center mr-3",children:(E=S.team)!=null&&E.logo_url?e.jsx("img",{src:S.team.logo_url,alt:(B=S.team)==null?void 0:B.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 font-medium",children:((q=(Z=S.team)==null?void 0:Z.name)==null?void 0:q.charAt(0))||"?"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(ee=S.team)==null?void 0:ee.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Aprovado em: ",S.updated_at?new Date(S.updated_at).toLocaleDateString("pt-BR"):"Não informado"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l(S.id,"rejected"),className:"p-1.5 bg-yellow-100 text-yellow-700 rounded-full hover:bg-yellow-200",title:"Desativar equipe",children:e.jsx(le,{size:18})}),e.jsx("button",{onClick:J=>{J.stopPropagation(),f(S.id)},className:"p-1.5 bg-red-100 text-red-700 rounded-full hover:bg-red-200",title:"Remover equipe do torneio",children:e.jsx(ke,{size:18})})]})]},S.id)})})]}),L.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2 text-red-700",children:"Inscrições Rejeitadas"}),e.jsx("div",{className:"space-y-2",children:L.map(S=>{var E,B,Z,q,ee;return e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center cursor-pointer flex-grow",onClick:()=>a(`/visualizar-equipe/${S.team_id}`),children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex-shrink-0 flex items-center justify-center mr-3",children:(E=S.team)!=null&&E.logo_url?e.jsx("img",{src:S.team.logo_url,alt:(B=S.team)==null?void 0:B.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-gray-500 font-medium",children:((q=(Z=S.team)==null?void 0:Z.name)==null?void 0:q.charAt(0))||"?"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(ee=S.team)==null?void 0:ee.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Rejeitado em: ",S.updated_at?new Date(S.updated_at).toLocaleDateString("pt-BR"):"Não informado"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l(S.id,"approved"),className:"p-1.5 bg-green-100 text-green-700 rounded-full hover:bg-green-200",title:"Aprovar equipe",children:e.jsx(Ee,{size:18})}),e.jsx("button",{onClick:J=>{J.stopPropagation(),f(S.id)},className:"p-1.5 bg-red-100 text-red-700 rounded-full hover:bg-red-200",title:"Remover inscrição",children:e.jsx(ke,{size:18})})]})]},S.id)})})]})]})]})};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[r(),j(),k(),c?T():null,U()]})},Qt=()=>{const{id:t}=ps(),g=he(),{user:c}=ce(),[o,p]=s.useState("games"),[a,m]=s.useState(null),[i,z]=s.useState([]),[h,u]=s.useState("ligastorneios"),[O,y]=s.useState(!0),[$,w]=s.useState(null),[_,R]=s.useState(!1),[M,F]=s.useState(!1),[v,D]=s.useState(null),[P,x]=s.useState(!1),[n,l]=s.useState(!1),[f,N]=s.useState(""),[r,j]=s.useState(!1),[k,U]=s.useState(null),[T,A]=s.useState(null),[b,L]=s.useState(""),[S,E]=s.useState(!1),[B,Z]=s.useState(""),[q,ee]=s.useState("");s.useEffect(()=>{(async()=>{if(c)try{const{data:I,error:X}=await C.from("users").select("role").eq("auth_user_id",c.id).single();if(X)throw X;I&&A(I.role);const{data:ae,error:me}=await C.from("sports_organizations").select("id").limit(1);if(me)throw me;ae&&ae.length>0&&L(ae[0].id)}catch(I){console.error("Erro ao buscar dados iniciais:",I)}})()},[c]);const J=async V=>{try{if(!V)return;const{data:I,error:X}=await C.from("games").select(`
          *,
          team:team_id (
            name,
            logo_url
          )
        `).eq("league_tournament_id",V).order("game_date",{ascending:!0});if(X)throw X;if(I){const ae=await Promise.all(I.map(async me=>{if(me.league_tournament_id){const{data:ue}=await C.from("leagues").select("id, name, logo_url").eq("id",me.league_tournament_id).single();if(ue)return{...me,league_tournament:{...ue,type:"league"}};const{data:xe}=await C.from("tournaments").select("id, name, logo_url").eq("id",me.league_tournament_id).single();if(xe)return{...me,league_tournament:{...xe,type:"tournament"}}}return me}));z(ae)}}catch(I){console.error("Erro ao buscar jogos:",I)}},W=()=>{t&&J(t)},d=()=>{t&&J(t)},Y=V=>{D(V),F(!0),U(null)},Q=V=>{N(V),l(!0),U(null)},re=async()=>{if(f){j(!0);try{const{error:V}=await C.from("games").delete().eq("id",f);if(V)throw V;t&&J(t)}catch(V){console.error("Erro ao excluir jogo:",V),alert("Não foi possível excluir o jogo. Por favor, tente novamente.")}finally{j(!1),l(!1),N("")}}},oe=V=>{U(k===V?null:V)},de=(V,I)=>{if(I==="league")switch(V){case"home_away":return"Ida e Volta";case"single":return"Turno Único";default:return V}else switch(V){case"knockout":return"Eliminatório";case"points":return"Pontos Corridos";case"group_stage":return"Fase de Grupos";case"mixed":return"Misto (Grupos + Eliminatórias)";default:return V}};s.useEffect(()=>{(async()=>{if(t)try{y(!0);const{data:I}=await C.from("leagues").select("*").eq("id",t).single();if(I)m({...I,type:"league"});else{const{data:X,error:ae}=await C.from("tournaments").select("*").eq("id",t).single();if(ae)throw ae;if(X)m({...X,type:"tournament"});else throw new Error("Liga ou torneio não encontrado")}J(t)}catch(I){console.error("Erro ao buscar liga/torneio:",I),w("Não foi possível carregar os dados da liga/torneio.")}finally{y(!1)}})()},[t]);const K=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 w-48 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs("div",{className:"p-6 pt-12 space-y-3",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-2/3"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded w-full mt-4"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"px-6 py-3 h-12 bg-gray-200 rounded-sm w-32 m-1"})})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((V,I)=>e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 h-24"},I))})]})]})]}),te=V=>{a&&a.type==="tournament"&&m({...a,status:V})},H=()=>{var V;switch(o){case"participants":return e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Participantes do Torneio"}),(a==null?void 0:a.type)==="tournament"?e.jsx(Xt,{tournamentId:a.id,tournamentStatus:a.status||"open_registration",isCreator:a.created_by===(c==null?void 0:c.id),onStatusChange:te}):e.jsx("p",{className:"text-gray-500",children:"Esta funcionalidade está disponível apenas para torneios."})]});case"games":return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Jogos"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>x(!P),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-md flex items-center",children:[e.jsx(je,{size:16,className:"mr-1"}),P?"Modo Lista":"Calendário"]}),T!=="atleta"&&(a==null?void 0:a.created_by)===(c==null?void 0:c.id)&&e.jsxs("button",{onClick:()=>E(!0),className:"px-3 py-1 text-sm bg-green-600 hover:bg-green-700 text-white rounded-md flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Jogo"]})]})]}),S&&e.jsx(Yt,{isOpen:S,onClose:()=>E(!1),onTeamSelected:(I,X)=>{Z(I),ee(X),E(!1),R(!0)}}),_&&e.jsx(Vs,{teamId:B||b,teamName:q||(a==null?void 0:a.name)||"",isOpen:_,onClose:()=>{R(!1),Z(""),ee("")},onGameAdded:W,leagueTournamentId:a==null?void 0:a.id}),M&&v&&e.jsx(Js,{game:v,teamName:((V=v.team)==null?void 0:V.name)||"",isOpen:M,onClose:()=>F(!1),onGameUpdated:d}),e.jsx(ms,{isOpen:n,title:"Confirmar Exclusão",message:"Tem certeza que deseja excluir este jogo? Esta ação não pode ser desfeita.",confirmText:"Excluir",cancelText:"Cancelar",onConfirm:re,onCancel:()=>{l(!1),N("")},isLoading:r}),P?e.jsx(Hs,{games:i,teamName:(a==null?void 0:a.name)||"",teamLogo:a==null?void 0:a.logo_url,onEditGame:Y,onDeleteGame:Q,userRole:T}):e.jsx("div",{children:O?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(I=>e.jsx("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"}),e.jsx("div",{className:"ml-2 h-5 bg-gray-200 rounded-full w-20"})]}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-48 mb-3"}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full mr-2"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24"})]}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full mr-2"}),e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24"})]}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"})})]})},I))}):i.length===0?e.jsxs("p",{className:"text-gray-500",children:["Nenhum jogo agendado para esta ",(a==null?void 0:a.type)==="league"?"liga":"torneio","."]}):e.jsx("div",{className:"space-y-4",children:i.map(I=>{var X,ae,me,ue,xe,ze,es,Ve,ss,Je,ts;return e.jsxs("div",{className:`bg-white rounded-lg shadow p-4 relative ${I.game_status==="canceled"?"border-l-4 border-red-500":I.game_status==="postponed"?"border-l-4 border-yellow-500":I.game_status==="completed"?"border-l-4 border-green-500":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[I.game_date.split("T")[0].split("-").reverse().join("/")," • ",I.game_time]}),I.game_status&&e.jsx("span",{className:`ml-2 text-xs px-2 py-1 rounded-full ${I.game_status==="scheduled"?"bg-blue-100 text-blue-800":I.game_status==="in_progress"?"bg-yellow-100 text-yellow-800":I.game_status==="completed"?"bg-green-100 text-green-800":I.game_status==="canceled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:I.game_status==="scheduled"?"Agendado":I.game_status==="in_progress"?"Em andamento":I.game_status==="completed"?"Concluído":I.game_status==="canceled"?"Cancelado":I.game_status==="postponed"?"Adiado":"Desconhecido"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("span",{className:"inline-block mr-1",children:"📍"}),I.location,I.city&&I.state&&` - ${I.city}, ${I.state}`]}),e.jsxs("div",{className:"flex items-center justify-between mb-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:I.home_game?(X=I.team)!=null&&X.logo_url?e.jsx("img",{src:I.team.logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((me=(ae=I.team)==null?void 0:ae.name)==null?void 0:me.charAt(0))||"?"})}):I.opponent_logo_url?e.jsx("img",{src:I.opponent_logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((ue=I.opponent_name)==null?void 0:ue.charAt(0))||"?"})})}),e.jsx("div",{className:"font-medium",children:I.home_game?(xe=I.team)==null?void 0:xe.name:I.opponent_name})]}),e.jsx("div",{className:"text-2xl font-bold",children:I.score_team!==null&&I.score_team!==void 0?I.home_game?I.score_team:I.score_opponent:"-"})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:I.home_game?I.opponent_logo_url?e.jsx("img",{src:I.opponent_logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((ss=I.opponent_name)==null?void 0:ss.charAt(0))||"?"})}):(ze=I.team)!=null&&ze.logo_url?e.jsx("img",{src:I.team.logo_url,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:((Ve=(es=I.team)==null?void 0:es.name)==null?void 0:Ve.charAt(0))||"?"})})}),e.jsx("div",{className:"font-medium",children:I.home_game?I.opponent_name:(Je=I.team)==null?void 0:Je.name})]}),e.jsx("div",{className:"text-2xl font-bold",children:I.score_opponent!==null&&I.score_opponent!==void 0?I.home_game?I.score_opponent:I.score_team:"-"})]})]}),e.jsx("div",{className:"flex items-center",children:T!=="atleta"&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>oe(I.id),className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(rs,{size:18})}),k===I.id&&e.jsx("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg z-10 border",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>Y(I),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Editar"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>Q(I.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),"Excluir"]})})]})})]})})]}),I.league_tournament&&e.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center cursor-pointer hover:bg-gray-50 p-1 rounded",onClick:()=>g(`/ligastorneios/${I.league_tournament_id}`),children:[e.jsx("div",{className:"mr-2 flex-shrink-0",children:I.league_tournament.logo_url?e.jsx("img",{src:I.league_tournament.logo_url,alt:"Logo",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium text-xs",children:((ts=I.league_tournament.name)==null?void 0:ts.charAt(0))||"?"})})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("span",{className:"font-medium",children:[I.league_tournament.type==="league"?"Liga":"Torneio",":"]})," ",I.league_tournament.name]})]}),I.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 pt-2 border-t",children:I.notes})]},I.id)})})})]});default:return null}},se=e.jsx(e.Fragment,{children:O?e.jsx(K,{}):$?e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:e.jsx("p",{children:$})}):a?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>g("/ligastorneios"),className:"flex items-center text-gray-600 hover:text-green-600 mb-4 transition-colors",children:[e.jsx(is,{size:18,className:"mr-1"}),e.jsx("span",{children:"Voltar para Ligas e Torneios"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsxs("div",{className:"h-48 bg-gray-200 relative",children:[a.cover_image_url?e.jsx("img",{src:a.cover_image_url,alt:`Capa ${a.name}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400",children:"Sem imagem de capa"}),a.logo_url&&e.jsx("div",{className:"absolute -bottom-8 left-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:a.logo_url,alt:`Logo ${a.name}`,className:"w-full h-full object-cover",onError:V=>{V.target.style.display="none"}})})})]}),e.jsxs("div",{className:"p-6 pt-12",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:a.name}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:a.type==="league"?"Liga":"Torneio"})]}),e.jsxs("div",{className:"mt-2 text-gray-600",children:[e.jsxs("p",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Formato:"})," ",de(a.format,a.type)]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Período:"})," ",new Date(a.start_date).toLocaleDateString("pt-BR")," a ",new Date(a.end_date).toLocaleDateString("pt-BR")]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Local:"})," ",a.location]}),a.type==="tournament"&&e.jsxs("p",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Participantes:"})," ",a.participants_number]})]}),a.description&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-700",children:a.description})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${o==="games"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>p("games"),children:[e.jsx(je,{size:18,className:"mr-2"}),"Jogos"]}),(a==null?void 0:a.type)==="tournament"&&e.jsxs("button",{className:`px-6 py-3 font-medium text-sm flex items-center ${o==="participants"?"text-green-600 border-b-2 border-green-600":"text-gray-600 hover:text-green-600"}`,onClick:()=>p("participants"),children:[e.jsx(Se,{size:18,className:"mr-2"}),"Participantes"]})]})}),e.jsx("div",{className:"p-6",children:H()})]})]}):e.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:e.jsx("p",{children:"Liga ou torneio não encontrado."})})});return e.jsx(Ne,{activeTab:h,setActiveTab:u,children:e.jsx("div",{className:"container mx-auto px-4 py-6 max-w-6xl",children:se})})},Zt=()=>{const t=he(),g=mt(),[c,o]=s.useState([]),[p,a]=s.useState([]),[m,i]=s.useState(!0),[z,h]=s.useState(!0),[u,O]=s.useState(null),[y,$]=s.useState(null),[w,_]=s.useState("allteams"),[R,M]=s.useState("all"),[F,v]=s.useState(""),[D,P]=s.useState([]),[x,n]=s.useState({}),l=async r=>{try{h(!0),$(null);const{data:j}=await C.auth.getUser();if(!j.user){a([]);return}const{data:k,error:U}=await C.from("team_followers").select("team_id").filter("user_id","eq",j.user.id);if(U)throw U;if(!k||k.length===0){a([]);return}const T=k.map(S=>S.team_id),{data:A,error:b}=await C.from("sports_organizations").select("*").in("id",T);if(b)throw b;const L=(A||[]).map(S=>{const E=r==null?void 0:r.find(B=>B.id===S.esporte_id);return{...S,nome:E?E.nome:void 0}});a(L)}catch(j){console.error("Erro ao buscar equipes seguidas:",j),$("Não foi possível carregar as equipes que você segue. Por favor, tente novamente.")}finally{h(!1)}};s.useEffect(()=>{const r=g.state;r!=null&&r.followStatusChanged&&(window.history.replaceState({},document.title),(async()=>{const{data:k}=await C.from("esportes").select("*");await l(k)})())},[g]),s.useEffect(()=>{(async()=>{try{i(!0);const{data:j,error:k}=await C.from("esportes").select("*");if(k)throw k;const{data:U,error:T}=await C.from("sports_organizations").select("*").order("created_at",{ascending:!1});if(T)throw T;const A=(U||[]).map(b=>{const L=j==null?void 0:j.find(S=>S.id===b.esporte_id);return{...b,nome:L?L.nome:void 0}});o(A),P(A),await l(j)}catch(j){console.error("Erro ao buscar organizações/esportes:",j),O("Não foi possível carregar as equipes. Por favor, tente novamente.")}finally{i(!1)}})()},[]),s.useEffect(()=>{const r=R==="all"?c:p;if(F.trim()==="")P(r);else{const j=r.filter(k=>k.name.toLowerCase().includes(F.toLowerCase())||k.nome&&k.nome.toLowerCase().includes(F.toLowerCase())||k.city&&k.city.toLowerCase().includes(F.toLowerCase())||k.state&&k.state.toLowerCase().includes(F.toLowerCase())||k.country&&k.country.toLowerCase().includes(F.toLowerCase()));P(j)}},[F,c,p,R]);const f=r=>{t(`/visualizar-equipe/${r}`)},N=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(Se,{className:"mr-2"}),"Equipes"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Pesquisar equipes...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",value:F,onChange:r=>v(r.target.value)})]})]}),e.jsxs("div",{className:"flex border-b mb-6",children:[e.jsxs("button",{onClick:()=>M("all"),className:`px-4 py-2 font-medium flex items-center ${R==="all"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Se,{size:18,className:"mr-2"}),"Todas as Equipes"]}),e.jsxs("button",{onClick:()=>M("followed"),className:`px-4 py-2 font-medium flex items-center ${R==="followed"?"text-green-600 border-b-2 border-green-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),"Equipes que Sigo"]})]}),R==="all"&&u&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),R==="followed"&&y&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:y}),R==="all"&&m||R==="followed"&&z?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((r,j)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"h-40 bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2 w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})]})]},j))}):D.length===0?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:e.jsx("p",{className:"text-gray-600 mb-4",children:F.trim()!==""?"Nenhuma equipe encontrada para esta pesquisa.":R==="all"?"Não há equipes cadastradas no sistema.":'Você ainda não segue nenhuma equipe. Visite a aba "Todas as Equipes" para encontrar equipes para seguir.'})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(r=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>f(r.id),children:[e.jsxs("div",{className:"h-40 bg-gray-200 relative",children:[r.capa_url?e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("div",{className:`w-full h-full absolute inset-0 bg-gray-200 ${x[`capa-${r.id}`]?"opacity-0":"opacity-100"} transition-opacity duration-300`}),e.jsx("img",{src:r.capa_url,alt:`Capa ${r.name}`,className:`w-full h-full object-cover ${x[`capa-${r.id}`]?"opacity-100":"opacity-0"} transition-opacity duration-300`,onLoad:()=>{n(j=>({...j,[`capa-${r.id}`]:!0}))}})]}):r.logo_url?e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("div",{className:`w-full h-full absolute inset-0 bg-gray-200 ${x[`main-logo-${r.id}`]?"opacity-0":"opacity-100"} transition-opacity duration-300`}),e.jsx("img",{src:r.logo_url,alt:`Logo ${r.name}`,className:`w-full h-full object-contain p-4 ${x[`main-logo-${r.id}`]?"opacity-100":"opacity-0"} transition-opacity duration-300`,onLoad:()=>{n(j=>({...j,[`main-logo-${r.id}`]:!0}))}})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400",children:"Sem imagem"}),r.logo_url&&e.jsx("div",{className:"absolute -bottom-8 left-4",children:e.jsxs("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-white bg-white shadow-md relative",children:[e.jsx("div",{className:`w-full h-full absolute inset-0 bg-gray-200 rounded-full ${x[`small-logo-${r.id}`]?"opacity-0":"opacity-100"} transition-opacity duration-300`}),e.jsx("img",{src:r.logo_url,alt:`Logo ${r.name}`,className:`w-full h-full object-cover ${x[`small-logo-${r.id}`]?"opacity-100":"opacity-0"} transition-opacity duration-300`,onLoad:()=>{n(j=>({...j,[`small-logo-${r.id}`]:!0}))},onError:j=>{j.target.style.display="none"}})]})})]}),e.jsxs("div",{className:"p-4 pt-10",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.nome?r.nome:"Esporte não definido"}),e.jsx("p",{className:"text-sm text-gray-500",children:[r.city,r.state,r.country].filter(Boolean).join(", ")})]})]},r.id))})]});return e.jsx(Ne,{activeTab:w,setActiveTab:_,children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-8",children:N})})},Ws=({size:t="medium",className:g=""})=>{const c={small:"w-4 h-4 border-2",medium:"w-8 h-8 border-3",large:"w-12 h-12 border-4"};return e.jsx("div",{className:`${c[t]} ${g} rounded-full border-t-green-500 border-r-green-500 border-b-green-200 border-l-green-200 animate-spin`})},Kt=({isOpen:t,onClose:g,onProductAdded:c})=>{var r,j;const[o,p]=s.useState(""),[a,m]=s.useState(""),[i,z]=s.useState(""),[h,u]=s.useState(""),[O,y]=s.useState(""),[$,w]=s.useState(null),[_,R]=s.useState(null),[M,F]=s.useState([]),[v,D]=s.useState(!1),[P,x]=s.useState(null),{user:n}=ce();s.useEffect(()=>{(async()=>{if(n)try{const{data:U,error:T}=await C.from("users").select("id, role").eq("auth_user_id",n.id).single();if(T)throw T;if(!U){x("Usuário não encontrado.");return}let A=[];if(U.role==="admin"){const{data:b,error:L}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").order("name");if(L)throw L;A=b||[]}else if(U.role==="tecnico"){const{data:b,error:L}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").eq("created_by",n.id).order("name");if(L)throw L;if(A=b||[],A.length===0){const{data:S,error:E}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").eq("created_by",U.id).order("name");E||(A=S||[])}}F(A),A.length===1&&y(A[0].id),A.length===0&&x("Você não possui organizações esportivas. Crie uma equipe primeiro para poder adicionar produtos.")}catch(U){console.error("Erro ao buscar organizações:",U),x("Não foi possível carregar suas organizações esportivas.")}})()},[n]);const l=k=>{var A;const U=(A=k.target.files)==null?void 0:A[0];if(!U)return;w(U);const T=new FileReader;T.onloadend=()=>{R(T.result)},T.readAsDataURL(U)},f=()=>o.trim()?a.trim()?i.trim()?isNaN(parseFloat(i))||parseFloat(i)<=0?"Preço deve ser um valor positivo":h.trim()?isNaN(parseInt(h))||parseInt(h)<0?"Estoque deve ser um valor não negativo":O?null:"Selecione uma organização":"Estoque é obrigatório":"Preço é obrigatório":"Descrição do produto é obrigatória":"Nome do produto é obrigatório",N=async k=>{k.preventDefault();const U=f();if(U){x(U);return}D(!0),x(null);try{let T=null;if($){const S=$.name.split(".").pop(),B=`products/${`${Math.random().toString(36).substring(2,15)}.${S}`}`,{error:Z}=await C.storage.from("product-images").upload(B,$);if(Z)throw Z;const{data:q}=C.storage.from("product-images").getPublicUrl(B);T=q.publicUrl}const A=Math.round(parseFloat(i)*100),{data:b,error:L}=await C.from("products").insert({name:o,description:a,price:A,stock:parseInt(h),organization_id:O,image_url:T,status:!0}).select(`
          *,
          organization:organization_id (
            name,
            logo_url
          )
        `).single();if(L)throw L;if(b){const S={...b,price:b.price/100};c(S),g()}}catch(T){console.error("Erro ao adicionar produto:",T),x(T.message||"Ocorreu um erro ao adicionar o produto.")}finally{D(!1)}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Adicionar Novo Produto"}),e.jsx("button",{onClick:g,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(le,{size:24})})]}),e.jsxs("form",{onSubmit:N,className:"p-4",children:[P&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(ke,{className:"text-red-500 mr-2 flex-shrink-0 mt-0.5",size:18}),e.jsx("p",{className:"text-red-700 text-sm",children:P})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Produto *"}),e.jsx("input",{type:"text",value:o,onChange:k=>p(k.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: Camisa Oficial",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Organização Esportiva *"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:O,onChange:k=>y(k.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none",required:!0,children:[e.jsx("option",{value:"",children:"Selecione uma organização"}),M.length>0?M.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id)):e.jsx("option",{value:"",disabled:!0,children:"Nenhuma organização encontrada"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),M.length===0&&!v&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Você não possui organizações esportivas. Crie uma equipe primeiro para poder adicionar produtos."}),O&&e.jsxs("div",{className:"mt-2",children:[((r=M.find(k=>k.id===O))==null?void 0:r.logo_url)&&e.jsx("img",{src:((j=M.find(k=>k.id===O))==null?void 0:j.logo_url)||"",alt:"Logo da organização",className:"h-8 w-8 object-cover rounded-full inline-block mr-2"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Os produtos serão associados a esta organização esportiva."})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição *"}),e.jsx("textarea",{value:a,onChange:k=>m(k.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",rows:3,placeholder:"Descreva o produto em detalhes",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preço (R$) *"}),e.jsx("input",{type:"number",value:i,onChange:k=>z(k.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: 99.90",min:"0.01",step:"0.01",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque Disponível *"}),e.jsx("input",{type:"number",value:h,onChange:k=>u(k.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: 50",min:"0",step:"1",required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Imagem do Produto"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative border border-dashed border-gray-300 rounded-md p-4 text-center cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:l,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Me,{className:"text-gray-400 mb-2",size:24}),e.jsx("p",{className:"text-sm text-gray-500",children:"Clique para selecionar ou arraste uma imagem"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG ou JPEG (máx. 5MB)"})]})]})}),_&&e.jsxs("div",{className:"w-24 h-24 relative",children:[e.jsx("img",{src:_,alt:"Preview",className:"w-full h-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{w(null),R(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(le,{size:14})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:v,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(Ws,{size:"small",className:"mr-2"}),"Salvando..."]}):"Salvar Produto"})]})]})]})}):null},ea="/images/logo.jpg",Ys=({product:t,isCoach:g,onEdit:c,onDelete:o,onAddToCart:p})=>{const[a,m]=s.useState(!1),[i,z]=s.useState(null),h=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u/100);return s.useEffect(()=>{const u=setTimeout(()=>{z(t.image_url||ea)},Math.random()*300);return()=>clearTimeout(u)},[t.image_url]),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden transition-transform hover:shadow-lg hover:-translate-y-1",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden bg-gray-100",children:[!a&&!i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-10 h-10 border-4 border-gray-200 border-t-green-500 rounded-full animate-spin"})}),t.image_url?i?e.jsx("img",{src:i,alt:t.name,className:`w-full h-full object-cover transition-opacity duration-300 ${a?"opacity-100":"opacity-0"}`,onLoad:()=>m(!0),onError:u=>{var $,w;const O=u.target;O.style.display="none",($=O.parentElement)==null||$.classList.add("flex","items-center","justify-center","bg-gray-100");const y=document.createElement("div");y.className="text-gray-400 text-lg font-medium",y.innerText="Sem imagem",(w=O.parentElement)==null||w.appendChild(y),m(!0)}}):null:e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 text-gray-400 text-lg font-medium",children:"Sem imagem"}),t.stock<=0&&e.jsx("div",{className:"absolute top-0 right-0 bg-red-500 text-white px-2 py-1 text-xs font-bold",children:"Esgotado"}),t.organization&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-2 text-sm truncate flex items-center",children:[t.organization.logo_url?e.jsx("div",{className:"w-5 h-5 mr-1 rounded-full overflow-hidden bg-white flex-shrink-0",children:e.jsx("img",{src:t.organization.logo_url,alt:"",className:"w-full h-full object-cover",loading:"lazy",onError:u=>{u.target.style.display="none"}})}):null,e.jsx("span",{className:"truncate",children:t.organization.name})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-1 truncate",children:t.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2 h-10",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ut,{className:"text-green-500 mr-1",size:18}),e.jsx("span",{className:"font-bold text-lg",children:h(t.price)})]}),e.jsx("div",{className:"flex space-x-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Editar produto",onClick:()=>c&&c(t),children:e.jsx(Ye,{size:18,className:"text-gray-600"})}),e.jsx("button",{className:"p-2 bg-gray-100 rounded-full hover:bg-red-100 transition-colors",title:"Excluir produto",onClick:()=>o&&o(t),children:e.jsx(Ae,{size:18,className:"text-gray-600 hover:text-red-600"})})]}):p&&e.jsx("button",{className:"p-2 bg-green-100 rounded-full hover:bg-green-200 transition-colors",title:"Adicionar ao carrinho",onClick:()=>p(t),disabled:t.stock<=0,children:e.jsx(We,{size:18,className:`${t.stock<=0?"text-gray-400":"text-green-600"}`})})})]}),t.stock>0&&e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[t.stock," ",t.stock===1?"unidade":"unidades"," em estoque"]})]})]})},Xs=()=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 animate-pulse",children:[e.jsx("div",{className:"relative h-48 bg-gray-200"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mb-1"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6 mb-3"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"mt-2 h-4 bg-gray-200 rounded w-1/3"})]})]}),sa=({isOpen:t,onClose:g,onProductUpdated:c,product:o})=>{var k,U,T;const[p,a]=s.useState(""),[m,i]=s.useState(""),[z,h]=s.useState(""),[u,O]=s.useState(""),[y,$]=s.useState(""),[w,_]=s.useState(null),[R,M]=s.useState(null),[F,v]=s.useState([]),[D,P]=s.useState(!1),[x,n]=s.useState(null),{user:l}=ce();s.useEffect(()=>{t&&o&&(a(o.name),i(o.description),h((o.price/100).toFixed(2)),O(o.stock.toString()),$(o.organization_id),M(o.image_url))},[t,o]),s.useEffect(()=>{t&&(async()=>{if(l)try{const{data:b,error:L}=await C.from("users").select("id, role").eq("auth_user_id",l.id).single();if(L)throw L;if(!b){n("Usuário não encontrado.");return}let S=[];if(b.role==="admin"){const{data:E,error:B}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").order("name");if(B)throw B;S=E||[]}else if(b.role==="tecnico"){const{data:E,error:B}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").eq("created_by",l.id).order("name");if(B)throw B;if(S=E||[],S.length===0){const{data:Z,error:q}=await C.from("sports_organizations").select("id, name, logo_url, description, esporte_id").eq("created_by",b.id).order("name");q||(S=Z||[])}}v(S),S.length===0&&n("Você não possui organizações esportivas. Crie uma equipe primeiro para poder editar produtos.")}catch(b){console.error("Erro ao buscar organizações:",b),n("Não foi possível carregar suas organizações esportivas.")}})()},[l,t]);const f=A=>{var S;const b=(S=A.target.files)==null?void 0:S[0];if(!b)return;_(b);const L=new FileReader;L.onloadend=()=>{M(L.result)},L.readAsDataURL(b)},N=()=>{_(null),M(null)},r=()=>p.trim()?m.trim()?z.trim()?isNaN(parseFloat(z))||parseFloat(z)<=0?"Preço deve ser um valor positivo":u.trim()?isNaN(parseInt(u))||parseInt(u)<0?"Estoque deve ser um valor não negativo":y?null:"Selecione uma organização":"Estoque é obrigatório":"Preço é obrigatório":"Descrição do produto é obrigatória":"Nome do produto é obrigatório",j=async A=>{A.preventDefault();const b=r();if(b){n(b);return}P(!0),n(null);try{let L=R;if(w){const Z=w.name.split(".").pop(),ee=`products/${`${Math.random().toString(36).substring(2,15)}.${Z}`}`,{error:J}=await C.storage.from("product-images").upload(ee,w);if(J)throw J;const{data:W}=C.storage.from("product-images").getPublicUrl(ee);L=W.publicUrl}const S=Math.round(parseFloat(z)*100),{data:E,error:B}=await C.from("products").update({name:p,description:m,price:S,stock:parseInt(u),organization_id:y,image_url:L}).eq("id",o.id).select(`
          *,
          organization:organization_id (
            name,
            logo_url
          )
        `).single();if(B)throw B;if(E){const Z={...E,price:E.price/100};c(Z),g()}}catch(L){console.error("Erro ao atualizar produto:",L),n(L.message||"Ocorreu um erro ao atualizar o produto.")}finally{P(!1)}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Editar Produto"}),e.jsx("button",{onClick:g,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(le,{size:24})})]}),e.jsxs("form",{onSubmit:j,className:"p-4",children:[x&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(ke,{className:"text-red-500 mr-2 flex-shrink-0 mt-0.5",size:18}),e.jsx("p",{className:"text-red-700 text-sm",children:x})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Produto *"}),e.jsx("input",{type:"text",value:p,onChange:A=>a(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: Camisa Oficial",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Organização Esportiva *"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:y,onChange:A=>$(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none",required:!0,children:[e.jsx("option",{value:"",children:"Selecione uma organização"}),F.length>0?F.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id)):e.jsx("option",{value:"",disabled:!0,children:"Nenhuma organização encontrada"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),F.length===0&&!D&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:"Você não possui organizações esportivas. Crie uma equipe primeiro para poder editar produtos."}),y&&e.jsx("div",{className:"mt-2",children:((k=F.find(A=>A.id===y))==null?void 0:k.logo_url)&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:((U=F.find(A=>A.id===y))==null?void 0:U.logo_url)||"",alt:"Logo da organização",className:"w-6 h-6 rounded-full mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:(T=F.find(A=>A.id===y))==null?void 0:T.name})]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição *"}),e.jsx("textarea",{value:m,onChange:A=>i(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 min-h-[100px]",placeholder:"Descreva o produto...",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preço (R$) *"}),e.jsx("input",{type:"number",value:z,onChange:A=>h(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: 99.90",step:"0.01",min:"0",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque *"}),e.jsx("input",{type:"number",value:u,onChange:A=>O(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ex: 50",min:"0",step:"1",required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Imagem do Produto"}),e.jsx("input",{type:"file",onChange:f,className:"hidden",id:"image-upload",accept:"image/*"}),R?e.jsxs("div",{className:"relative mb-2",children:[e.jsx("img",{src:R,alt:"Preview",className:"w-full max-h-48 object-contain border rounded-md"}),e.jsx("button",{type:"button",onClick:N,className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition-colors",title:"Remover imagem",children:e.jsx(le,{size:16})}),e.jsx("label",{htmlFor:"image-upload",className:"absolute bottom-2 right-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-1 px-2 rounded-md cursor-pointer transition-colors text-xs",children:"Trocar imagem"})]}):e.jsxs("label",{htmlFor:"image-upload",className:"border-2 border-dashed border-gray-300 rounded-md p-4 text-center mb-2 block cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(Me,{className:"mx-auto text-gray-400 mb-2",size:24}),e.jsx("p",{className:"text-sm text-gray-500",children:"Clique para selecionar ou arraste uma imagem"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",disabled:D,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center",disabled:D,children:D?e.jsxs(e.Fragment,{children:[e.jsx(Ws,{size:"small",className:"mr-2"}),"Salvando..."]}):"Salvar Alterações"})]})]})]})}):null},ta=()=>{var H,se;const[t,g]=s.useState([]),[c,o]=s.useState([]),[p,a]=s.useState(!0),[m,i]=s.useState(""),[z,h]=s.useState(!1),[u,O]=s.useState(!1),[y,$]=s.useState(!1),[w,_]=s.useState(!1),[R,M]=s.useState(!1),[F,v]=s.useState(null),[D,P]=s.useState(!1),[x,n]=s.useState(null),[l,f]=s.useState({min:0,max:null}),[N,r]=s.useState(1e3),[j,k]=s.useState(!1),[U,T]=s.useState(""),{user:A}=ce(),b=he();s.useEffect(()=>{(async()=>{if(A!=null&&A.id)try{const{data:I,error:X}=await C.from("users").select("id, role, openpix_pix_key").eq("auth_user_id",A.id).single();if(X)throw X;n(I)}catch(I){console.error("Erro ao buscar dados do usuário:",I)}})()},[A]);const[L,S]=s.useState([]),[E,B]=s.useState(!1);s.useEffect(()=>{(async()=>{if(!(!(A!=null&&A.id)||!x))try{const{data:I,error:X}=await C.from("sports_organizations").select("id").eq("created_by",A.id);if(X)throw X;const{data:ae,error:me}=await C.from("players").select("team_id").eq("user_id",A.id);if(me)throw me;const ue=[...(I==null?void 0:I.map(ze=>ze.id))||[],...(ae==null?void 0:ae.map(ze=>ze.team_id))||[]],xe=[...new Set(ue)];S(xe),xe.length===0&&(a(!1),g([]),o([]))}catch(I){console.error("Erro ao buscar organizações do usuário:",I),a(!1)}finally{B(!0)}})()},[A,x]);const Z=async(V=!0)=>{try{if(!A||L.length===0){g([]),o([]),V&&a(!1);return}const{data:I,error:X}=await C.from("products").select(`
          id,
          name,
          description,
          image_url,
          price,
          stock,
          status,
          organization_id,
          organization:organization_id (
            name,
            logo_url
          )
        `).eq("status",!0).in("organization_id",L).order("created_at",{ascending:!1});if(X)throw X;if(I){const ae=I;localStorage.setItem(`cached_products_${A.id}`,JSON.stringify({data:ae,timestamp:Date.now(),orgIds:L})),g(ae),o(ae)}}catch(I){console.error("Erro ao buscar produtos frescos:",I)}finally{V&&a(!1)}};s.useEffect(()=>{if(!A||!E||L.length===0)return;(async()=>{try{a(!0);const I=`cached_products_${A.id}`,X=localStorage.getItem(I);if(X)try{const{data:ae,timestamp:me,orgIds:ue}=JSON.parse(X),xe=Date.now()-me<5*60*1e3,ze=JSON.stringify(ue.sort())===JSON.stringify([...L].sort());if(xe&&ze&&Array.isArray(ae)&&ae.length>0){g(ae),o(ae),a(!1),Z(!1);return}}catch(ae){console.warn("Erro ao ler cache de produtos:",ae)}await Z(!0)}catch(I){console.error("Erro ao buscar produtos:",I),a(!1)}})()},[A,L,E]);const q=V=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(V/100),ee=()=>{T("")},J=()=>{i(""),T(""),f({min:0,max:N})};s.useEffect(()=>{if(t.length>0){const V=Math.max(...t.map(I=>I.price));r(Math.ceil(V*1.1))}},[t]),s.useEffect(()=>{let V=t;if(m){const I=m.toLowerCase();V=V.filter(X=>{var ae;return X.name.toLowerCase().includes(I)||X.description.toLowerCase().includes(I)||((ae=X.organization)==null?void 0:ae.name)&&X.organization.name.toLowerCase().includes(I)})}U&&(V=V.filter(I=>I.organization_id===U)),V=V.filter(I=>I.price>=l.min&&(l.max===null||I.price<=l.max)),o(V)},[m,U,l,t]);const W=V=>{g(I=>[V,...I]),o(I=>[V,...I])},d=V=>{v(V),O(!0)},Y=V=>{const I=t.map(X=>X.id===V.id?V:X);g(I),o(I),setTimeout(()=>{localStorage.removeItem(`cached_products_${A==null?void 0:A.id}`),Z(!1)},300)},Q=V=>{v(V),$(!0)},re=async()=>{if(F)try{P(!0);const{error:V}=await C.from("products").delete().eq("id",F.id);if(V)throw V;const I=t.filter(X=>X.id!==F.id);g(I),o(I),$(!1),v(null),localStorage.removeItem(`cached_products_${A==null?void 0:A.id}`),Z(!1)}catch(V){console.error("Erro ao excluir produto:",V)}finally{P(!1)}},oe=!!(x!=null&&x.openpix_pix_key),de=(x==null?void 0:x.role)==="tecnico"||(x==null?void 0:x.role)==="admin",[K,te]=s.useState("store");return e.jsx(Ne,{activeTab:K,setActiveTab:te,children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4 md:mb-0",children:[e.jsx(qe,{className:"mr-2 text-green-500",size:24}),e.jsx("h1",{className:"text-2xl font-bold",children:"Minha Loja"})]}),de&&e.jsxs("button",{onClick:()=>{if((x==null?void 0:x.role)==="tecnico"&&!oe){_(!0);return}h(!0)},className:"flex items-center bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md transition-colors",children:[e.jsx(Pe,{size:20,className:"mr-2"}),"Adicionar Produto"]})]}),(x==null?void 0:x.role)==="tecnico"&&!oe&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($s,{size:20,className:"text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-900 mb-1",children:"Configure sua chave Pix para receber pagamentos"}),e.jsx("p",{className:"text-sm text-yellow-700 mb-3",children:"Você precisa cadastrar uma chave Pix para poder adicionar produtos e receber pagamentos das vendas."}),e.jsxs("button",{onClick:()=>b("/conta?tab=payment"),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-yellow-900 bg-yellow-100 border border-yellow-300 rounded-md hover:bg-yellow-200 transition-colors",children:[e.jsx(hs,{size:16,className:"mr-2"}),"Configurar Chave Pix"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"Buscar produtos...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",value:m,onChange:V=>i(V.target.value)}),e.jsx(Le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("button",{className:`flex items-center justify-center px-4 py-2 border ${j?"border-green-500 bg-green-50":"border-gray-300"} rounded-md hover:bg-gray-50`,onClick:()=>k(!j),children:[e.jsx(Ts,{size:20,className:`mr-2 ${j?"text-green-500":"text-gray-500"}`}),e.jsx("span",{children:"Filtros"})]})]}),j&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium",children:"Filtros"}),e.jsx("button",{onClick:J,className:"text-sm text-green-600 hover:text-green-800",children:"Limpar filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Faixa de Preço"}),e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:q(l.min)}),e.jsx("span",{className:"text-sm text-gray-600",children:q(l.max||N)})]}),e.jsx("input",{type:"range",min:0,max:N,value:l.min,onChange:V=>f({...l,min:Number(V.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsx("input",{type:"range",min:0,max:N,value:l.max||N,onChange:V=>f({...l,max:Number(V.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mt-4"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Organizações"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:U,onChange:V=>T(V.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none",children:[e.jsx("option",{value:"",children:"Todas as organizações"}),L.length>0&&t.length>0?[...new Set(t.map(V=>V.organization_id))].map(V=>{var X;const I=(X=t.find(ae=>ae.organization_id===V))==null?void 0:X.organization;return I?e.jsx("option",{value:V,children:I.name},V):null}):e.jsx("option",{value:"",disabled:!0,children:"Nenhuma organização encontrada"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-2",children:"Filtros ativos:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[U&&e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx("span",{children:((se=(H=t.find(V=>V.organization_id===U))==null?void 0:H.organization)==null?void 0:se.name)||"Organização"}),e.jsx("button",{onClick:ee,className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(le,{size:12})})]}),(l.min>0||l.max!==null&&l.max<N)&&e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsxs("span",{children:["Preço: ",q(l.min)," - ",q(l.max||N)]}),e.jsx("button",{onClick:()=>f({min:0,max:N}),className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(le,{size:12})})]})]})]})]})]}),p?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array(8).fill(0).map((V,I)=>e.jsx(Xs,{},I))}):c.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:c.map(V=>e.jsx(Ys,{product:V,isCoach:de,onEdit:d,onDelete:Q},V.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[e.jsx(qe,{size:48,className:"text-gray-300 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-500 max-w-md",children:m?"Nenhum produto corresponde à sua busca. Tente outros termos.":L.length===0?"Você não tem acesso a nenhuma organização. Crie uma equipe ou peça para ser adicionado a uma equipe existente.":"Não há produtos disponíveis no momento."})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Chave Pix necessária"}),e.jsx("p",{className:"mb-6",children:"Você precisa cadastrar uma chave Pix para receber pagamentos antes de criar seus produtos."}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 border border-gray-300 rounded-lg mr-2 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:()=>b("/conta?tab=payment"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Cadastrar Chave"})]})]})})}),e.jsx(ds,{isOpen:R,onClose:()=>M(!1)}),e.jsx(Kt,{isOpen:z,onClose:()=>h(!1),onProductAdded:W}),F&&e.jsx(sa,{isOpen:u,onClose:()=>O(!1),onProductUpdated:Y,product:F}),e.jsx(ms,{isOpen:y,title:"Excluir Produto",message:`Tem certeza que deseja excluir o produto "${(F==null?void 0:F.name)||""}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir",cancelText:"Cancelar",onConfirm:re,onCancel:()=>$(!1),isLoading:D})]})})},aa=({isOpen:t,onClose:g,cartItems:c,onCheckout:o,isProcessing:p=!1,updateQuantity:a,removeItem:m})=>{const i=c.reduce((h,u)=>h+u.price*u.quantity,0),z=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).format(h/100);return e.jsx("div",{className:`fixed top-0 right-0 h-full w-full md:w-96 bg-white shadow-lg z-50 transform transition-transform duration-300 ${t?"translate-x-0":"translate-x-full"}`,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"mr-2 text-green-600",size:24}),e.jsx("h2",{className:"text-xl font-semibold",children:"Carrinho"})]}),e.jsx("button",{onClick:g,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(le,{size:24})})]}),e.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(We,{size:48,className:"text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Seu carrinho está vazio"}),e.jsx("p",{className:"text-gray-500",children:"Adicione produtos ao carrinho para vê-los aqui."})]}):e.jsx("div",{className:"space-y-4",children:c.map(h=>e.jsxs("div",{className:"flex border rounded-lg p-3 relative",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-md overflow-hidden flex-shrink-0",children:h.image_url?e.jsx("img",{src:h.image_url,alt:h.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200",children:e.jsx(We,{size:24,className:"text-gray-400"})})}),e.jsxs("div",{className:"ml-3 flex-grow",children:[e.jsx("h4",{className:"font-medium text-sm",children:h.name}),h.organization_name&&e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:h.organization_name}),e.jsx("p",{className:"font-semibold text-green-600",children:z(h.price)}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("button",{onClick:()=>a(h.id,Math.max(1,h.quantity-1)),className:"w-8 h-8 flex items-center justify-center border rounded-l-md",disabled:h.quantity<=1,children:"-"}),e.jsx("span",{className:"w-10 h-8 flex items-center justify-center border-t border-b",children:h.quantity}),e.jsx("button",{onClick:()=>a(h.id,h.quantity+1),className:"w-8 h-8 flex items-center justify-center border rounded-r-md",children:"+"}),e.jsx("button",{onClick:()=>m(h.id),className:"ml-auto p-1 text-gray-400 hover:text-red-500",title:"Remover item",children:e.jsx(Ae,{size:18})})]})]})]},h.id))})}),e.jsxs("div",{className:"border-t p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsx("span",{className:"font-bold text-lg",children:z(i)})]}),e.jsxs("button",{className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white py-3 rounded-md font-medium flex items-center justify-center gap-2",onClick:o,disabled:p||c.length===0,children:[p&&e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),p?"Processando...":"Finalizar Compra"]})]})]})})},Qs=async t=>{const{data:g,error:c}=await C.from("order_items").select("id, order_id, product_id, quantity, price, product:products(id,name,image_url)").eq("order_id",t);if(c)throw c;return g},ra=async(t,g)=>{const c=g.reduce((i,z)=>i+z.price*z.quantity,0),{data:o,error:p}=await C.from("orders").insert({user_id:t,total:c,status:"Aguardando Pagamento"}).select("*").single();if(p)throw p;const a=g.map(i=>({order_id:o.id,product_id:i.id,quantity:i.quantity,price:i.price})),{error:m}=await C.from("order_items").insert(a);if(m)throw console.error("Erro ao inserir itens do pedido, pedido criado: ",o.id),m;return o},oa=async t=>{const{data:g,error:c}=await C.from("orders").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(c)throw c;return g},na=async t=>{if(!t)return[];const{data:g,error:c}=await C.from("sports_organizations").select("id").eq("created_by",t);if(c)throw c;if(!g||g.length===0)return[];const o=g.map(y=>y.id),{data:p,error:a}=await C.from("products").select("id").in("organization_id",o);if(a)throw a;const m=(p||[]).map(y=>y.id);if(m.length===0)return[];const{data:i,error:z}=await C.from("order_items").select("order_id").in("product_id",m);if(z)throw z;const h=Array.from(new Set((i||[]).map(y=>y.order_id)));if(h.length===0)return[];const{data:u,error:O}=await C.from("orders").select("*").in("id",h).order("created_at",{ascending:!1});if(O)throw O;return u},la=async(t,g)=>{const{error:c}=await C.from("orders").update({id_transacao:g}).eq("id",t);if(c)throw c},ia=async(t,g)=>{const{error:c}=await C.from("orders").update({status:g}).eq("id",t);if(c)throw c},Xe="https://api.woovi-sandbox.com/api/v1",ca="Q2xpZW50X0lkXzQ5YmRhYTBiLTMxMzItNGNlOS1iZmIzLTU2ODMxYTg1ZWE4NjpDbGllbnRfU2VjcmV0X2FLZjN4MjcvV0t1NFE0Q2d4R3ZLcmVaTk9rbEtqenV3R211Vnl0bTRzNjA9";console.log("[OpenPix Config] VITE_OPENPIX_BASE_URL:","https://api.woovi-sandbox.com/api/v1");console.log("[OpenPix Config] OPENPIX_BASE_URL final:",Xe);console.log("[OpenPix Config] VITE_OPENPIX_APP_ID:","DEFINIDO");console.log("[OpenPix Config] APP_ID final:","DEFINIDO");const os={Accept:"application/json","Content-Type":"application/json",Authorization:ca},da=t=>t&&t.trim(),ma=async t=>{console.log("[createSubAccount] Iniciando criação de subconta"),console.log("[createSubAccount] URL:",`${Xe}/subaccount`),console.log("[createSubAccount] Headers:",os),console.log("[createSubAccount] Params enviados:",JSON.stringify(t,null,2));const g=await fetch(`${Xe}/subaccount`,{method:"POST",headers:os,body:JSON.stringify(t)});console.log("[createSubAccount] Status da resposta:",g.status),console.log("[createSubAccount] Headers da resposta:",Object.fromEntries(g.headers.entries()));const c=await g.text();if(console.log("[createSubAccount] Resposta completa (texto):",c),!g.ok){console.error("[createSubAccount] Erro na criação:",g.status,c);let p=c;try{const a=JSON.parse(c);a.error?p=a.error:a.message&&(p=a.message)}catch{}throw new Error(`Falha ao criar subconta: ${g.status} - ${p}`)}let o;try{o=JSON.parse(c),console.log("[createSubAccount] Resposta JSON:",JSON.stringify(o,null,2))}catch(p){throw console.error("[createSubAccount] Erro ao fazer parse do JSON:",p),console.error("[createSubAccount] Texto da resposta:",c),new Error(`Resposta inválida da API: ${c}`)}if(!o||Object.keys(o).length===0)throw console.error("[createSubAccount] Resposta vazia da API"),new Error("Falha ao cadastrar a chave, Tente novamente mais tarde. Isso pode ser por conta de que já houve registro dessa chave mais de uma vez");if(!o.subAccount)throw console.error("[createSubAccount] Resposta não contém subAccount:",o),new Error("Falha ao cadastrar a chave, Tente novamente mais tarde. Isso pode ser por conta de que já houve registro dessa chave mais de uma vez");return o},ua=async(t,g,c="EMAIL")=>{const o=da(g);console.log(`[manageUserSubAccount] Usuário: ${t}`),console.log(`[manageUserSubAccount] Chave Pix original: ${g}, normalizada: ${o}`),console.log(`[manageUserSubAccount] Tipo da chave: ${c}`);try{return console.log(`[manageUserSubAccount] Criando nova subconta para usuário: ${t}`),await ma({name:t,pixKey:o})}catch(p){throw console.error("[manageUserSubAccount] Erro ao criar subconta:",p),p}},xa=async t=>{const g=t.splits.reduce((p,a)=>p+a.value,0);if(g>t.value)throw new Error(`Soma dos splits (${g}) maior que o valor total (${t.value}).`);const c={value:t.value,correlationID:t.correlationID,splits:t.splits,...t.additionalInfo?{additionalInfo:t.additionalInfo}:{}},o=await fetch(`${Xe}/charge`,{method:"POST",headers:os,body:JSON.stringify(c)});if(!o.ok){const p=await o.text();throw new Error(`Falha ao criar cobrança: ${o.status} - ${p}`)}return await o.json()},Zs=async t=>{const g=await fetch(`${Xe}/charge/${t}`,{method:"GET",headers:os});if(!g.ok){const c=await g.text();throw new Error(`Falha ao buscar cobrança: ${g.status} - ${c}`)}return await g.json()},Ks=async t=>await Zs(t),ga=()=>{var de;const[t,g]=s.useState(!1),c=he(),[o,p]=s.useState(!1),[a,m]=s.useState(null),[i,z]=s.useState(null),[h,u]=s.useState(null),[O,y]=s.useState(0);s.useEffect(()=>{if(!h)return;const K=()=>{const H=Math.floor((h.getTime()-Date.now())/1e3);y(H>0?H:0)};K();const te=setInterval(K,1e3);return()=>clearInterval(te)},[h]);const $=async()=>{var te,H;if(!Z)return;const K=await ve(Z.id,!0);if(!K){alert("Perfil não encontrado, não foi possível finalizar o pedido");return}try{B(!0);const se=await ra(K.id,A),V="69362c8a-b74e-4d01-ad99-6195e4b9ed84",I=A.reduce((ue,xe)=>ue+xe.price*xe.quantity,0),X=Math.round(I*.15),ae=I-X,me=K.openpix_pix_key;me||console.error("Usuário sem chave Pix para split");try{const ue=await xa({value:I,correlationID:xt(),splits:[{pixKey:me||V,value:ae,splitType:"SPLIT_SUB_ACCOUNT"}]});try{const xe=((te=ue==null?void 0:ue.charge)==null?void 0:te.transactionID)||((H=ue==null?void 0:ue.charge)==null?void 0:H.identifier);xe&&await la(se.id,xe)}catch(xe){console.error("Falha ao salvar id_transacao",xe)}m(ue.charge.qrCodeImage||null),z(I/100),u(new Date(ue.charge.expiresDate))}catch(ue){console.error("Erro ao criar cobrança Pix",ue)}b([]),S(!1),p(!0)}catch(se){console.error("Erro no checkout",se),alert("Erro ao finalizar o pedido")}finally{B(!1)}},[w,_]=s.useState([]),[R,M]=s.useState([]),[F,v]=s.useState(!0),[D,P]=s.useState(""),[x,n]=s.useState([]),[l,f]=s.useState([]),[N,r]=s.useState({min:0,max:null}),[j,k]=s.useState(1e3),[U,T]=s.useState(!1),[A,b]=s.useState([]),[L,S]=s.useState(!1),[E,B]=s.useState(!1),{user:Z}=ce();s.useEffect(()=>{(async()=>{try{const{data:te,error:H}=await C.from("sports_organizations").select("id, name").order("name");if(H)throw H;te&&n(te)}catch(te){console.error("Erro ao buscar organizações:",te)}})()},[]),s.useEffect(()=>{(async()=>{try{v(!0);const{data:te,error:H}=await C.from("products").select(`
            id,
            name,
            description,
            image_url,
            price,
            stock,
            status,
            organization_id,
            organization:organization_id (
              name,
              logo_url
            )
          `).eq("status",!0).order("created_at",{ascending:!1});if(H)throw H;if(te){const se=te;if(_(se),M(se),se.length>0){const V=Math.max(...se.map(I=>I.price));k(Math.ceil(V/100)*100),r({min:0,max:V})}}}catch(te){console.error("Erro ao buscar produtos:",te)}finally{v(!1)}})()},[]),s.useEffect(()=>{let K=[...w];D&&(K=K.filter(te=>{var H;return te.name.toLowerCase().includes(D.toLowerCase())||te.description.toLowerCase().includes(D.toLowerCase())||((H=te.organization)==null?void 0:H.name)&&te.organization.name.toLowerCase().includes(D.toLowerCase())})),l.length>0&&(K=K.filter(te=>l.includes(te.organization_id))),K=K.filter(te=>te.price>=N.min&&(N.max===null||te.price<=N.max)),M(K)},[D,l,N,w]);const q=K=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(K),ee=()=>{f([])},J=()=>{P(""),f([]),r({min:0,max:j})},W=K=>{var H;const te=A.find(se=>se.id===K.id);if(te)d(K.id,te.quantity+1);else{const se={id:K.id,name:K.name,price:K.price,image_url:K.image_url,quantity:1,organization_name:(H=K.organization)==null?void 0:H.name};b([...A,se])}S(!0)},d=(K,te)=>{b(H=>H.map(se=>se.id===K?{...se,quantity:te}:se))},Y=K=>{b(te=>te.filter(H=>H.id!==K))},[Q,re]=s.useState("storeOnline"),oe=A.reduce((K,te)=>K+te.quantity,0);return e.jsxs(Ne,{activeTab:Q,setActiveTab:re,children:[o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-sm text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Pedido realizado com sucesso!"}),i!==null&&e.jsxs("p",{className:"font-medium mb-2",children:["Pague ",q(i)," via Pix"]}),a?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:a.startsWith("http")?a:`data:image/png;base64,${a}`,alt:"QR Code Pix",className:"mx-auto w-48 h-48 mb-4 border-4 border-green-500 rounded-lg"}),e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Prazo de Pagamento"}),O>0?(()=>{const K=Math.floor(O/3600),te=Math.floor(O%3600/60),H=O%60;return e.jsx("p",{className:"font-semibold",children:`${K.toString().padStart(2,"0")}:${te.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`})})():e.jsx("p",{className:"font-semibold text-red-500",children:"Expirado"}),h&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Expira em: ",h.toLocaleString("pt-BR")]})]})]}):e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Escaneie o QR Code para pagar."}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{p(!1),c("/meus-pedidos")},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Ver Pedidos"}),e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition-colors",children:"Fechar"})]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8 relative",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4 md:mb-0",children:[e.jsx(qe,{className:"mr-2 text-green-500",size:24}),e.jsx("h1",{className:"text-2xl font-bold",children:"Loja Online"})]}),e.jsxs("button",{onClick:()=>S(!0),className:"relative flex items-center bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md transition-colors",children:[e.jsx(We,{size:20,className:"mr-2"}),e.jsx("span",{children:"Carrinho"}),oe>0&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:oe})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"Buscar produtos...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",value:D,onChange:K=>P(K.target.value)}),e.jsx(Le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("button",{className:`flex items-center justify-center px-4 py-2 border ${U?"border-green-500 bg-green-50":"border-gray-300"} rounded-md hover:bg-gray-50`,onClick:()=>T(!U),children:[e.jsx(Ts,{size:20,className:`mr-2 ${U?"text-green-500":"text-gray-500"}`}),e.jsx("span",{children:"Filtros"})]})]}),U&&e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-medium",children:"Filtros"}),e.jsx("button",{onClick:J,className:"text-sm text-green-600 hover:text-green-800",children:"Limpar filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Faixa de Preço"}),e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:q(N.min)}),e.jsx("span",{className:"text-sm text-gray-600",children:q(N.max||j)})]}),e.jsx("input",{type:"range",min:0,max:j,value:N.min,onChange:K=>r(te=>({...te,min:Number(K.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsx("input",{type:"range",min:0,max:j,value:N.max||j,onChange:K=>r(te=>({...te,max:Number(K.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mt-2"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Organizações"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:l.length>0?l[0]:"",onChange:K=>{K.target.value?f([K.target.value]):f([])},className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none",children:[e.jsx("option",{value:"",children:"Todas as organizações"}),x.length>0?x.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id)):e.jsx("option",{value:"",disabled:!0,children:"Nenhuma organização encontrada"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]})]})]}),(l.length>0||N.min>0||N.max!==null&&N.max<j)&&e.jsxs("div",{className:"mt-4 pt-3 border-t",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Filtros aplicados:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.length>0&&e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsx("span",{children:((de=x.find(K=>K.id===l[0]))==null?void 0:de.name)||"Organização"}),e.jsx("button",{onClick:ee,className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(le,{size:12})})]}),(N.min>0||N.max!==null&&N.max<j)&&e.jsxs("div",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full flex items-center",children:[e.jsxs("span",{children:["Preço: ",q(N.min)," - ",q(N.max||j)]}),e.jsx("button",{onClick:()=>r({min:0,max:j}),className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(le,{size:12})})]})]})]})]})]}),e.jsxs("div",{className:"mb-6 flex items-center gap-2 bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M12 20a8 8 0 100-16 8 8 0 000 16z"})}),e.jsxs("span",{className:"text-yellow-800 text-sm font-medium",children:["Para produtos físicos, certifique-se de que cadastrou seu endereço no seu"," ",e.jsx("button",{type:"button",className:"underline text-green-700 hover:text-green-900 focus:outline-none",onClick:()=>g(!0),children:"Perfil"}),"."]})]}),F?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array(8).fill(0).map((K,te)=>e.jsx(Xs,{},te))}):R.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:R.map(K=>e.jsx(Ys,{product:K,isCoach:!1,onAddToCart:W},K.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[e.jsx(qe,{size:48,className:"text-gray-300 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-500 max-w-md",children:D||l.length>0||N.min>0||N.max!==null&&N.max<j?"Nenhum produto corresponde aos filtros aplicados. Tente outros filtros.":"Não há produtos disponíveis no momento."})]}),e.jsx(aa,{isOpen:L,onClose:()=>S(!1),cartItems:A,updateQuantity:d,removeItem:Y,onCheckout:$,isProcessing:E}),e.jsx(ds,{isOpen:t,onClose:()=>g(!1)}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>S(!1)})]})]})},ha=()=>{var Z,q,ee;const{user:t}=ce(),[g,c]=s.useState([]),[o,p]=s.useState(null),[a,m]=s.useState(!1),[i,z]=s.useState("orders"),[h,u]=s.useState(null),[O,y]=s.useState(""),[$,w]=s.useState([]),[_,R]=s.useState(!1),[M,F]=s.useState(!1),[v,D]=s.useState(null),[P,x]=s.useState(null),[n,l]=s.useState(null),[f,N]=s.useState("details"),[r,j]=s.useState(null),[k,U]=s.useState(!1),[T,A]=s.useState(null),[b,L]=s.useState(!1),S=J=>{switch(J==null?void 0:J.toUpperCase()){case"ACTIVE":return{label:"Pendente",color:"text-yellow-600 bg-yellow-100"};case"COMPLETED":return{label:"Pago",color:"text-green-600 bg-green-100"};case"EXPIRED":return{label:"Expirado",color:"text-red-600 bg-red-100"};default:return{label:J||"Desconhecido",color:"text-gray-600 bg-gray-100"}}};s.useEffect(()=>{(async()=>{if(t)try{m(!0);let W=o;if(!W){const Y=await ve(t.id,!0);if(!Y){console.error("Perfil não encontrado");return}W=Y.id,p(W)}if(!W)return;const d=await oa(W);c(d)}catch(W){console.error("Erro ao buscar pedidos",W)}finally{m(!1)}})()},[t,o]);const E=J=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(J/100),B=async J=>{if(l(J),!J.id_transacao){alert("ID da transação não encontrado para este pedido.");return}x(J.id);try{const W=await Zs(J.id_transacao);D(W),F(!0)}catch(W){console.error("Erro ao buscar dados da cobrança:",W),alert("Erro ao carregar dados do pagamento. Tente novamente.")}finally{x(null)}};return e.jsx(Ne,{activeTab:i,setActiveTab:z,children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(qe,{className:"mr-2"}),"Meus Pedidos"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Pesquisar pedidos...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",value:O,onChange:J=>y(J.target.value)})]})]}),a?e.jsx("div",{className:"space-y-4",children:Array.from({length:4}).map((J,W)=>e.jsx("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/4"}),e.jsx("div",{className:"h-6 bg-gray-300 rounded w-1/2"})]})},W))}):g.length===0?e.jsxs("div",{className:"flex flex-col items-center text-gray-500 mt-20",children:[e.jsx(qe,{size:48,className:"mb-4"}),e.jsx("p",{children:"Você ainda não realizou nenhum pedido."})]}):e.jsx("div",{className:"space-y-4",children:g.filter(J=>{if(O.trim()==="")return!0;const W=O.toLowerCase();return J.id.toLowerCase().includes(W)||J.status.toLowerCase().includes(W)}).map(J=>e.jsxs("div",{onClick:async()=>{u(J),N("details"),R(!0),j(null),A(null);try{const W=await Qs(J.id);if(w(W),J.id_transacao){U(!0);try{const d=await Ks(J.id_transacao);j(d)}catch(d){console.error("Erro ao buscar status do pagamento:",d)}finally{U(!1)}}L(!0);try{const{data:d,error:Y}=await C.from("users").select("rua, bairro, cidade, estado, cep, numero, complemento").eq("id",J.user_id).single();Y?console.error("Erro ao buscar endereço:",Y):A(d)}catch(d){console.error("Erro ao buscar endereço:",d)}finally{L(!1)}}catch(W){console.error(W)}finally{R(!1)}},className:"border rounded-lg p-4 bg-white shadow-sm cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-medium",children:["Pedido #",J.id.slice(0,8)]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(J.created_at).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-green-600 font-semibold",children:E(J.total)}),e.jsx("span",{className:`text-sm capitalize ${["Aguardando Pagamento","Processando"].includes(J.status)?"text-yellow-500":["Pagamento Confirmado","Confirmado","Finalizado"].includes(J.status)?"text-green-600":""}`,children:J.status})]}),J.id_transacao&&(J.status==="Aguardando Pagamento"?e.jsxs("button",{onClick:W=>{W.stopPropagation(),B(J)},disabled:P===J.id,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg flex items-center gap-2 text-sm transition-colors",children:[e.jsx(Fe,{size:16}),P===J.id?"Carregando...":"PAGAR"]}):e.jsxs("div",{className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 text-sm",children:[e.jsx(Fe,{size:16}),"PAGO"]}))]})]},J.id))}),h&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Detalhes do Pedido #",h.id.slice(0,8)]}),e.jsx("button",{onClick:()=>{u(null),w([]),j(null),A(null),N("details")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{size:24})})]}),e.jsx("div",{className:"border-b",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsxs("button",{onClick:()=>N("details"),className:`py-4 px-1 border-b-2 font-medium text-sm ${f==="details"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Is,{className:"inline-block w-4 h-4 mr-2"}),"Detalhes do Pedido"]}),e.jsxs("button",{onClick:()=>N("payment"),className:`py-4 px-1 border-b-2 font-medium text-sm ${f==="payment"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Fe,{className:"inline-block w-4 h-4 mr-2"}),"Status do Pagamento"]}),e.jsxs("button",{onClick:()=>N("address"),className:`py-4 px-1 border-b-2 font-medium text-sm ${f==="address"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ce,{className:"inline-block w-4 h-4 mr-2"}),"Endereço de Entrega"]})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:[f==="details"&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Data do Pedido:"}),e.jsx("p",{className:"font-medium",children:new Date(h.created_at).toLocaleString("pt-BR")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx("p",{className:`font-medium ${["Pagamento Confirmado","Confirmado","Finalizado"].includes(h.status)?"text-green-600":["Aguardando Pagamento","Processando"].includes(h.status)?"text-yellow-600":"text-red-600"}`,children:h.status})]})]}),e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Itens do Pedido"}),_?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando itens..."})]}):$.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum item encontrado."}):e.jsxs("div",{className:"space-y-3",children:[$.map(J=>{var W;return e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:((W=J.product)==null?void 0:W.name)||`Produto ${J.product_id}`}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantidade: ",J.quantity]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:E(J.price)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Unitário"})]})]},J.id)}),e.jsx("div",{className:"border-t pt-3 mt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"text-green-600",children:E(h.total)})]})})]})]}),f==="payment"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Status do Pagamento"}),k?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando status..."})]}):h.id_transacao?r?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ID da Transação:"}),e.jsx("p",{className:"font-medium",children:h.id_transacao})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status do Pagamento:"}),e.jsxs("div",{className:"mt-1",children:[(()=>{var W;const J=S((W=r.charge)==null?void 0:W.status);return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J.color}`,children:J.label})})(),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Status técnico: ",((Z=r.charge)==null?void 0:Z.status)||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Valor:"}),e.jsx("p",{className:"font-medium",children:E(((q=r.charge)==null?void 0:q.value)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Data de Expiração:"}),e.jsx("p",{className:"font-medium",children:(ee=r.charge)!=null&&ee.expiresDate?new Date(r.charge.expiresDate).toLocaleDateString("pt-BR"):"N/A"})]})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Não foi possível carregar o status do pagamento."})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma transação associada a este pedido."})]})]}),f==="address"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Endereço de Entrega"}),b?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando endereço..."})]}):T&&(T.rua||T.bairro||T.cidade)?e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Endereço Completo:"})]}),e.jsxs("div",{className:"ml-6",children:[e.jsx("p",{className:"font-medium",children:(()=>{const J=[];return T.rua&&J.push(`${T.rua}${T.numero?`, ${T.numero}`:""}`),T.bairro&&J.push(T.bairro),T.cidade&&J.push(`${T.cidade}${T.estado?`/${T.estado}`:""}`),T.cep&&J.push(`CEP: ${T.cep}`),J.join(" - ")})()}),T.complemento&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Complemento: ",T.complemento]})]})]})})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ce,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Endereço de entrega não disponível."})]})]})]})]})}),M&&v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{className:"absolute top-2 right-2",onClick:()=>{F(!1),D(null),l(null)},children:e.jsx(le,{size:18})}),e.jsx("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Pagamento PIX"}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:E(v.charge.value)}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["ID da Transação: ",(n==null?void 0:n.id_transacao)||v.charge.id]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["Expira em: ",new Date(v.charge.expiresDate).toLocaleString("pt-BR")]}),e.jsx("div",{className:"mt-2",children:(()=>{const J=S(v.charge.status);return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J.color}`,children:J.label})})()})]}),v.charge.status==="EXPIRED"?e.jsx("div",{className:"text-center text-red-600 font-semibold mb-4",children:"Pagamento expirado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:v.charge.qrCodeImage,alt:"QR Code PIX",className:"w-48 h-48 border border-gray-300 rounded"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Código PIX (Copiar e Colar):"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{readOnly:!0,value:v.charge.brCode,className:"w-full p-2 border border-gray-300 rounded text-xs font-mono resize-none",rows:3}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(v.charge.brCode),alert("Código PIX copiado!")},className:"absolute top-2 right-2 bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs",children:"Copiar"})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Escaneie o QR Code ou copie e cole o código PIX no seu banco"})]})})]})})},pa=()=>{var b,L,S;const{user:t}=ce(),[g,c]=s.useState([]),[o,p]=s.useState(!1),[a,m]=s.useState("sales"),[i,z]=s.useState(null),[h,u]=s.useState(""),[O,y]=s.useState([]),[$,w]=s.useState("details"),[_,R]=s.useState(null),[M,F]=s.useState(null),[v,D]=s.useState(!1),[P,x]=s.useState(!1),n=E=>{switch(E==null?void 0:E.toUpperCase()){case"ACTIVE":return{label:"Pendente",color:"text-yellow-600 bg-yellow-100"};case"COMPLETED":return{label:"Pago",color:"text-green-600 bg-green-100"};case"EXPIRED":return{label:"Expirado",color:"text-red-600 bg-red-100"};default:return{label:E||"Desconhecido",color:"text-gray-600 bg-gray-100"}}},l=g.filter(E=>["Pagamento Confirmado","Processando","Finalizado","Confirmado"].includes(E.status)).reduce((E,B)=>E+B.total,0),f=g.filter(E=>E.status==="Aguardando Pagamento").reduce((E,B)=>E+B.total,0),N=Math.round(l*.9),[r,j]=s.useState(!1),[k,U]=s.useState(null),T=async(E,B)=>{try{U(E),await ia(E,B),c(Z=>Z.map(q=>q.id===E?{...q,status:B}:q))}catch(Z){console.error("Erro ao atualizar status",Z)}finally{U(null)}};s.useEffect(()=>{(async()=>{if(t)try{p(!0);const B=await na(t.id);c(B)}catch(B){console.error("Erro ao buscar vendas",B)}finally{p(!1)}})()},[t]);const A=E=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(E/100);return e.jsx(Ne,{activeTab:a,setActiveTab:m,children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-4 md:mb-0",children:[e.jsx(Ue,{className:"mr-2"}),"Minhas Vendas"]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Pesquisar vendas...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",value:h,onChange:E=>u(E.target.value)})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-100 border border-green-300 rounded-lg p-4 flex items-center",children:[e.jsx(Ue,{className:"mr-3 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total de Vendas (Confirmado)"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:A(l)})]})]}),e.jsxs("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-4 flex items-center",children:[e.jsx(Ue,{className:"mr-3 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Recebido"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:A(N)})]})]}),e.jsxs("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-4 flex items-center",children:[e.jsx(Ue,{className:"mr-3 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aguardando Pagamento"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:A(f)})]})]})]}),o?e.jsx("div",{className:"space-y-4",children:Array.from({length:4}).map((E,B)=>e.jsx("div",{className:"border rounded-lg p-4 bg-white shadow-sm",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/4"}),e.jsx("div",{className:"h-6 bg-gray-300 rounded w-1/2"})]})},B))}):g.length===0?e.jsxs("div",{className:"flex flex-col items-center text-gray-500 mt-20",children:[e.jsx(Ue,{size:48,className:"mb-4"}),e.jsx("p",{children:"Você ainda não realizou nenhuma venda."})]}):e.jsx("div",{className:"space-y-4",children:g.filter(E=>{if(h.trim()==="")return!0;const B=h.toLowerCase();return E.id.toLowerCase().includes(B)||E.status.toLowerCase().includes(B)}).map(E=>e.jsxs("div",{onClick:async()=>{z(E),w("details"),j(!0),R(null),F(null);try{const B=await Qs(E.id);y(B),D(!0);const{data:Z,error:q}=await C.from("users").select("id, name, email, phone, rua, bairro, cidade, estado, cep, numero, complemento").eq("id",E.user_id).single();if(!q&&Z&&R(Z),D(!1),E.id_transacao){x(!0);try{const ee=await Ks(E.id_transacao);F(ee)}catch(ee){console.error("Erro ao buscar status do pagamento:",ee)}x(!1)}}catch(B){console.error(B)}finally{j(!1)}},className:"border rounded-lg p-4 bg-white shadow-sm cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-medium",children:["Pedido #",E.id.slice(0,8)]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(E.created_at).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-green-600 font-semibold",children:A(E.total)}),e.jsxs("select",{className:"border border-gray-300 rounded px-2 py-1 text-sm capitalize focus:outline-none",value:E.status,onClick:B=>B.stopPropagation(),onChange:B=>{B.stopPropagation(),T(E.id,B.target.value)},disabled:k===E.id,children:[e.jsx("option",{value:"Aguardando Pagamento",children:"Aguardando Pagamento"}),e.jsx("option",{value:"Pagamento Confirmado",children:"Pagamento Confirmado"}),e.jsx("option",{value:"Processando",children:"Processando"}),e.jsx("option",{value:"Confirmado",children:"Confirmado"}),e.jsx("option",{value:"Finalizado",children:"Finalizado"})]})]})]},E.id))}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Pedido #",i.id.slice(0,8)]}),e.jsx("button",{onClick:()=>{z(null),y([]),R(null),F(null),w("details")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(le,{size:24})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex",children:[e.jsx("button",{onClick:()=>w("details"),className:`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${$==="details"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{size:18}),"Detalhes do Pedido"]})}),e.jsx("button",{onClick:()=>w("payment"),className:`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${$==="payment"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{size:18}),"Status do Pagamento"]})}),e.jsx("button",{onClick:()=>w("customer"),className:`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${$==="customer"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{size:18}),"Dados do Cliente"]})})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-96",children:[$==="details"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Informações do Pedido"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Data do Pedido:"}),e.jsx("p",{className:"font-medium",children:new Date(i.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx("p",{className:`font-medium ${i.status==="Finalizado"?"text-green-600":i.status==="Pagamento Confirmado"?"text-blue-600":i.status==="Aguardando Pagamento"?"text-yellow-600":"text-gray-600"}`,children:i.status})]})]})]}),e.jsx("h4",{className:"text-md font-medium mb-3",children:"Itens do Pedido"}),r?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando itens..."})]}):O.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum item encontrado."}):e.jsxs("div",{className:"space-y-3",children:[O.map(E=>{var B;return e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium",children:((B=E.product)==null?void 0:B.name)||`Produto ${E.product_id}`}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantidade: ",E.quantity]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:A(E.price)}),e.jsx("p",{className:"text-sm text-gray-600",children:"unitário"})]})]},E.id)}),e.jsx("div",{className:"border-t pt-3 mt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"text-green-600",children:A(i.total)})]})})]})]}),$==="payment"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Status do Pagamento"}),P?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando status..."})]}):i.id_transacao?M?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ID da Transação:"}),e.jsx("p",{className:"font-medium",children:i.id_transacao})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status do Pagamento:"}),e.jsxs("div",{className:"mt-1",children:[(()=>{var B;const E=n((B=M.charge)==null?void 0:B.status);return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.color}`,children:E.label})})(),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Status técnico: ",((b=M.charge)==null?void 0:b.status)||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Valor:"}),e.jsx("p",{className:"font-medium",children:A(((L=M.charge)==null?void 0:L.value)||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Data de Expiração:"}),e.jsx("p",{className:"font-medium",children:(S=M.charge)!=null&&S.expiresDate?new Date(M.charge.expiresDate).toLocaleDateString("pt-BR"):"N/A"})]})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Não foi possível carregar o status do pagamento."})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Fe,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma transação associada a este pedido."})]})]}),$==="customer"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Dados do Cliente"}),v?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2",children:"Carregando dados..."})]}):_?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{size:20,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Nome:"}),e.jsx("p",{className:"font-medium",children:_.name||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(As,{size:20,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email:"}),e.jsx("p",{className:"font-medium",children:_.email||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gt,{size:20,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Telefone:"}),e.jsx("p",{className:"font-medium",children:_.phone||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Endereço:"}),e.jsx("span",{className:"text-sm font-medium",children:_&&(_.rua||_.bairro||_.cidade)?(()=>{const E=[];return _.rua&&E.push(`${_.rua}${_.numero?`, ${_.numero}`:""}`),_.bairro&&E.push(_.bairro),_.cidade&&E.push(`${_.cidade}${_.estado?`/${_.estado}`:""}`),_.cep&&E.push(`CEP: ${_.cep}`),E.join(" - ")})():"N/A"})]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_e,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Não foi possível carregar os dados do cliente."})]})]})]})]})})]})})},fa=()=>{const[t]=ht(),[g,c]=s.useState("account"),{user:o}=ce(),[p,a]=s.useState(!0),[m,i]=s.useState(!1),[z,h]=s.useState(null),[u,O]=s.useState(null),[y,$]=s.useState({name:"",email:"",openpix_pix_key:"",openpix_pix_key_type:"EMAIL"});s.useEffect(()=>{const M=t.get("tab");M==="payment"?c("payment"):M==="account"&&c("account")},[t]),s.useEffect(()=>{(async()=>{if(o!=null&&o.id)try{a(!0);const F=await ve(o.id);F&&(O(F),$({name:F.name||"",email:F.email||"",openpix_pix_key:F.openpix_pix_key||"",openpix_pix_key_type:F.openpix_pix_key_type||"EMAIL"}))}catch(F){console.error("Erro ao carregar dados do usuário:",F),h({type:"error",text:"Erro ao carregar dados do usuário"})}finally{a(!1)}})()},[o]);const w=M=>{const{name:F,value:v}=M.target;$(D=>({...D,[F]:v}))},_=(M,F)=>{if(!M.trim())return!1;switch(F){case"EMAIL":return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(M);case"CPF":return M.replace(/\D/g,"").length===11;case"CNPJ":return M.replace(/\D/g,"").length===14;case"PHONE":const P=M.replace(/\D/g,"");return P.length>=10&&P.length<=13;case"RANDOM":return M.length>=32;default:return!1}},R=async M=>{if(M.preventDefault(),!(u!=null&&u.id)){h({type:"error",text:"Dados do usuário não encontrados"});return}if(u.role==="tecnico"&&y.openpix_pix_key&&!_(y.openpix_pix_key,y.openpix_pix_key_type)){h({type:"error",text:`Chave Pix inválida para o tipo ${y.openpix_pix_key_type}`});return}try{i(!0),h(null);const F={name:y.name};if(u.role==="tecnico"&&y.openpix_pix_key)try{console.log("[Conta] Iniciando criação de subconta OpenPix...");const P=await ua(u.id,y.openpix_pix_key,y.openpix_pix_key_type);console.log("[Conta] Subconta OpenPix criada com sucesso:",P),F.openpix_pix_key=y.openpix_pix_key,F.openpix_pix_key_type=y.openpix_pix_key_type}catch(P){console.error("[Conta] Erro ao gerenciar subconta OpenPix:",P);let x="Erro ao configurar chave Pix";if(P instanceof Error){const n=P.message;if(n.includes("Chave Pix Inválida")||n.includes("Invalid Pix Key"))x="Chave Pix inválida. Verifique o formato da chave.";else if(n.includes("Falha ao cadastrar a chave, Tente novamente mais tarde"))x="Falha ao cadastrar a chave, Tente novamente mais tarde. Isso pode ser por conta de que já houve registro dessa chave mais de uma vez";else if(n.includes("400"))if(n.includes("error"))try{const l=n.match(/\{"error":"([^"]+)"\}/);l&&l[1]&&(x=l[1])}catch{x="Dados inválidos para a chave Pix"}else x="Dados inválidos para a chave Pix";else n.includes("401")||n.includes("403")?x="Erro de autenticação com OpenPix. Verifique as configurações.":n.includes("500")?x="Erro interno do servidor OpenPix. Tente novamente mais tarde.":x=n}h({type:"error",text:`Erro na configuração de pagamento: ${x}`}),i(!1);return}if(!await vs(u.id,F))throw new Error("Não foi possível atualizar os dados");O(P=>({...P,...F}));const D=localStorage.getItem(`user_data_${o==null?void 0:o.id}`);if(D&&(o!=null&&o.id)){const x={...JSON.parse(D),...F,cacheTime:Date.now()};localStorage.setItem(`user_data_${o.id}`,JSON.stringify(x))}h({type:"success",text:"Dados atualizados com sucesso!"})}catch(F){console.error("Erro ao salvar:",F),h({type:"error",text:F instanceof Error?F.message:"Erro ao salvar dados"})}finally{i(!1)}};return p?e.jsx(Ne,{activeTab:g,setActiveTab:c,children:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})}):e.jsx(Ne,{activeTab:g,setActiveTab:c,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Minha Conta"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie suas informações pessoais e configurações de pagamento"})]}),z&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center gap-3 ${z.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[z.type==="success"?e.jsx(pt,{size:20}):e.jsx(ke,{size:20}),e.jsx("span",{children:z.text})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex",children:[e.jsx("button",{onClick:()=>c("account"),className:`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${g==="account"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{size:18}),"Informações Pessoais"]})}),(u==null?void 0:u.role)==="tecnico"&&e.jsx("button",{onClick:()=>c("payment"),className:`px-6 py-4 text-sm font-medium border-b-2 transition-colors ${g==="payment"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{size:18}),"Configurações de Pagamento"]})})]})}),e.jsxs("form",{onSubmit:R,className:"p-6",children:[g==="account"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informações Básicas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:y.name,onChange:w,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"Digite seu nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:y.email,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50 text-gray-500 cursor-not-allowed",placeholder:"Email não pode ser alterado"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"O email não pode ser alterado após o cadastro"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ke,{size:20,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Informações do Perfil"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[e.jsx("strong",{children:"Tipo de Usuário:"})," ",(u==null?void 0:u.role)==="tecnico"?"Técnico":(u==null?void 0:u.role)==="admin"?"Administrador":"Usuário"]}),(u==null?void 0:u.role)==="tecnico"&&e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:'Como técnico, você pode configurar suas informações de pagamento na aba "Configurações de Pagamento".'})]})]})})})]})}),g==="payment"&&(u==null?void 0:u.role)==="tecnico"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Configurações OpenPix"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure sua chave Pix para receber pagamentos das vendas em sua loja."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"openpix_pix_key_type",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo da Chave Pix *"}),e.jsxs("select",{id:"openpix_pix_key_type",name:"openpix_pix_key_type",value:y.openpix_pix_key_type,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"EMAIL",children:"Email"}),e.jsx("option",{value:"CPF",children:"CPF"}),e.jsx("option",{value:"CNPJ",children:"CNPJ"}),e.jsx("option",{value:"PHONE",children:"Telefone"}),e.jsx("option",{value:"RANDOM",children:"Chave Aleatória"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"openpix_pix_key",className:"block text-sm font-medium text-gray-700 mb-2",children:"Chave Pix *"}),e.jsx("input",{type:"text",id:"openpix_pix_key",name:"openpix_pix_key",value:y.openpix_pix_key,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:y.openpix_pix_key_type==="EMAIL"?"exemplo@email.com":y.openpix_pix_key_type==="CPF"?"000.000.000-00":y.openpix_pix_key_type==="CNPJ"?"00.000.000/0000-00":y.openpix_pix_key_type==="PHONE"?"(11) 99999-9999":"Chave aleatória de 32 caracteres"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ke,{size:20,className:"text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-900",children:"Importante sobre a Chave Pix"}),e.jsxs("ul",{className:"text-sm text-yellow-700 mt-1 space-y-1",children:[e.jsx("li",{children:"• A chave Pix será usada para receber pagamentos das vendas em sua loja"}),e.jsx("li",{children:"• Ao salvar, uma subconta será criada automaticamente no sistema OpenPix"}),e.jsx("li",{children:"• Certifique-se de que a chave Pix está correta e ativa em sua conta bancária"}),e.jsx("li",{children:"• Você pode alterar a chave Pix a qualquer momento"})]})]})]})})})]})}),e.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200 mt-8",children:e.jsx("button",{type:"submit",disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fs,{size:16,className:"mr-2"}),"Salvar Alterações"]})})})]})]})]})})},ba=()=>{const[t,g]=s.useState({email:"",password:""}),[c,o]=s.useState(null),[p,a]=s.useState(!1),m=he(),i=h=>{const{name:u,value:O}=h.target;g(y=>({...y,[u]:O}))},z=async h=>{h.preventDefault(),o(null),a(!0);try{const{data:u,error:O}=await C.auth.signInWithPassword({email:t.email,password:t.password});if(O||!u.user){o("Usuário ou senha inválidos."),a(!1);return}const{data:y,error:$}=await C.from("users").select("role").eq("auth_user_id",u.user.id).maybeSingle();if(a(!1),$||!y){o("Erro ao verificar permissões do usuário.");return}if(y.role!=="admin"){o("Apenas administradores podem acessar este painel.");return}m("/admin")}catch{o("Erro inesperado ao tentar fazer login."),a(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(${bs})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-black/90 backdrop-blur-lg rounded-2xl shadow-xl p-8 transition-transform duration-300",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("img",{src:Qe,alt:"Logo",className:"h-32 w-auto mb-4 rounded-lg"}),e.jsx("p",{className:"text-gray-200",children:"Acesso administrativo"})]}),c&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4",children:c}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(_e,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"email",name:"email",placeholder:"Seu email",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:t.email,onChange:i,required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ge,{className:"h-5 w-5 text-gray-300"})}),e.jsx("input",{type:"password",name:"password",placeholder:"Sua senha",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-white/5 border border-gray-400/20 text-white placeholder-gray-300 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500",value:t.password,onChange:i,required:!0})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:-translate-y-0.5 transition-all duration-300",children:p?"Entrando...":"Entrar"})]})]})})})},ja="_edit_xs66u_74",Te={"admin-users-container":"_admin-users-container_xs66u_1","admin-users-header":"_admin-users-header_xs66u_9","admin-users-search":"_admin-users-search_xs66u_17","admin-users-filter":"_admin-users-filter_xs66u_25","admin-users-table":"_admin-users-table_xs66u_32","admin-users-avatar":"_admin-users-avatar_xs66u_50","admin-users-actions":"_admin-users-actions_xs66u_62",edit:ja,delete:"_delete_xs66u_81","admin-users-role-select":"_admin-users-role-select_xs66u_88"},zs=[{value:"",label:"Todos"},{value:"admin",label:"Admin"},{value:"fa",label:"Fã"},{value:"tecnico",label:"Técnico"},{value:"atleta",label:"Atleta"}],ya=()=>{const[t,g]=s.useState([]),[c,o]=s.useState([]),[p,a]=s.useState(!0),[m,i]=s.useState(""),[z,h]=s.useState(""),[u,O]=s.useState(""),[y,$]=s.useState(null),[w,_]=s.useState(""),[R,M]=s.useState(!1),[F,v]=s.useState(null),[D,P]=s.useState(null);s.useEffect(()=>{(async()=>{a(!0),i("");const{data:j,error:k}=await C.from("users").select("auth_user_id, email, name, avatar_url, role, created_at");if(k){i("Erro ao carregar usuários."),a(!1);return}g(j||[]),a(!1)})()},[]),s.useEffect(()=>{let r=t;z&&(r=r.filter(j=>(j.name||"").toLowerCase().includes(z.toLowerCase()))),u&&(r=r.filter(j=>j.role===u)),o(r)},[t,z,u]);const x=r=>{$(r.auth_user_id),_(r.role)},n=async r=>{M(!0);const{error:j}=await C.from("users").update({role:w}).eq("auth_user_id",r.auth_user_id);if(M(!1),j){i("Erro ao atualizar função.");return}g(k=>k.map(U=>U.auth_user_id===r.auth_user_id?{...U,role:w}:U)),$(null)},l=r=>{P(r)},f=async()=>{if(!D)return;v(D.auth_user_id);const{error:r}=await C.from("users").delete().eq("auth_user_id",D.auth_user_id);if(v(null),P(null),r){i("Erro ao excluir usuário.");return}g(j=>j.filter(k=>k.auth_user_id!==D.auth_user_id))},N=()=>P(null);return e.jsxs(e.Fragment,{children:[D&&e.jsx(Ze,{isOpen:!!D,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir o usuário ${D.email}?`,confirmButtonText:"Excluir",cancelButtonText:"Cancelar",onConfirm:f,onCancel:N,confirmButtonColor:"red"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6 mb-6 items-center",children:[e.jsx("input",{className:"flex-1 min-w-[220px] px-4 py-2 border border-gray-200 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-blue-100 "+Te["admin-users-search"],type:"text",placeholder:"Buscar por nome...",value:z,onChange:r=>h(r.target.value)}),e.jsx("select",{className:"min-w-[140px] px-4 py-2 border border-gray-200 rounded-md text-base "+Te["admin-users-filter"],value:u,onChange:r=>O(r.target.value),children:zs.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("select",{className:"min-w-[140px] px-4 py-2 border border-gray-200 rounded-md text-base "+Te["admin-users-filter"],value:u,onChange:r=>O(r.target.value),children:zs.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),p?e.jsx("p",{children:"Carregando usuários..."}):m?e.jsx("p",{className:"text-red-600 text-sm mb-2",children:m}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full "+Te["admin-users-table"],children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Avatar"}),e.jsx("th",{children:"Nome"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Função"}),e.jsx("th",{children:"Criado em"}),e.jsx("th",{children:"Ações"})]})}),e.jsx("tbody",{children:c.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.avatar_url?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r.avatar_url.includes("googleusercontent.com")?r.avatar_url.split("=")[0]:r.avatar_url,alt:r.name||r.email,className:Te["admin-users-avatar"],onError:j=>{var T;const k=j.currentTarget;k.style.display="none";const U=(T=k.parentElement)==null?void 0:T.querySelector("span");U&&(U.style.display="flex")}}),e.jsx("span",{className:Te["admin-users-avatar"],style:{display:"none"},children:r.name?r.name.charAt(0).toUpperCase():r.email.charAt(0).toUpperCase()})]}):e.jsx("span",{className:Te["admin-users-avatar"],children:r.name?r.name.charAt(0).toUpperCase():r.email.charAt(0).toUpperCase()})}),e.jsx("td",{children:r.name||"-"}),e.jsx("td",{children:r.email}),e.jsx("td",{children:y===r.auth_user_id?e.jsxs("select",{className:Te["admin-users-role-select"],value:w,onChange:j=>_(j.target.value),disabled:R,children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"fa",children:"Fã"}),e.jsx("option",{value:"tecnico",children:"Técnico"}),e.jsx("option",{value:"atleta",children:"Atleta"})]}):r.role}),e.jsx("td",{children:r.created_at?new Date(r.created_at).toLocaleDateString("pt-BR"):"-"}),e.jsx("td",{children:e.jsx("div",{className:"flex items-center gap-3",children:y===r.auth_user_id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"edit",onClick:()=>n(r),disabled:R,title:"Salvar",children:e.jsx(Fs,{size:18})}),e.jsx("button",{onClick:()=>$(null),disabled:R,title:"Cancelar",children:e.jsx(le,{size:18})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"edit",onClick:()=>x(r),title:"Editar",children:e.jsx(He,{size:18})}),e.jsx("button",{className:"delete",onClick:()=>l(r),disabled:F===r.auth_user_id,title:"Excluir",children:F===r.auth_user_id?e.jsx("span",{style:{fontSize:12},children:"..."}):e.jsx(Ae,{size:18})})]})})})]},r.auth_user_id))})]})})]})]})},va=()=>{const[t,g]=s.useState("esportes"),[c,o]=s.useState([]),[p,a]=s.useState([]),[m,i]=s.useState([]),[z,h]=s.useState(!1),[u,O]=s.useState(null),[y,$]=s.useState(""),[w,_]=s.useState({modalidade_id:"",nome:"",descricao:""}),[R,M]=s.useState(!1),[F,v]=s.useState(null),[D,P]=s.useState(!1),[x,n]=s.useState(null),[l,f]=s.useState({nome:"",ativo:!0}),[N,r]=s.useState({esporte_id:"",nome:"",jogadores_por_time:0,ativo:!0}),j=async()=>{const{data:d,error:Y}=await C.from("esportes").select("*").order("nome");if(Y){console.error("Erro ao buscar esportes:",Y);return}o(d||[])},k=async()=>{const{data:d,error:Y}=await C.from("modalidades").select("*").order("nome");if(Y){console.error("Erro ao buscar modalidades:",Y);return}a(d||[])},U=async()=>{const{data:d,error:Y}=await C.from("subcategorias").select("*").order("nome");if(Y){console.error("Erro ao buscar subcategorias:",Y);return}i(d||[])};s.useEffect(()=>{j(),k(),U()},[]);const[T,A]=s.useState({isOpen:!1,type:null,id:null}),b=async d=>{A({isOpen:!0,type:"esporte",id:d})},L=async d=>{A({isOpen:!0,type:"modalidade",id:d})},S=async d=>{A({isOpen:!0,type:"subcategoria",id:d})},E=async()=>{if(!(!T.id||!T.type)){if(T.type==="esporte"){const{error:d}=await C.from("esportes").delete().eq("id",T.id);if(d){alert("Erro ao excluir esporte: "+d.message),A({isOpen:!1,type:null,id:null});return}o(Y=>Y.filter(Q=>Q.id!==T.id))}if(T.type==="modalidade"){const{error:d}=await C.from("modalidades").delete().eq("id",T.id);if(d){alert("Erro ao excluir modalidade: "+d.message),A({isOpen:!1,type:null,id:null});return}a(Y=>Y.filter(Q=>Q.id!==T.id))}if(T.type==="subcategoria"){const{error:d}=await C.from("subcategorias").delete().eq("id",T.id);if(d){alert("Erro ao excluir subcategoria: "+d.message),A({isOpen:!1,type:null,id:null});return}i(Y=>Y.filter(Q=>Q.id!==T.id))}A({isOpen:!1,type:null,id:null})}},B=()=>A({isOpen:!1,type:null,id:null}),Z=async d=>{const{error:Y}=await C.from("modalidades").update({esporte_id:N.esporte_id,nome:N.nome,jogadores_por_time:N.jogadores_por_time,ativo:N.ativo}).eq("id",d);if(Y){alert("Erro ao salvar modalidade: "+Y.message);return}a(Q=>Q.map(re=>re.id===d?{...re,esporte_id:N.esporte_id,nome:N.nome,jogadores_por_time:N.jogadores_por_time,ativo:N.ativo}:re)),n(null)},q=async d=>{const{error:Y}=await C.from("esportes").update({nome:l.nome,ativo:l.ativo}).eq("id",d);if(Y){alert("Erro ao salvar esporte: "+Y.message);return}o(Q=>Q.map(re=>re.id===d?{...re,nome:l.nome,ativo:l.ativo}:re)),v(null)},ee=async()=>{const{data:d,error:Y}=await C.from("esportes").insert([l]);if(Y){console.error("Erro ao adicionar esporte:",Y);return}j(),M(!1),f({nome:"",ativo:!0})},J=async()=>{if(!N.esporte_id){alert("Selecione o esporte da modalidade.");return}const{error:d}=await C.from("modalidades").insert([N]);if(d){console.error("Erro ao adicionar modalidade:",d);return}k(),P(!1),r({esporte_id:"",nome:"",jogadores_por_time:0,ativo:!0})},W=async d=>{const{error:Y}=await C.from("subcategorias").update({modalidade_id:w.modalidade_id,nome:w.nome,descricao:w.descricao}).eq("id",d);if(Y){alert("Erro ao salvar subcategoria: "+Y.message);return}i(Q=>Q.map(re=>re.id===d?{...re,modalidade_id:w.modalidade_id,nome:w.nome,descricao:w.descricao}:re)),O(null)};return e.jsxs(ft.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[e.jsx("button",{onClick:()=>g("esportes"),className:`py-4 px-6 text-sm font-medium ${t==="esportes"?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Esportes"}),e.jsx("button",{onClick:()=>g("modalidades"),className:`py-4 px-6 text-sm font-medium ${t==="modalidades"?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Modalidades"}),e.jsx("button",{onClick:()=>g("subcategorias"),className:`py-4 px-6 text-sm font-medium ${t==="subcategorias"?"border-b-2 border-green-500 text-green-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Subcategorias"})]})}),e.jsxs("div",{className:"p-6",children:[t==="subcategorias"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Gerenciar Subcategorias"}),e.jsxs("button",{onClick:()=>h(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Subcategoria"]})]}),z&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-md bg-gray-50",children:[e.jsx("h3",{className:"text-md font-medium mb-3",children:"Nova Subcategoria"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Esporte"}),e.jsxs("select",{value:y,onChange:d=>{$(d.target.value),_(Y=>({...Y,modalidade_id:""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Selecione o esporte"}),c.map(d=>e.jsx("option",{value:d.id,children:d.nome},d.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modalidade"}),e.jsxs("select",{value:w.modalidade_id,onChange:d=>_({...w,modalidade_id:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,disabled:!y,children:[e.jsx("option",{value:"",children:"Selecione a modalidade"}),p.filter(d=>d.esporte_id===y).map(d=>e.jsx("option",{value:d.id,children:d.nome},d.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Subcategoria"}),e.jsx("input",{type:"text",value:w.nome,onChange:d=>_({...w,nome:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("input",{type:"text",value:w.descricao,onChange:d=>_({...w,descricao:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",children:"Cancelar"}),e.jsx("button",{onClick:async()=>{if(!w.modalidade_id){alert("Selecione a modalidade da subcategoria.");return}if(!w.nome){alert("Preencha o nome da subcategoria.");return}const{error:d}=await C.from("subcategorias").insert([w]);if(d){alert("Erro ao adicionar subcategoria: "+d.message);return}U(),h(!1),_({modalidade_id:"",nome:"",descricao:""})},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Salvar"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modalidade"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrição"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(d=>{const Y=p.find(Q=>Q.id===d.modalidade_id);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u===d.id?e.jsxs("select",{value:w.modalidade_id,onChange:Q=>_({...w,modalidade_id:Q.target.value}),className:"px-2 py-1 border border-gray-300 rounded-md w-full",children:[e.jsx("option",{value:"",children:"Selecione a modalidade"}),p.map(Q=>e.jsx("option",{value:Q.id,children:Q.nome},Q.id))]}):Y?Y.nome:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u===d.id?e.jsx("input",{type:"text",value:w.nome,onChange:Q=>_({...w,nome:Q.target.value}),className:"px-2 py-1 border border-gray-300 rounded-md w-full"}):d.nome}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u===d.id?e.jsx("input",{type:"text",value:w.descricao,onChange:Q=>_({...w,descricao:Q.target.value}),className:"px-2 py-1 border border-gray-300 rounded-md w-full"}):d.descricao}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:u===d.id?e.jsx("button",{className:"inline-flex items-center p-1 text-green-600 hover:text-green-800 focus:outline-none",title:"Salvar",onClick:()=>W(d.id),children:e.jsx(Ee,{size:18})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"inline-flex items-center p-1 text-blue-600 hover:text-blue-800 focus:outline-none",title:"Editar",onClick:()=>{O(d.id),_({modalidade_id:d.modalidade_id,nome:d.nome,descricao:d.descricao})},children:e.jsx(He,{size:18})}),e.jsx("button",{className:"inline-flex items-center p-1 text-red-600 hover:text-red-800 focus:outline-none ml-2",title:"Excluir",onClick:()=>S(d.id),children:e.jsx(Ae,{size:18})})]})})]},d.id)})})]})})]}),t==="esportes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Gerenciar Esportes"}),e.jsxs("button",{onClick:()=>M(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Esporte"]})]}),R&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-md bg-gray-50",children:[e.jsx("h3",{className:"text-md font-medium mb-3",children:"Novo Esporte"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),e.jsx("input",{type:"text",value:l.nome,onChange:d=>f({...l,nome:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:l.ativo,onChange:d=>f({...l,ativo:d.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Ativo"})]})})]}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",children:"Cancelar"}),e.jsx("button",{onClick:ee,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Salvar"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F===d.id?e.jsx("input",{type:"text",value:l.nome,onChange:Y=>f({...l,nome:Y.target.value}),className:"px-2 py-1 border border-gray-300 rounded-md w-full"}):e.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.nome})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F===d.id?e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:l.ativo,onChange:Y=>f({...l,ativo:Y.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Ativo"})]}):e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.ativo?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:F===d.id?e.jsx("button",{className:"inline-flex items-center p-1 text-green-600 hover:text-green-800 focus:outline-none",title:"Salvar",onClick:()=>q(d.id),children:e.jsx(Ee,{size:18})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"inline-flex items-center p-1 text-blue-600 hover:text-blue-800 focus:outline-none",title:"Editar",onClick:()=>{v(d.id),f({nome:d.nome,ativo:d.ativo})},children:e.jsx(He,{size:18})}),e.jsx("button",{className:"inline-flex items-center p-1 text-red-600 hover:text-red-800 focus:outline-none ml-2",title:"Excluir",onClick:()=>b(d.id),children:e.jsx(Ae,{size:18})})]})})]},d.id))})]})})]}),t==="modalidades"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Gerenciar Modalidades"}),e.jsxs("button",{onClick:()=>P(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center",children:[e.jsx(Pe,{size:16,className:"mr-1"}),"Adicionar Modalidade"]})]}),D&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-md bg-gray-50",children:[e.jsx("h3",{className:"text-md font-medium mb-3",children:"Nova Modalidade"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Esporte"}),e.jsxs("select",{value:N.esporte_id,onChange:d=>r({...N,esporte_id:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Selecione o esporte"}),c.map(d=>e.jsx("option",{value:d.id,children:d.nome},d.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Modalidade"}),e.jsx("input",{type:"text",value:N.nome,onChange:d=>r({...N,nome:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jogadores por Time"}),e.jsx("input",{type:"number",value:N.jogadores_por_time,onChange:d=>r({...N,jogadores_por_time:Number(d.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:N.ativo,onChange:d=>r({...N,ativo:d.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Ativo"})]})})]}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700",children:"Cancelar"}),e.jsx("button",{onClick:J,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Salvar"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Esporte"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jogadores/Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(d=>{const Y=c.find(Q=>Q.id===d.esporte_id);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Y?Y.nome:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x===d.id?e.jsx("input",{type:"text",value:N.nome,onChange:Q=>r({...N,nome:Q.target.value}),className:"px-2 py-1 border border-gray-300 rounded-md w-full"}):d.nome}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x===d.id?e.jsx("input",{type:"number",value:N.jogadores_por_time,onChange:Q=>r({...N,jogadores_por_time:Number(Q.target.value)}),className:"px-2 py-1 border border-gray-300 rounded-md w-full",min:0}):d.jogadores_por_time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x===d.id?e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:N.ativo,onChange:Q=>r({...N,ativo:Q.target.checked}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Ativo"})]}):e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.ativo?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:x===d.id?e.jsx("button",{className:"inline-flex items-center p-1 text-green-600 hover:text-green-800 focus:outline-none",title:"Salvar",onClick:()=>Z(d.id),children:e.jsx(Ee,{size:18})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"inline-flex items-center p-1 text-blue-600 hover:text-blue-800 focus:outline-none",title:"Editar",onClick:()=>{n(d.id),r({esporte_id:d.esporte_id,nome:d.nome,jogadores_por_time:d.jogadores_por_time,ativo:d.ativo})},children:e.jsx(He,{size:18})}),e.jsx("button",{className:"inline-flex items-center p-1 text-red-600 hover:text-red-800 focus:outline-none ml-2",title:"Excluir",onClick:()=>L(d.id),children:e.jsx(Ae,{size:18})})]})})]},d.id)})})]})})]})]})]}),e.jsx(Ze,{isOpen:T.isOpen,title:T.type==="esporte"?"Excluir Esporte":T.type==="modalidade"?"Excluir Modalidade":T.type==="subcategoria"?"Excluir Subcategoria":"",message:T.type==="esporte"?"Tem certeza que deseja excluir este esporte?":T.type==="modalidade"?"Tem certeza que deseja excluir esta modalidade?":T.type==="subcategoria"?"Tem certeza que deseja excluir esta subcategoria?":"",confirmButtonText:"Excluir",cancelButtonText:"Cancelar",onConfirm:E,onCancel:B,confirmButtonColor:"red"})]})},Na=[{value:"",label:"Todos"},{value:"scheduled",label:"Agendado"},{value:"in_progress",label:"Em andamento"},{value:"completed",label:"Concluído"},{value:"canceled",label:"Cancelado"},{value:"postponed",label:"Adiado"}],wa=()=>{const[t,g]=s.useState([]),[c,o]=s.useState([]),[p,a]=s.useState(!0),[m,i]=s.useState(""),[z,h]=s.useState(""),[u,O]=s.useState(""),[y,$]=s.useState(null),[w,_]=s.useState(null),[R,M]=s.useState("");s.useEffect(()=>{(async()=>{a(!0),i("");const{data:f,error:N}=await C.from("games").select(`
          *,
          sports_organizations (
            id, name, logo_url
          )
        `).order("game_date",{ascending:!1});if(N){console.error("Erro ao buscar jogos:",N),i("Erro ao carregar jogos."),a(!1);return}g(f||[]),a(!1)})()},[]),s.useEffect(()=>{let l=t;if(z){const f=z.toLowerCase();l=l.filter(N=>{var r,j,k,U;return((r=N.opponent_name)==null?void 0:r.toLowerCase().includes(f))||((j=N.location)==null?void 0:j.toLowerCase().includes(f))||((U=(k=N.sports_organizations)==null?void 0:k.name)==null?void 0:U.toLowerCase().includes(f))})}u&&(l=l.filter(f=>f.game_status===u)),R&&(l=l.filter(f=>f.game_date===R)),o(l)},[t,z,u,R]);const F=l=>{const[f,N,r]=l.split("-");return new Date(`${f}-${N}-${r}T00:00:00`).toLocaleDateString("pt-BR")},v=l=>{$(l)},D=async()=>{if(!y)return;_(y.id);const{error:l}=await C.from("games").delete().eq("id",y.id);if(_(null),$(null),l){console.error("Erro ao excluir jogo:",l),i("Erro ao excluir jogo.");return}g(f=>f.filter(N=>N.id!==y.id))},P=()=>$(null),x=l=>{switch(l){case"scheduled":return"Agendado";case"in_progress":return"Em andamento";case"completed":return"Concluído";case"canceled":return"Cancelado";case"postponed":return"Adiado";default:return"Desconhecido"}},n=l=>{switch(l){case"scheduled":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"canceled":return"bg-red-100 text-red-800";case"postponed":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(e.Fragment,{children:[y&&e.jsx(Ze,{isOpen:!!y,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir o jogo contra ${y.opponent_name}?`,confirmButtonText:"Excluir",cancelButtonText:"Cancelar",onConfirm:D,onCancel:P,confirmButtonColor:"red"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Gerenciamento de Jogos"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6 mb-6 items-center",children:[e.jsx("input",{type:"text",placeholder:"Buscar por time, oponente ou local...",className:"px-4 py-2 border border-gray-200 rounded-md flex-grow",value:z,onChange:l=>h(l.target.value)}),e.jsx("select",{className:"min-w-[140px] px-4 py-2 border border-gray-200 rounded-md text-base",value:u,onChange:l=>O(l.target.value),children:Na.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),e.jsx("input",{type:"date",className:"px-4 py-2 border border-gray-200 rounded-md",value:R,onChange:l=>M(l.target.value)})]}),p?e.jsx("p",{className:"text-center py-8",children:"Carregando jogos..."}):m?e.jsx("p",{className:"text-red-600 text-sm mb-2",children:m}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Oponente"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Local"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Placar"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Nenhum jogo encontrado."})}):c.map(l=>{var f,N,r,j,k;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:(f=l.sports_organizations)!=null&&f.logo_url?e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:l.sports_organizations.logo_url,alt:l.sports_organizations.name}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:((r=(N=l.sports_organizations)==null?void 0:N.name)==null?void 0:r.charAt(0))||"?"})})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((j=l.sports_organizations)==null?void 0:j.name)||"Time desconhecido"})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:l.opponent_logo_url?e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:l.opponent_logo_url,alt:l.opponent_name}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:((k=l.opponent_name)==null?void 0:k.charAt(0))||"?"})})}),e.jsx("div",{className:"ml-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.opponent_name})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(je,{size:16,className:"text-gray-400 mr-2"}),e.jsx("div",{className:"text-sm text-gray-900",children:F(l.game_date)}),e.jsx("div",{className:"text-sm text-gray-500 ml-2",children:l.game_time})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ce,{size:16,className:"text-gray-400 mr-2"}),e.jsx("div",{className:"text-sm text-gray-900",children:l.location}),(l.city||l.state)&&e.jsx("div",{className:"text-xs text-gray-500 ml-2",children:[l.city,l.state].filter(Boolean).join(", ")})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.score_team!==null&&l.score_team!==void 0&&l.score_opponent!==null&&l.score_opponent!==void 0?e.jsx("div",{className:"text-sm font-medium",children:l.home_game?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:l.score_team>(l.score_opponent||0)?"text-green-600 font-bold":l.score_team<(l.score_opponent||0)?"text-red-600":"text-gray-600",children:l.score_team}),e.jsx("span",{className:"mx-1",children:"x"}),e.jsx("span",{className:l.score_team<(l.score_opponent||0)?"text-green-600 font-bold":l.score_team>(l.score_opponent||0)?"text-red-600":"text-gray-600",children:l.score_opponent})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:l.score_opponent>(l.score_team||0)?"text-green-600 font-bold":l.score_opponent<(l.score_team||0)?"text-red-600":"text-gray-600",children:l.score_opponent}),e.jsx("span",{className:"mx-1",children:"x"}),e.jsx("span",{className:l.score_opponent<(l.score_team||0)?"text-green-600 font-bold":l.score_opponent>(l.score_team||0)?"text-red-600":"text-gray-600",children:l.score_team})]})}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n(l.game_status)}`,children:x(l.game_status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fs,{to:`/equipe/${l.team_id}`,className:"text-indigo-600 hover:text-indigo-900",title:"Ver equipe",children:e.jsx(Ms,{size:18})}),e.jsx("button",{onClick:()=>v(l),className:"text-red-600 hover:text-red-900",disabled:w===l.id,title:"Excluir jogo",children:w===l.id?e.jsx("span",{className:"text-xs",children:"..."}):e.jsx(Ae,{size:18})})]})})]},l.id)})})]})})]})]})},_a=()=>{const[t,g]=s.useState([]),[c,o]=s.useState([]),[p,a]=s.useState(!0),[m,i]=s.useState(""),[z,h]=s.useState(""),[u,O]=s.useState(""),[y,$]=s.useState([]),[w,_]=s.useState(null),[R,M]=s.useState(null);s.useEffect(()=>{(async()=>{const{data:n,error:l}=await C.from("esportes").select("id, nome").order("nome");if(l){console.error("Erro ao buscar esportes:",l);return}$(n||[])})()},[]),s.useEffect(()=>{(async()=>{a(!0),i("");const{data:n,error:l}=await C.from("sports_organizations").select(`
          *,
          esporte:esporte_id (id, nome),
          modalidade:modalidade_id (id, nome),
          subcategoria:subcategoria_id (id, nome)
        `).order("name");if(l){console.error("Erro ao buscar organizações:",l),i("Erro ao carregar organizações esportivas."),a(!1);return}const f=await Promise.all((n||[]).map(async N=>{const{count:r,error:j}=await C.from("players").select("id",{count:"exact",head:!0}).eq("team_id",N.id);j&&console.error("Erro ao contar jogadores:",j);const{count:k,error:U}=await C.from("games").select("id",{count:"exact",head:!0}).eq("team_id",N.id);return U&&console.error("Erro ao contar jogos:",U),{...N,_count:{players:r||0,games:k||0}}}));g(f||[]),a(!1)})()},[]),s.useEffect(()=>{let x=t;if(z){const n=z.toLowerCase();x=x.filter(l=>{var f,N,r;return((f=l.name)==null?void 0:f.toLowerCase().includes(n))||((N=l.city)==null?void 0:N.toLowerCase().includes(n))||((r=l.state)==null?void 0:r.toLowerCase().includes(n))})}u&&(x=x.filter(n=>n.esporte_id===u)),o(x)},[t,z,u]);const F=x=>new Date(x).toLocaleDateString("pt-BR"),v=x=>{_(x)},D=async()=>{if(!w)return;M(w.id);const{error:x}=await C.from("sports_organizations").delete().eq("id",w.id);if(M(null),_(null),x){console.error("Erro ao excluir organização:",x),i("Erro ao excluir organização. Verifique se não há jogadores ou jogos associados.");return}g(n=>n.filter(l=>l.id!==w.id))},P=()=>_(null);return e.jsxs(e.Fragment,{children:[w&&e.jsx(Ze,{isOpen:!!w,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a organização "${w.name}"? Esta ação excluirá também todos os jogadores e jogos associados.`,confirmButtonText:"Excluir",cancelButtonText:"Cancelar",onConfirm:D,onCancel:P,confirmButtonColor:"red"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Gerenciamento de Organizações Esportivas"}),m&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md mb-4",children:m}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6 mb-6 items-center",children:[e.jsx("input",{type:"text",placeholder:"Buscar por nome ou cidade...",className:"px-4 py-2 border rounded-md flex-1",value:z,onChange:x=>h(x.target.value)}),e.jsxs("select",{className:"px-4 py-2 border rounded-md w-full md:w-auto",value:u,onChange:x=>O(x.target.value),children:[e.jsx("option",{value:"",children:"Todos os esportes"}),y.map(x=>e.jsx("option",{value:x.id,children:x.nome},x.id))]})]}),p?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):c.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhuma organização encontrada."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organização"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Localização"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Esporte"}),e.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx(Se,{size:16,className:"inline mr-1"}),"Jogadores"]}),e.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx(je,{size:16,className:"inline mr-1"}),"Jogos"]}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criado em"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(x=>{var n,l,f,N;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 relative",children:x.logo_url?e.jsx("img",{src:x.logo_url,alt:x.name,className:"h-10 w-10 rounded-full object-cover",onError:r=>{const j=r.currentTarget;j.style.display="none";const k=j.nextElementSibling;k&&(k.style.display="flex")}}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-semibold",children:((n=x.name)==null?void 0:n.charAt(0))||"?"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.name}),x.modalidade&&e.jsxs("div",{className:"text-xs text-gray-500",children:[x.modalidade.nome,x.subcategoria&&` / ${x.subcategoria.nome}`]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Ce,{size:16,className:"mr-1 text-gray-400"}),e.jsx("span",{children:[x.city,x.state,x.country].filter(Boolean).join(", ")||"Não informado"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:((l=x.esporte)==null?void 0:l.nome)||"Não informado"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((f=x._count)==null?void 0:f.players)||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((N=x._count)==null?void 0:N.games)||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F(x.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fs,{to:`/equipe/${x.id}`,className:"text-indigo-600 hover:text-indigo-900",title:"Ver equipe",children:e.jsx(Ms,{size:18})}),e.jsx("button",{onClick:()=>v(x),className:"text-red-600 hover:text-red-900",disabled:R===x.id,title:"Excluir organização",children:R===x.id?e.jsx("span",{className:"text-xs",children:"..."}):e.jsx(Ae,{size:18})})]})})]},x.id)})})]})})]})]})},Ca=()=>{var h;const[t,g]=s.useState("dashboard"),{user:c,logout:o}=ce(),p=he(),[a,m]=s.useState({totalUsers:0,totalTeams:0,totalAdmins:0,isLoading:!0});s.useEffect(()=>{i()},[]);const i=async()=>{try{const{data:u,error:O}=await C.from("user_roles_view").select("auth_user_id").order("auth_user_id");if(O)throw O;const{data:y,error:$}=await C.from("user_roles_view").select("auth_user_id").eq("role","admin");if($)throw $;const{data:w,error:_}=await C.from("sports_organizations").select("id");if(_)throw _;m({totalUsers:u?u.length:0,totalAdmins:y?y.length:0,totalTeams:w?w.length:0,isLoading:!1})}catch(u){console.error("Erro ao buscar estatísticas do dashboard:",u),m(O=>({...O,isLoading:!1}))}},z=async()=>{await o(),p("/admin/login")};return e.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[e.jsxs("div",{className:"w-64 bg-gray-900 text-white min-h-screen p-4 relative",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-xl font-bold",children:"ProHero Admin"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Painel de Administração"})]}),e.jsxs("nav",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>g("dashboard"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="dashboard"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(Ds,{size:18,className:"mr-3"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>g("users"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="users"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(Se,{size:18,className:"mr-3"}),"Usuários"]}),e.jsxs("button",{onClick:()=>g("sports"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="sports"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(be,{size:18,className:"mr-3"}),"Modalidades"]}),e.jsxs("button",{onClick:()=>g("games"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="games"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(je,{size:18,className:"mr-3"}),"Jogos"]}),e.jsxs("button",{onClick:()=>g("organizations"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="organizations"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(bt,{size:18,className:"mr-3"}),"Equipes"]}),e.jsxs("button",{onClick:()=>g("roles"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="roles"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(jt,{size:18,className:"mr-3"}),"Permissões"]}),e.jsxs("button",{onClick:()=>g("settings"),className:`flex items-center w-full px-4 py-2 rounded-md ${t==="settings"?"bg-green-600 text-white":"text-gray-300 hover:bg-gray-800"}`,children:[e.jsx(hs,{size:18,className:"mr-3"}),"Configurações"]})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 px-4",children:e.jsxs("div",{className:"border-t border-gray-700 pt-4 mb-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center text-white mr-2",children:((h=c==null?void 0:c.email)==null?void 0:h.charAt(0).toUpperCase())||"A"}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:c==null?void 0:c.email}),e.jsx("p",{className:"text-xs text-gray-400",children:"Administrador"})]})]}),e.jsxs("button",{onClick:z,className:"flex items-center w-full px-4 py-2 rounded-md text-gray-300 hover:bg-gray-800",style:{boxSizing:"border-box"},children:[e.jsx(gs,{size:18,className:"mr-3"}),"Sair"]})]})})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("h1",{className:"text-xl font-semibold text-gray-800",children:[t==="dashboard"&&"Dashboard",t==="users"&&"Gerenciamento de Usuários",t==="roles"&&"Gerenciamento de Permissões",t==="sports"&&"Gerenciamento de Modalidades",t==="settings"&&"Configurações"]})})}),e.jsxs("main",{className:"p-6",children:[t==="dashboard"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Bem-vindo ao Painel Administrativo"}),e.jsx("p",{className:"text-gray-600",children:"Use o menu lateral para navegar entre as diferentes seções do painel administrativo."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[e.jsx("h3",{className:"font-medium text-blue-700 mb-2",children:"Usuários"}),a.isLoading?e.jsx("div",{className:"animate-pulse h-8 w-16 bg-blue-200 rounded"}):e.jsx("p",{className:"text-3xl font-bold",children:a.totalUsers}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Total de usuários no sistema"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-100",children:[e.jsx("h3",{className:"font-medium text-green-700 mb-2",children:"Equipes"}),a.isLoading?e.jsx("div",{className:"animate-pulse h-8 w-16 bg-green-200 rounded"}):e.jsx("p",{className:"text-3xl font-bold",children:a.totalTeams}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Total de equipes cadastradas"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-100",children:[e.jsx("h3",{className:"font-medium text-purple-700 mb-2",children:"Administradores"}),a.isLoading?e.jsx("div",{className:"animate-pulse h-8 w-16 bg-purple-200 rounded"}):e.jsx("p",{className:"text-3xl font-bold",children:a.totalAdmins}),e.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Usuários com acesso administrativo"})]})]}),a.isLoading&&e.jsx("div",{className:"mt-4 text-center text-sm text-gray-500",children:"Carregando estatísticas..."})]}),t==="users"&&e.jsx(ya,{}),t==="sports"&&e.jsx(va,{}),t==="games"&&e.jsx(wa,{}),t==="organizations"&&e.jsx(_a,{}),t==="roles"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Gerenciamento de Permissões"}),e.jsx("p",{className:"text-gray-600",children:"Aqui você pode gerenciar as permissões dos usuários no sistema."}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:e.jsx("p",{className:"text-yellow-700",children:"Esta funcionalidade está em desenvolvimento e estará disponível em breve."})})})]}),t==="settings"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Configurações do Sistema"}),e.jsx("p",{className:"text-gray-600",children:"Aqui você pode ajustar as configurações gerais do sistema."}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-100",children:e.jsx("p",{className:"text-yellow-700",children:"Esta funcionalidade está em desenvolvimento e estará disponível em breve."})})})]})]})]})]})},Sa=()=>{const{user:t,loading:g,checkUserOnboarding:c}=ce(),[o,p]=s.useState(null),[a,m]=s.useState(!1),i=s.useRef(0),z=s.useRef(!1),h=he();return s.useEffect(()=>{t||(p(null),i.current=0,z.current=!1)},[t]),s.useEffect(()=>{const u=async()=>{if(!(!t||a||z.current||i.current>=3||window.location.pathname==="/dashboard"||window.location.pathname==="/onboarding")){m(!0),i.current+=1;try{console.log(`AppRoutes: Verificando status de onboarding para ${t.id} (tentativa ${i.current})`);const{onboarding:O,error:y}=await c(t.id);y?(console.error("AppRoutes: Erro ao verificar status de onboarding:",y),i.current>=3&&(console.log("AppRoutes: Assumindo onboarding como true devido a erros persistentes"),p(!0),z.current=!0)):(p(O),z.current=!0,O===!1&&window.location.pathname==="/"?(console.log("AppRoutes: Redirecionando para onboarding"),h("/onboarding",{replace:!0})):O===!0&&window.location.pathname==="/"&&(console.log("AppRoutes: Redirecionando para dashboard"),h("/dashboard",{replace:!0})))}catch(O){console.error("AppRoutes: Erro ao verificar status de onboarding:",O),i.current>=3&&(console.log("AppRoutes: Assumindo onboarding como true devido a erros persistentes"),p(!0),z.current=!0)}finally{m(!1)}}};t&&!z.current&&u()},[t,c,h]),g?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Carregando..."})]})}):t&&o===null&&!z.current&&i.current<3&&window.location.pathname!=="/dashboard"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-md text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Verificando perfil..."}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Aguarde um momento..."})]})}):(t&&o===null&&i.current>=3&&window.location.pathname!=="/dashboard"&&(console.log("AppRoutes: Assumindo onboarding como true após múltiplas tentativas"),p(!0),z.current=!0),t&&o===null&&window.location.pathname==="/dashboard"&&(p(!0),z.current=!0),e.jsxs(yt,{children:[e.jsx(ge,{path:"/admin/login",element:e.jsx(ba,{})}),e.jsx(ge,{path:"/admin",element:t?e.jsx(Ca,{}):e.jsx(ie,{to:"/admin/login",replace:!0})}),e.jsx(ge,{path:"/login",element:t?e.jsx(ie,{to:o===!1?"/onboarding":"/dashboard",replace:!0}):e.jsx(Pt,{})}),e.jsx(ge,{path:"/signup",element:t?e.jsx(ie,{to:o===!1?"/onboarding":"/dashboard",replace:!0}):e.jsx(qt,{})}),e.jsx(ge,{path:"/reset-password",element:e.jsx(Tt,{})}),e.jsx(ge,{path:"/auth/callback",element:e.jsx(Ot,{})}),e.jsx(ge,{path:"/onboarding",element:t?o===!0?e.jsx(ie,{to:"/dashboard",replace:!0}):e.jsx(It,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/dashboard/*",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx($t,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/minhaequipe",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Ut,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/minhaequipe/adicionar",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Rt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/equipe/:id",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Gt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/visualizar-equipe/:id",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Vt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/calendario",element:e.jsx(Jt,{})}),e.jsx(ge,{path:"/ligastorneios",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Wt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/meus-pedidos",element:t?e.jsx(ha,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/minhas-vendas",element:t?e.jsx(pa,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/conta",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(fa,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/ligastorneios/:id",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Qt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/equipes",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(Zt,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/loja",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(ta,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/loja-online",element:t?o===!1?e.jsx(ie,{to:"/onboarding",replace:!0}):e.jsx(ga,{}):e.jsx(ie,{to:"/login",replace:!0})}),e.jsx(ge,{path:"/",element:e.jsx(ie,{to:t?o===!1?"/onboarding":"/dashboard":"/login",replace:!0})}),e.jsx(ge,{path:"*",element:e.jsx(ie,{to:"/",replace:!0})})]}))};function Ea(){return e.jsx(vt,{children:e.jsx(Dt,{children:e.jsx(At,{children:e.jsx(Sa,{})})})})}Nt(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(Ea,{})}));
